{"mappings":"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","sources":["src/js/mavo-uncompressed.js"],"sourcesContent":["!function(){\"use strict\";function t(e,n,i){return n=void 0===n?1:n,i=i||n+1,i-n<=1?function(){if(arguments.length<=n||\"string\"===r.type(arguments[n]))return e.apply(this,arguments);var t,i=arguments[n];for(var o in i){var s=Array.prototype.slice.call(arguments);s.splice(n,1,o,i[o]),t=e.apply(this,s)}return t}:t(t(e,n+1,i),n,i-1)}function e(t,r,i){var o=n(i);if(\"string\"===o){var s=Object.getOwnPropertyDescriptor(r,i);!s||s.writable&&s.configurable&&s.enumerable&&!s.get&&!s.set?t[i]=r[i]:(delete t[i],Object.defineProperty(t,i,s))}else if(\"array\"===o)i.forEach(function(n){n in r&&e(t,r,n)});else for(var a in r)i&&(\"regexp\"===o&&!i.test(a)||\"function\"===o&&!i.call(r,a))||e(t,r,a);return t}function n(t){if(null===t)return\"null\";if(void 0===t)return\"undefined\";var e=(Object.prototype.toString.call(t).match(/^\\[object\\s+(.*?)\\]$/)[1]||\"\").toLowerCase();return\"number\"==e&&isNaN(t)?\"nan\":e}var r=self.Bliss=e(function(t,e){return 2==arguments.length&&!e||!t?null:\"string\"===r.type(t)?(e||document).querySelector(t):t||null},self.Bliss);e(r,{extend:e,overload:t,type:n,property:r.property||\"_\",listeners:self.WeakMap?new WeakMap:new Map,original:{addEventListener:(self.EventTarget||Node).prototype.addEventListener,removeEventListener:(self.EventTarget||Node).prototype.removeEventListener},sources:{},noop:function(){},$:function(t,e){return t instanceof Node||t instanceof Window?[t]:2!=arguments.length||e?Array.prototype.slice.call(\"string\"==typeof t?(e||document).querySelectorAll(t):t||[]):[]},defined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]},create:function(t,e){return t instanceof Node?r.set(t,e):(1===arguments.length&&(\"string\"===r.type(t)?e={}:(e=t,t=e.tag,e=r.extend({},e,function(t){return\"tag\"!==t}))),r.set(document.createElement(t||\"div\"),e))},each:function(t,e,n){n=n||{};for(var r in t)n[r]=e.call(t,r,t[r]);return n},ready:function(t,e,n){if(\"function\"!=typeof t||e||(e=t,t=void 0),t=t||document,e&&(\"loading\"!==t.readyState?e():r.once(t,\"DOMContentLoaded\",function(){e()})),!n)return new Promise(function(e){r.ready(t,e,!0)})},Class:function(t){var e,n=[\"constructor\",\"extends\",\"abstract\",\"static\"].concat(Object.keys(r.classProps)),i=t.hasOwnProperty(\"constructor\")?t.constructor:r.noop;2==arguments.length?(e=arguments[0],t=arguments[1]):(e=function(){if(this.constructor.__abstract&&this.constructor===e)throw new Error(\"Abstract classes cannot be directly instantiated.\");e[\"super\"]&&e[\"super\"].apply(this,arguments),i.apply(this,arguments)},e[\"super\"]=t[\"extends\"]||null,e.prototype=r.extend(Object.create(e[\"super\"]?e[\"super\"].prototype:Object),{constructor:e}),e.prototype[\"super\"]=e[\"super\"]?e[\"super\"].prototype:null,e.__abstract=!!t[\"abstract\"]);var o=function(t){return this.hasOwnProperty(t)&&n.indexOf(t)===-1};if(t[\"static\"]){r.extend(e,t[\"static\"],o);for(var s in r.classProps)s in t[\"static\"]&&r.classProps[s](e,t[\"static\"][s])}r.extend(e.prototype,t,o);for(var s in r.classProps)s in t&&r.classProps[s](e.prototype,t[s]);return e},classProps:{lazy:t(function(t,e,n){return Object.defineProperty(t,e,{get:function(){var t=n.call(this);return Object.defineProperty(this,e,{value:t,configurable:!0,enumerable:!0,writable:!0}),t},set:function(t){Object.defineProperty(this,e,{value:t,configurable:!0,enumerable:!0,writable:!0})},configurable:!0,enumerable:!0}),t}),live:t(function(t,e,n){return\"function\"===r.type(n)&&(n={set:n}),Object.defineProperty(t,e,{get:function(){var t=this[\"_\"+e],r=n.get&&n.get.call(this,t);return void 0!==r?r:t},set:function(t){var r=this[\"_\"+e],i=n.set&&n.set.call(this,t,r);this[\"_\"+e]=void 0!==i?i:t},configurable:n.configurable,enumerable:n.enumerable}),t})},include:function(){var t=arguments[arguments.length-1],e=2===arguments.length&&arguments[0],n=document.createElement(\"script\");return e?Promise.resolve():new Promise(function(e,i){r.set(n,{async:!0,onload:function(){e(n),n.parentNode&&n.parentNode.removeChild(n)},onerror:function(){i(n)},src:t,inside:document.head})})},load:function o(t,e){e=e?new URL(e,location.href):location.href,t=new URL(t,e);var n=o.loading=o.loading||{};return n[t+\"\"]?n[t+\"\"]:/\\.css$/.test(t.pathname)?n[t+\"\"]=new Promise(function(e,n){var i=r.create(\"link\",{href:t,rel:\"stylesheet\",inside:document.head,onload:function(){e(i)},onerror:function(){n(i)}})}):n[t+\"\"]=r.include(t)},fetch:function(t,n){if(!t)throw new TypeError(\"URL parameter is mandatory and cannot be \"+t);var i=e({url:new URL(t,location),data:\"\",method:\"GET\",headers:{},xhr:new XMLHttpRequest},n);i.method=i.method.toUpperCase(),r.hooks.run(\"fetch-args\",i),\"GET\"===i.method&&i.data&&(i.url.search+=i.data),document.body.setAttribute(\"data-loading\",i.url),i.xhr.open(i.method,i.url.href,i.async!==!1,i.user,i.password);for(var o in n)if(\"upload\"===o)i.xhr.upload&&\"object\"==typeof n[o]&&r.extend(i.xhr.upload,n[o]);else if(o in i.xhr)try{i.xhr[o]=n[o]}catch(s){self.console&&console.error(s)}var a=Object.keys(i.headers).map(function(t){return t.toLowerCase()});\"GET\"!==i.method&&a.indexOf(\"content-type\")===-1&&i.xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");for(var c in i.headers)void 0!==i.headers[c]&&i.xhr.setRequestHeader(c,i.headers[c]);var u=new Promise(function(t,e){i.xhr.onload=function(){document.body.removeAttribute(\"data-loading\"),0===i.xhr.status||i.xhr.status>=200&&i.xhr.status<300||304===i.xhr.status?t(i.xhr):e(r.extend(Error(i.xhr.statusText),{xhr:i.xhr,get status(){return this.xhr.status}}))},i.xhr.onerror=function(){document.body.removeAttribute(\"data-loading\"),e(r.extend(Error(\"Network Error\"),{xhr:i.xhr}))},i.xhr.ontimeout=function(){document.body.removeAttribute(\"data-loading\"),e(r.extend(Error(\"Network Timeout\"),{xhr:i.xhr}))},i.xhr.send(\"GET\"===i.method?null:i.data)});return u.xhr=i.xhr,u},value:function(t){var e=\"string\"!=typeof t;return r.$(arguments).slice(+e).reduce(function(t,e){return t&&t[e]},e?t:self)}}),r.Hooks=new r.Class({add:function(t,e,n){if(\"string\"==typeof arguments[0])(Array.isArray(t)?t:[t]).forEach(function(t){this[t]=this[t]||[],e&&this[t][n?\"unshift\":\"push\"](e)},this);else for(var t in arguments[0])this.add(t,arguments[0][t],arguments[1])},run:function(t,e){this[t]=this[t]||[],this[t].forEach(function(t){t.call(e&&e.context?e.context:e,e)})}}),r.hooks=new r.Hooks;r.property;r.Element=function(t){this.subject=t,this.data={},this.bliss={}},r.Element.prototype={set:t(function(t,e){t in r.setProps?r.setProps[t].call(this,e):t in this?this[t]=e:this.setAttribute(t,e)},0),transition:function(t,e){return new Promise(function(n,i){if(\"transition\"in this.style&&0!==e){var o=r.extend({},this.style,/^transition(Duration|Property)$/);r.style(this,{transitionDuration:(e||400)+\"ms\",transitionProperty:Object.keys(t).join(\", \")}),r.once(this,\"transitionend\",function(){clearTimeout(s),r.style(this,o),n(this)});var s=setTimeout(n,e+50,this);r.style(this,t)}else r.style(this,t),n(this)}.bind(this))},fire:function(t,e){var n=document.createEvent(\"HTMLEvents\");return n.initEvent(t,!0,!0),this.dispatchEvent(r.extend(n,e))},bind:t(function(t,e){if(arguments.length>1&&(\"function\"===r.type(e)||e.handleEvent)){var n=e;e=\"object\"===r.type(arguments[2])?arguments[2]:{capture:!!arguments[2]},e.callback=n}var i=r.listeners.get(this)||{};t.trim().split(/\\s+/).forEach(function(t){if(t.indexOf(\".\")>-1){t=t.split(\".\");var n=t[1];t=t[0]}i[t]=i[t]||[],0===i[t].filter(function(t){return t.callback===e.callback&&t.capture==e.capture}).length&&i[t].push(r.extend({className:n},e)),r.original.addEventListener.call(this,t,e.callback,e)},this),r.listeners.set(this,i)},0),unbind:t(function(t,e){if(e&&(\"function\"===r.type(e)||e.handleEvent)){var n=e;e=arguments[2]}\"boolean\"==r.type(e)&&(e={capture:e}),e=e||{},e.callback=e.callback||n;var i=r.listeners.get(this);(t||\"\").trim().split(/\\s+/).forEach(function(t){if(t.indexOf(\".\")>-1){t=t.split(\".\");var n=t[1];t=t[0]}if(i){for(var o in i)if(!t||o===t)for(var s,a=0;s=i[o][a];a++)n&&n!==s.className||e.callback&&e.callback!==s.callback||!!e.capture!=!!s.capture&&(t||e.callback||void 0!==e.capture)||(i[o].splice(a,1),r.original.removeEventListener.call(this,o,s.callback,s.capture),a--)}else if(t&&e.callback)return r.original.removeEventListener.call(this,t,e.callback,e.capture)},this)},0),when:function(t,e){var n=this;return new Promise(function(r){n.addEventListener(t,function i(n){e&&!e.call(this,n)||(this.removeEventListener(t,i),r(n))})})},toggleAttribute:function(t,e,n){arguments.length<3&&(n=null!==e),n?this.setAttribute(t,e):this.removeAttribute(t)}},r.setProps={style:function(t){for(var e in t)e in this.style?this.style[e]=t[e]:this.style.setProperty(e,t[e])},attributes:function(t){for(var e in t)this.setAttribute(e,t[e])},properties:function(t){r.extend(this,t)},events:function(t){if(1!=arguments.length||!t||!t.addEventListener)return r.bind.apply(this,[this].concat(r.$(arguments)));var e=this;if(r.listeners){var n=r.listeners.get(t);for(var i in n)n[i].forEach(function(t){r.bind(e,i,t.callback,t.capture)})}for(var o in t)0===o.indexOf(\"on\")&&(this[o]=t[o])},once:t(function(t,e){var n=this,i=function(){return r.unbind(n,t,i),e.apply(n,arguments)};r.bind(this,t,i,{once:!0})},0),delegate:t(function(t,e,n){r.bind(this,t,function(t){t.target.closest(e)&&n.call(this,t)})},0,2),contents:function(t){(t||0===t)&&(Array.isArray(t)?t:[t]).forEach(function(t){var e=r.type(t);/^(string|number)$/.test(e)?t=document.createTextNode(t+\"\"):\"object\"===e&&(t=r.create(t)),t instanceof Node&&this.appendChild(t)},this)},inside:function(t){t&&t.appendChild(this)},before:function(t){t&&t.parentNode.insertBefore(this,t)},after:function(t){t&&t.parentNode.insertBefore(this,t.nextSibling)},start:function(t){t&&t.insertBefore(this,t.firstChild)},around:function(t){t&&t.parentNode&&r.before(this,t),this.appendChild(t)}},r.Array=function(t){this.subject=t},r.Array.prototype={all:function(t){var e=r.$(arguments).slice(1);return this[t].apply(this,e)}},r.add=t(function(t,e,n,i){n=r.extend({$:!0,element:!0,array:!0},n),\"function\"==r.type(e)&&(!n.element||t in r.Element.prototype&&i||(r.Element.prototype[t]=function(){return this.subject&&r.defined(e.apply(this.subject,arguments),this.subject)}),!n.array||t in r.Array.prototype&&i||(r.Array.prototype[t]=function(){var t=arguments;return this.subject.map(function(n){return n&&r.defined(e.apply(n,t),n)})}),n.$&&(r.sources[t]=r[t]=e,(n.array||n.element)&&(r[t]=function(){var e=[].slice.apply(arguments),i=e.shift(),o=n.array&&Array.isArray(i)?\"Array\":\"Element\";return r[o].prototype[t].apply({subject:i},e)})))},0),r.add(r.Array.prototype,{element:!1}),r.add(r.Element.prototype),r.add(r.setProps),r.add(r.classProps,{element:!1,array:!1});var i=document.createElement(\"_\");r.add(r.extend({},HTMLElement.prototype,function(t){return\"function\"===r.type(i[t])}),null,!0)}();\n/* jsep v0.3.4 (http://jsep.from.so/) */\n!function(e){\"use strict\";var C=\"Compound\",U=\"MemberExpression\",w=\"Literal\",k=function(e,r){var t=new Error(e+\" at character \"+r);throw t.index=r,t.description=e,t},O={\"-\":!0,\"!\":!0,\"~\":!0,\"+\":!0},S={\"||\":1,\"&&\":2,\"|\":3,\"^\":4,\"&\":5,\"==\":6,\"!=\":6,\"===\":6,\"!==\":6,\"<\":7,\">\":7,\"<=\":7,\">=\":7,\"<<\":8,\">>\":8,\">>>\":8,\"+\":9,\"-\":9,\"*\":10,\"/\":10,\"%\":10},r=function(e){var r,t=0;for(var n in e)(r=n.length)>t&&e.hasOwnProperty(n)&&(t=r);return t},j=r(O),A=r(S),P={true:!0,false:!1,null:null},L=function(e){return S[e]||0},B=function(e,r,t){return{type:\"||\"===e||\"&&\"===e?\"LogicalExpression\":\"BinaryExpression\",operator:e,left:r,right:t}},M=function(e){return 48<=e&&e<=57},q=function(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||128<=e&&!S[String.fromCharCode(e)]},J=function(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||128<=e&&!S[String.fromCharCode(e)]},t=function(n){for(var e,r,p=0,t=n.charAt,o=n.charCodeAt,i=function(e){return t.call(n,e)},u=function(e){return o.call(n,e)},s=n.length,f=function(){for(var e=u(p);32===e||9===e||10===e||13===e;)e=u(++p)},c=function(){var e,r,t=a();return f(),63!==u(p)?t:(p++,(e=c())||k(\"Expected expression\",p),f(),58===u(p)?(p++,(r=c())||k(\"Expected expression\",p),{type:\"ConditionalExpression\",test:t,consequent:e,alternate:r}):void k(\"Expected :\",p))},l=function(){f();for(var e=n.substr(p,A),r=e.length;0<r;){if(S.hasOwnProperty(e)&&(!q(u(p))||p+e.length<n.length&&!J(u(p+e.length))))return p+=r,e;e=e.substr(0,--r)}return!1},a=function(){var e,r,t,n,o,i,a,u,s;if(i=h(),!(r=l()))return i;for(o={value:r,prec:L(r)},(a=h())||k(\"Expected expression after \"+r,p),n=[i,o,a];(r=l())&&0!==(t=L(r));){for(o={value:r,prec:t},s=r;2<n.length&&t<=n[n.length-2].prec;)a=n.pop(),r=n.pop().value,i=n.pop(),e=B(r,i,a),n.push(e);(e=h())||k(\"Expected expression after \"+s,p),n.push(o,e)}for(e=n[u=n.length-1];1<u;)e=B(n[u-1].value,n[u-2],e),u-=2;return e},h=function(){var e,r,t;if(f(),e=u(p),M(e)||46===e)return d();if(39===e||34===e)return v();if(91===e)return b();for(t=(r=n.substr(p,j)).length;0<t;){if(O.hasOwnProperty(r)&&(!q(u(p))||p+r.length<n.length&&!J(u(p+r.length))))return p+=t,{type:\"UnaryExpression\",operator:r,argument:h(),prefix:!0};r=r.substr(0,--t)}return!(!q(e)&&40!==e)&&g()},d=function(){for(var e,r,t=\"\";M(u(p));)t+=i(p++);if(46===u(p))for(t+=i(p++);M(u(p));)t+=i(p++);if(\"e\"===(e=i(p))||\"E\"===e){for(t+=i(p++),\"+\"!==(e=i(p))&&\"-\"!==e||(t+=i(p++));M(u(p));)t+=i(p++);M(u(p-1))||k(\"Expected exponent (\"+t+i(p)+\")\",p)}return r=u(p),q(r)?k(\"Variable names cannot start with a number (\"+t+i(p)+\")\",p):46===r&&k(\"Unexpected period\",p),{type:w,value:parseFloat(t),raw:t}},v=function(){for(var e,r=\"\",t=i(p++),n=!1;p<s;){if((e=i(p++))===t){n=!0;break}if(\"\\\\\"===e)switch(e=i(p++)){case\"n\":r+=\"\\n\";break;case\"r\":r+=\"\\r\";break;case\"t\":r+=\"\\t\";break;case\"b\":r+=\"\\b\";break;case\"f\":r+=\"\\f\";break;case\"v\":r+=\"\\v\";break;default:r+=e}else r+=e}return n||k('Unclosed quote after \"'+r+'\"',p),{type:w,value:r,raw:t+r+t}},x=function(){var e,r=u(p),t=p;for(q(r)?p++:k(\"Unexpected \"+i(p),p);p<s&&(r=u(p),J(r));)p++;return e=n.slice(t,p),P.hasOwnProperty(e)?{type:w,value:P[e],raw:e}:\"this\"===e?{type:\"ThisExpression\"}:{type:\"Identifier\",name:e}},y=function(e){for(var r,t,n=[],o=!1,i=0;p<s;){if(f(),(r=u(p))===e){o=!0,p++,41===e&&i&&i>=n.length&&k(\"Unexpected token \"+String.fromCharCode(e),p);break}if(44===r){if(p++,++i!==n.length)if(41===e)k(\"Unexpected token ,\",p);else if(93===e)for(var a=n.length;a<i;a++)n.push(null)}else(t=c())&&t.type!==C||k(\"Expected comma\",p),n.push(t)}return o||k(\"Expected \"+String.fromCharCode(e),p),n},g=function(){var e,r;for(r=40===(e=u(p))?m():x(),f(),e=u(p);46===e||91===e||40===e;)p++,46===e?(f(),r={type:U,computed:!1,object:r,property:x()}):91===e?(r={type:U,computed:!0,object:r,property:c()},f(),93!==(e=u(p))&&k(\"Unclosed [\",p),p++):40===e&&(r={type:\"CallExpression\",arguments:y(41),callee:r}),f(),e=u(p);return r},m=function(){p++;var e=c();if(f(),41===u(p))return p++,e;k(\"Unclosed (\",p)},b=function(){return p++,{type:\"ArrayExpression\",elements:y(93)}},E=[];p<s;)59===(e=u(p))||44===e?p++:(r=c())?E.push(r):p<s&&k('Unexpected \"'+i(p)+'\"',p);return 1===E.length?E[0]:{type:C,body:E}};if(t.version=\"0.3.4\",t.toString=function(){return\"JavaScript Expression Parser (JSEP) v\"+t.version},t.addUnaryOp=function(e){return j=Math.max(e.length,j),O[e]=!0,this},t.addBinaryOp=function(e,r){return A=Math.max(e.length,A),S[e]=r,this},t.addLiteral=function(e,r){return P[e]=r,this},t.removeUnaryOp=function(e){return delete O[e],e.length===j&&(j=r(O)),this},t.removeAllUnaryOps=function(){return O={},j=0,this},t.removeBinaryOp=function(e){return delete S[e],e.length===A&&(A=r(S)),this},t.removeAllBinaryOps=function(){return S={},A=0,this},t.removeLiteral=function(e){return delete P[e],this},t.removeAllLiterals=function(){return P={},this},\"undefined\"==typeof exports){var n=e.jsep;(e.jsep=t).noConflict=function(){return e.jsep===t&&(e.jsep=n),t}}else\"undefined\"!=typeof module&&module.exports?exports=module.exports=t:exports.parse=t}(this);\n//# sourceMappingURL=jsep.min.js.map\n!function(){if(self.Element&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||null),Element.prototype.matches)){var p=self.Stretchy={selectors:{base:'textarea, select:not([size]), input:not([type]), input[type=\"'+\"text number url email tel\".split(\" \").join('\"], input[type=\"')+'\"]',filter:\"*\"},script:document.currentScript||t(\"script\").pop(),resize:function(e){if(p.resizes(e)){var t,i=getComputedStyle(e),n=0;!e.value&&e.placeholder&&(t=!0,e.value=e.placeholder);var o=e.nodeName.toLowerCase();if(\"textarea\"==o)e.style.height=\"0\",\"border-box\"==i.boxSizing?n=e.offsetHeight:\"content-box\"==i.boxSizing&&(n=-e.clientHeight+parseFloat(i.minHeight)),e.style.height=e.scrollHeight+n+\"px\";else if(\"input\"==o)if(e.style.width=\"1000px\",e.offsetWidth){e.style.width=\"0\",\n\"border-box\"==i.boxSizing?n=e.offsetWidth:\"padding-box\"==i.boxSizing?n=e.clientWidth:\"content-box\"==i.boxSizing&&(n=parseFloat(i.minWidth));var r=Math.max(n,e.scrollWidth-e.clientWidth);e.style.width=r+\"px\";for(var l=0;l<10&&(e.scrollLeft=1e10,0!=e.scrollLeft);l++)r+=e.scrollLeft,e.style.width=r+\"px\"}else e.style.width=e.value.length+1+\"ch\";else if(\"select\"==o){var s,c=0<e.selectedIndex?e.selectedIndex:0,a=document.createElement(\"_\");for(var d in a.textContent=e.options[c].textContent,e.parentNode.insertBefore(a,e.nextSibling),i){var h=i[d];/^(width|webkitLogicalWidth|length)$/.test(d)||\"string\"!=typeof h||(a.style[d]=h,/appearance$/i.test(d)&&(s=d))}a.style.width=\"\",0<a.offsetWidth&&(e.style.width=a.offsetWidth+\"px\",i[s]&&\"none\"===i[s]||(e.style.width=\"calc(\"+e.style.width+\" + 2em)\")),a.parentNode.removeChild(a),a=null}t&&(e.value=\"\")}},resizeAll:function(e){t(e||p.selectors.base).forEach(function(e){p.resize(e)})},active:!0,resizes:function(e){\nreturn e&&e.parentNode&&e.matches&&e.matches(p.selectors.base)&&e.matches(p.selectors.filter)},init:function(){p.selectors.filter=p.script.getAttribute(\"data-filter\")||(t(\"[data-stretchy-filter]\").pop()||document.body).getAttribute(\"data-stretchy-filter\")||p.selectors.filter,p.resizeAll(),self.MutationObserver&&!p.observer&&(p.observer=new MutationObserver(function(e){p.active&&e.forEach(function(e){\"childList\"==e.type&&p.resizeAll(e.addedNodes)})}),p.observer.observe(document.documentElement,{childList:!0,subtree:!0}))},$$:t};\"loading\"!==document.readyState?requestAnimationFrame(p.init):document.addEventListener(\"DOMContentLoaded\",p.init),window.addEventListener(\"load\",function(){p.resizeAll()});var e=function(e){p.active&&p.resize(e.target)};document.documentElement.addEventListener(\"input\",e),document.documentElement.addEventListener(\"change\",e)}function t(e,t){return e instanceof Node||e instanceof Window?[e]:[].slice.call(\"string\"==typeof e?(t||document).querySelectorAll(e):e||[])\n}}();\n//# sourceMappingURL=stretchy.min.js.map\n\n/**\n * Mavo: Create web applications by writing HTML and CSS!\n * @author Lea Verou and contributors\n * @version v0.2.4\n */\n\n Stretchy.selectors.filter = \".mv-editor:not([property]), .mv-autosize\";\n\n(async function ($, $$) {\n\n// Define $ and $$ if they are not already defined\n// Primarily for backwards compat since we used to use Bliss Full.\nself.$ = self.$ || $;\nself.$$ = self.$$ || $$;\n\nvar _ = self.Mavo = $.Class({\n\tconstructor: function (element) {\n\t\tthis.treeBuilt = Mavo.promise();\n\t\tthis.dataLoaded = Mavo.promise();\n\t\tthis.deleted = [];\n\n\t\tthis.element = element;\n\n\t\tthis.inProgress = false;\n\n\t\t// Index among other mavos in the page, 1 is first\n\t\tthis.index = Object.keys(_.all).length + 1;\n\t\tObject.defineProperty(_.all, this.index - 1, {value: this, configurable: true});\n\n\t\t// Assign a unique (for the page) id to this mavo instance\n\t\tthis.id = Mavo.getAttribute(this.element, \"mv-app\", \"id\") || `mavo${this.index}`;\n\n\t\tif (this.id in _.all) {\n\t\t\t// Duplicate app name\n\t\t\tfor (var i=2; this.id + i in _.all; i++) {}\n\t\t\tthis.id = this.id + i;\n\t\t}\n\n\t\t_.all[this.id] = this;\n\t\tthis.element.setAttribute(\"mv-app\", this.id);\n\n\t\tthis.observe({attribute: \"lang\", deep: false}, () => {\n\t\t\tvar lang = Mavo.getClosestAttribute(this.element, \"lang\") || Mavo.locale;\n\t\t\tthis.locale = Mavo.Locale.get(lang);\n\t\t})();\n\n\t\t// Should we start in edit mode?\n\t\tthis.autoEdit = this.element.classList.contains(\"mv-autoedit\");\n\n\t\t// Should we save automatically?\n\t\tthis.autoSave = this.element.hasAttribute(\"mv-autosave\");\n\t\tthis.autoSaveDelay = (this.element.getAttribute(\"mv-autosave\") || 0) * 1000;\n\n\t\tMavo.setAttributeShy(this.element, \"typeof\", \"\");\n\n\t\tMavo.hooks.run(\"init-start\", this);\n\n\t\t// ----- Heuristic for groups ------\n\n\t\t// First, add property attributes to mv-multiple elements without one\n\t\t$$(_.selectors.multiple, this.element).forEach(element => {\n\t\t\t_.setAttributeShy(element, \"property\", \"\");\n\t\t});\n\n\t\t// Now, turn properties that contain other properties into groups\n\t\t$$(_.selectors.primitive, this.element).forEach(element => {\n\t\t\tif ($(_.selectors.property, element)) { // contains other properties\n\t\t\t\tvar config = Mavo.Primitive.getConfig(element);\n\n\t\t\t\tif (!config.attribute && !config.hasChildren || Mavo.is(\"multiple\", element)) {\n\t\t\t\t\tMavo.setAttributeShy(element, \"typeof\", \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.expressions = new Mavo.Expressions(this);\n\n\t\t_.observers = _.observers || new Mavo.Observers();\n\t\t_.observers.observer.observe(this.element, {\n\t\t\t// Observe everything\n\t\t\tcharacterData: true,\n\t\t\tchildList: true,\n\t\t\tsubtree: true,\n\t\t\tattributes: true\n\t\t});\n\n\t\t// Build mavo objects\n\t\tMavo.hooks.run(\"init-tree-before\", this);\n\n\t\tthis.root = new Mavo.Group(this.element, this);\n\t\tthis.treeBuilt.resolve();\n\n\t\tMavo.hooks.run(\"init-tree-after\", this);\n\n\t\tthis.permissions = new Mavo.Permissions();\n\n\t\tvar backendTypes = [\"source\", \"storage\", \"init\", \"uploads\"]; // order is significant!\n\n\t\t// Figure out backends for storage, data reads, and initialization respectively\n\t\tbackendTypes.forEach(role => this.updateBackend(role));\n\n\t\tthis.observe({deep: false, attribute: true}, ({attribute}) => {\n\t\t\tif (attribute.indexOf(\"mv-\") === 0) {\n\t\t\t\t// We want to observe changes both in a backend (the mv-role attribute)\n\t\t\t\t// and its metadata (provided via the mv-role-* family of attributes)\n\t\t\t\tlet role = attribute?.replace(/^mv-/, \"\")?.split(\"-\")?.[0];\n\n\t\t\t\tif (backendTypes.includes(role)) {\n\t\t\t\t\tthis.updateBackend(role);\n\n\t\t\t\t\t// Do we need to re-load data?\n\t\t\t\t\tif (role === \"source\" || (!this.source && (role === \"storage\" || role === \"init\" && !this.root.data))) {\n\t\t\t\t\t\tthis.load();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\tthis.permissions.can(\"login\", () => {\n\t\t\t// We also support a URL param to trigger login, in case the user doesn't want visible login UI\n\t\t\tlet loginUrlParam;\n\t\t\tif (Mavo.Functions.url(\"login\") !== null && this.index === 1) {\n\t\t\t\tloginUrlParam = \"login\";\n\t\t\t}\n\t\t\telse if (Mavo.Functions.url(this.id + \"-login\") !== null) {\n\t\t\t\tloginUrlParam = this.id + \"-login\";\n\t\t\t}\n\n\t\t\tif (loginUrlParam !== undefined) {\n\t\t\t\t// Remove param from url\n\t\t\t\tconst currentURL = new URL(location.href);\n\t\t\t\tcurrentURL.searchParams.delete(loginUrlParam);\n\t\t\t\thistory.replaceState(null, \"\", currentURL);\n\t\t\t\tthis.primaryBackend.login();\n\t\t\t}\n\t\t});\n\n\t\t// Update login status\n\t\t$.bind(this.element, \"mv-login.mavo\", evt => {\n\t\t\tif (evt.backend == (this.source || this.storage)) {\n\t\t\t\t// If last time we rendered we got nothing, maybe now we'll have better luck?\n\t\t\t\tif (!this.root.data && !this.unsavedChanges) {\n\t\t\t\t\tthis.load();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.bar = new Mavo.UI.Bar(this);\n\n\t\t// Is there any control that requires an edit button?\n\t\tthis.needsEdit = this.calculateNeedsEdit();\n\n\t\tthis.setUnsavedChanges(false);\n\n\t\tthis.permissions.onchange(({action, value}) => {\n\t\t\tvar permissions = this.element.getAttribute(\"mv-permissions\") || \"\";\n\t\t\tpermissions = permissions.trim().split(/\\s+/).filter(a => a != action);\n\n\t\t\tif (value) {\n\t\t\t\tpermissions.push(action);\n\t\t\t}\n\n\t\t\tthis.element.setAttribute(\"mv-permissions\", permissions.join(\" \"));\n\t\t});\n\n\t\tthis.permissions.can([\"edit\", \"add\", \"delete\"], () => {\n\t\t\tif (this.autoEdit) {\n\t\t\t\tthis.edit();\n\t\t\t}\n\t\t});\n\n\t\t// Observe entire tree for mv-mode changes\n\t\tthis.observe({attribute: \"mv-mode\"}, ({element}) => {\n\t\t\tif (!this.permissions.edit && !this.permissions.add && !this.permissions.delete) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet nodes = _.Node.children(element);\n\n\t\t\tnodeloop: for (let i=0; i<nodes.length; i++) {\n\t\t\t\tlet node = nodes[i];\n\t\t\t\tlet previousMode = node.mode, mode;\n\n\t\t\t\tif (node.element == element) {\n\t\t\t\t\t// If attribute set directly on a Mavo node, then it forces it into that mode\n\t\t\t\t\t// otherwise, descendant nodes still inherit, unless they are also mode-restricted\n\t\t\t\t\tmode = node.element.getAttribute(\"mv-mode\");\n\t\t\t\t\tnode.modes = mode;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Inherited\n\t\t\t\t\tif (node.modes) {\n\t\t\t\t\t\t// Mode-restricted, we cannot change to the other mode\n\t\t\t\t\t\tcontinue nodeloop;\n\t\t\t\t\t}\n\n\t\t\t\t\tmode = _.getStyle(node.element.parentNode, \"--mv-mode\");\n\t\t\t\t}\n\n\t\t\t\tnode.mode = mode;\n\n\t\t\t\tif (previousMode != node.mode) {\n\t\t\t\t\tnode[node.mode == \"edit\"? \"edit\" : \"done\"]();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\n\t\tif (this.storage || this.source) {\n\t\t\t// Fetch existing data\n\t\t\tthis.permissions.can(\"read\", () => this.load());\n\t\t}\n\t\telse {\n\t\t\t// No storage or source\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.dataLoaded.resolve();\n\t\t\t\tthis.expressions.update();\n\t\t\t\t$.fire(this.element, \"mv-load\");\n\t\t\t});\n\t\t}\n\n\t\t// Dynamic ids\n\t\t$.bind(this.element, \"mv-load.mavo\", evt => {\n\t\t\tif (location.hash) {\n\t\t\t\tvar callback = () => {\n\t\t\t\t\tvar target = document.getElementById(location.hash.slice(1));\n\n\t\t\t\t\tif (target || !location.hash) {\n\t\t\t\t\t\tif (this.element.contains(target)) {\n\t\t\t\t\t\t\trequestAnimationFrame(() => { // Give the browser a chance to render\n\t\t\t\t\t\t\t\tMavo.scrollIntoViewIfNeeded(target);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn target;\n\t\t\t\t};\n\n\t\t\t\tif (!callback()) {\n\t\t\t\t\t// No target, perhaps not yet?\n\t\t\t\t\tthis.observe({attribute: \"id\", once: true}, callback);\n\t\t\t\t\t// FIXME if expressions take multiple cycles to resolve, this will not scroll to the proper id\n\t\t\t\t\t// FIXME also, if the user has started interacting with the document, we shouldn't scroll\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trequestAnimationFrame(() => Stretchy.resizeAll());\n\t\t});\n\n\n\t\tif (this.autoSave) {\n\t\t\tthis.dataLoaded.then(evt => {\n\t\t\t\tvar debouncedSave = _.debounce(() => {\n\t\t\t\t\tthis.save();\n\t\t\t\t}, this.autoSaveDelay);\n\n\t\t\t\tvar callback = evt => {\n\t\t\t\t\tif (evt.node.saved && this.autoSave) {\n\t\t\t\t\t\tdebouncedSave();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.permissions.can(\"save\", () => {\n\t\t\t\t\t\t$.bind(this.element, \"mv-change.mavo:autosave\", callback);\n\t\t\t\t\t}, () => {\n\t\t\t\t\t\t$.unbind(this.element, \"mv-change.mavo:autosave\", callback);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// Keyboard navigation\n\t\tthis.element.addEventListener(\"keydown\", evt => {\n\t\t\tvar element = evt.target;\n\n\t\t\t// Ctrl + S or Cmd + S to save\n\t\t\tif (this.permissions.save && evt.key == \"S\" && evt[_.superKey] && !evt.altKey) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tthis.save();\n\t\t\t}\n\t\t\telse if (evt.key === \"ArrowUp\" || evt.key === \"ArrowDown\") {\n\t\t\t\tif (element.matches(\"textarea, input[type=range], input[type=number]\")) {\n\t\t\t\t\t// Up/down arrow keys are meaningful here\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (element.matches(\".mv-editor\")) {\n\t\t\t\t\tvar editor = true;\n\t\t\t\t\telement = element.parentNode;\n\t\t\t\t}\n\n\t\t\t\tvar node = Mavo.Node.get(element);\n\n\t\t\t\tif (node?.closestCollection) {\n\t\t\t\t\tvar nextNode = node.getCousin(evt.key === \"ArrowUp\"? -1 : 1, {wrap: true});\n\n\t\t\t\t\tif (nextNode) {\n\t\t\t\t\t\tif (editor && nextNode.editing) {\n\t\t\t\t\t\t\tnextNode.edit();\n\t\t\t\t\t\t\tnextNode.editor.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tnextNode.element.focus();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t$.bind(this.element, \"click submit\", _.Actions.listener);\n\n\t\tMavo.hooks.run(\"init-end\", this);\n\t},\n\n\tget editing() {\n\t\treturn this.root.editing;\n\t},\n\n\tobserve (o = {}, callback) {\n\t\tlet options = Object.assign({element: this.element}, o);\n\t\treturn _.observers?.observe(options, callback);\n\t},\n\n\tunobserve (o, callback) {\n\t\tlet options = Object.assign({element: this.element}, o);\n\t\treturn _.observers?.observe(options, callback);\n\t},\n\n\tgetData: function(o) {\n\t\tlet env = {context: this, options: o};\n\t\tenv.data = this.root.getData(o);\n\t\t_.hooks.run(\"getdata-end\", env);\n\t\treturn env.data;\n\t},\n\n\ttoJSON: function() {\n\t\treturn _.toJSON(this.getData());\n\t},\n\n\tmessage: function(message, options = {}) {\n\t\treturn new _.UI.Message(this, message, options);\n\t},\n\n\terror: function(message, ...log) {\n\t\tthis.message(message, {\n\t\t\ttype: \"error\",\n\t\t\tdismiss: [\"button\", \"timeout\"]\n\t\t});\n\n\t\t// Log more info for programmers\n\t\tif (log.length > 0) {\n\t\t\tconsole.log(`%c${this.id}: ${message}`, \"color: red; font-weight: bold\", ...log);\n\t\t}\n\t},\n\n\trender: function(data) {\n\t\tvar env = {context: this, data};\n\t\t_.hooks.run(\"render-start\", env);\n\n\t\tif (env.data) {\n\t\t\tthis.root.render(env.data);\n\t\t}\n\n\t\tthis.unsavedChanges = false;\n\n\t\t_.hooks.run(\"render-end\", env);\n\t},\n\n\tedit: function() {\n\t\tthis.root.edit();\n\n\t\t// Highlight collection item when item controls are hovered\n\t\t$.bind(this.element, \"mouseenter.mavo:edit mouseleave.mavo:edit\", evt => {\n\t\t\tif (evt.target.matches(_.selectors.multiple)) {\n\t\t\t\tevt.target.classList.remove(\"mv-has-hovered-item\");\n\n\t\t\t\tvar parent = evt.target.parentNode.closest(_.selectors.multiple);\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.classList.toggle(\"mv-has-hovered-item\", evt.type == \"mouseenter\");\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\n\t\tthis.setUnsavedChanges();\n\t},\n\n\t// Conclude editing\n\tdone: function() {\n\t\tthis.root.done();\n\t\t$.unbind(this.element, \".mavo:edit\");\n\t\tthis.unsavedChanges = false;\n\t},\n\n\t/**\n\t * Set this mavo instance’s unsavedChanges flag.\n\t * @param {Boolean} [value]\n\t *        If true, just sets the flag to true, no traversal.\n\t *        If false, sets the flag of the Mavo instance and every tree node to false\n\t *        If not provided, traverses the tree and recalculates the flag value.\n\t */\n\tsetUnsavedChanges: function(value) {\n\t\tvar unsavedChanges = !!value;\n\n\t\tif (!value) {\n\t\t\tthis.walk(obj => {\n\t\t\t\tif (obj.unsavedChanges) {\n\t\t\t\t\tunsavedChanges = true;\n\n\t\t\t\t\tif (value === false) {\n\t\t\t\t\t\tobj.unsavedChanges = false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.unsavedChanges = unsavedChanges;\n\t},\n\n\t/**\n\t * Update the backend for a given role\n\t * @return {Boolean} true if a change occurred, false otherwise\n\t */\n\tupdateBackend (role) {\n\t\tlet existing = this[role], backend, changed;\n\t\tconst attribute = \"mv-\" + role;\n\n\t\tif (this.index == 1) {\n\t\t\t// This app is the first one in the page, so we can override its backend\n\t\t\t// via URL params such as ?storage=...\n\t\t\tbackend = _.Functions.url(role);\n\t\t}\n\n\t\tif (!backend) {\n\t\t\tbackend =  _.Functions.url(`${this.id}-${role}`) || this.element.getAttribute(attribute) || null;\n\t\t}\n\n\t\tif (backend) {\n\t\t\tbackend = backend.trim();\n\n\t\t\tif (backend == \"none\") {\n\t\t\t\tbackend = null;\n\t\t\t}\n\t\t}\n\n\t\tif (backend) {\n\t\t\t// Do we have any other attributes?\n\t\t\tlet prefix = attribute + \"-\";\n\t\t\tlet roleAttributes = Mavo.getAttributes(this.element, RegExp(\"^\" + prefix));\n\t\t\tlet options = Object.fromEntries(roleAttributes.map(n => [n.replace(prefix, \"\"), this.element.getAttribute(n)]));\n\n\t\t\tif (!existing?.equals?.(backend)) {\n\t\t\t\t// We have a string, convert to a backend object if different than existing\n\t\t\t\tthis[role] = backend = _.Backend.create(backend, {\n\t\t\t\t\tformat: this.element.getAttribute(\"mv-format\"), // can be overwritten by options below\n\t\t\t\t\t...options,\n\t\t\t\t\tmavo: this\n\t\t\t\t}, existing);\n\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// We had a backend and now we will un-have it\n\t\t\tthis[role] = null;\n\t\t}\n\n\t\tchanged = changed || (backend? !backend.equals(existing) : Boolean(existing));\n\n\t\tif (changed) {\n\t\t\t// A change occured\n\t\t\tif (!this.storage && !this.source && this.init) {\n\t\t\t\t// If init is present with no storage and no source, init is equivalent to source\n\t\t\t\tthis.source = this.init;\n\t\t\t\tthis.init = null;\n\t\t\t}\n\n\t\t\tvar permissions = this.storage? this.storage.permissions : new Mavo.Permissions({edit: true, save: false});\n\t\t\tpermissions.parent = this.source?.permissions;\n\t\t\tthis.permissions.parent = permissions;\n\n\t\t\tthis.primaryBackend = this.storage || this.source;\n\t\t}\n\n\t\treturn changed;\n\t},\n\n\t/**\n\t * load - Fetch data from source and render it.\n\t *\n\t * @return {Promise}  A promise that resolves when the data is loaded.\n\t */\n\tasync load () {\n\t\tvar backend = this.source || this.storage;\n\n\t\tif (!backend) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.inProgress = \"Loading\";\n\n\t\tawait backend.ready;\n\n\t\tlet data = await backend.load()\n\t\t.catch(err => {\n\t\t\t// Try again with init\n\t\t\tif (this.init && this.init != backend) {\n\t\t\t\tbackend = this.init;\n\t\t\t\treturn this.init.ready.then(() => this.init.load());\n\t\t\t}\n\n\t\t\t// No init, propagate error\n\t\t\treturn Promise.reject(err);\n\t\t})\n\t\t.catch(err => {\n\t\t\tif (err) {\n\t\t\t\tvar xhr = err instanceof XMLHttpRequest? err : err.xhr;\n\n\t\t\t\tif (xhr?.status == 404) {\n\t\t\t\t\tthis.render(null);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar message = this._(\"problem-loading\");\n\n\t\t\t\t\tif (xhr) {\n\t\t\t\t\t\tmessage += xhr.status? this._(\"http-error\", err) : \": \" + this._(\"cant-connect\");\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.error(message, err);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\tthis.render(data);\n\n\t\tthis.inProgress = false;\n\n\t\tawait Mavo.defer();\n\n\t\tthis.dataLoaded.resolve();\n\t\t$.fire(this.element, \"mv-load\");\n\t},\n\n\tasync store () {\n\t\tif (!this.storage) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.inProgress = \"Saving\";\n\n\t\tlet saved;\n\n\t\ttry {\n\t\t\tsaved = await this.storage.store(this.getData());\n\t\t}\n\t\tcatch (err) {\n\t\t\tif (err) {\n\t\t\t\tvar message = this._(\"problem-saving\");\n\n\t\t\t\tif (err instanceof XMLHttpRequest) {\n\t\t\t\t\tmessage += \": \" + (err.status? this._(\"http-error\", err) : this._(\"cant-connect\"));\n\t\t\t\t}\n\n\t\t\t\tthis.error(message, err);\n\t\t\t}\n\n\t\t\tsaved = null;\n\t\t}\n\n\t\tthis.inProgress = false;\n\t\treturn saved;\n\t},\n\n\tupload: function(file, path = \"images/\" + file.name) {\n\t\tif (!this.uploadBackend) {\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\tthis.inProgress = this._(\"uploading\");\n\n\t\treturn this.uploadBackend.upload(file, path)\n\t\t\t.then(url => {\n\t\t\t\tthis.inProgress = false;\n\t\t\t\treturn url;\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tthis.error(this._(\"error-uploading\"), err);\n\t\t\t\tthis.inProgress = false;\n\t\t\t\treturn null;\n\t\t\t});\n\t},\n\n\tasync save () {\n\t\t_.hooks.run(\"save-start\", this);\n\t\tlet saved = await this.store();\n\n\t\tif (saved) {\n\t\t\t$.fire(this.element, \"mv-save\", saved);\n\n\t\t\tthis.lastSaved = Date.now();\n\t\t\tthis.root.save();\n\t\t\tthis.unsavedChanges = false;\n\t\t}\n\t},\n\n\twalk: function() {\n\t\treturn this.root.walk(...arguments);\n\t},\n\n\tcalculateNeedsEdit: function() {\n\t\tvar needsEdit = false;\n\n\t\tthis.walk((obj, path) => {\n\t\t\tif (needsEdit) {\n\t\t\t\t// If already true, no need to descend further\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// True if both modes are allowed and node is not group\n\t\t\tneedsEdit = !obj.modes && !(obj instanceof Mavo.Group);\n\n\t\t\treturn !obj.modes;\n\t\t}, undefined, {descentReturn: true});\n\n\t\treturn needsEdit;\n\t},\n\n\tchanged: function(change) {\n\t\tif (!this.root) {\n\t\t\t// No tree yet\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.expressions.active) {\n\t\t\tthis.expressions.updateThrottled(change);\n\t\t}\n\t},\n\n\tsetDeleted: function(...nodes) {\n\t\t// Clear previous deleted item(s)\n\t\tthis.deleted.forEach(node => node.destroy());\n\t\tthis.deleted.length = [];\n\n\t\tthis.deletionNotice?.close();\n\n\t\tif (!nodes.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleted.push(...nodes);\n\n\t\tif (nodes.length == 1) {\n\t\t\tvar phrase = nodes[0].name;\n\t\t}\n\t\telse { // Multiple items deleted, possibly from multiple collections\n\t\t\tvar counts = {}, ret = [];\n\n\t\t\tnodes.forEach(n => {\n\t\t\t\tcounts[n.name] = (counts[n.name] || 0) + 1;\n\t\t\t});\n\n\t\t\tfor (var name in counts) {\n\t\t\t\tret.push(this._(\"n-items\", {name, n: counts[name]}));\n\t\t\t}\n\n\t\t\tvar phrase = ret.join(\", \");\n\t\t}\n\n\t\tvar notice = this.deletionNotice = this.message(\n\t\t\t[\n\t\t\t\tthis._(\"item-deleted\", {name: phrase}),\n\t\t\t\t{\n\t\t\t\t\ttag: \"button\",\n\t\t\t\t\ttype: \"button\",\n\t\t\t\t\ttextContent: this._(\"undo\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: evt => {\n\t\t\t\t\t\t\tthis.undoDelete();\n\t\t\t\t\t\t\tthis.deletionNotice.close(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t], {\n\t\t\t\tclasses: \"mv-deleted\",\n\t\t\t\tdismiss: {\n\t\t\t\t\tbutton: true,\n\t\t\t\t\ttimeout: 20000\n\t\t\t\t}\n\t\t\t});\n\n\t\tnotice.closed.then(undone => {\n\t\t\tif (!undone && this.deleted.length) {\n\t\t\t\t// Gone forever now\n\t\t\t\tthis.deleted.forEach(node => node.destroy());\n\t\t\t\tthis.deleted.length = 0;\n\t\t\t}\n\n\t\t\tif (this.deletionNotice == notice) {\n\t\t\t\tthis.deletionNotice = null;\n\t\t\t}\n\t\t});\n\t},\n\n\tundoDelete: function() {\n\t\tthis.deleted.forEach(node => node.collection.add(node, node.index));\n\t\tthis.deleted.length = 0;\n\t},\n\n\t// A lot of this is inspired by @hopeful2's work in https://github.com/mavoweb/mavo/pull/430\n\tdestroy () {\n\t\tMavo.hooks.run(\"mavo-destroy-start\", this);\n\n\t\tif (this.editing) {\n\t\t\tthis.done();\n\t\t}\n\n\t\t// first remove observers.\n\t\tthis.observer.destroy();\n\n\t\tthis.bar?.destroy();\n\n\t\t// .index starts from 1, .all starts from 0\n\t\t// ISSUE Should we just delete this and rearrange the other indices?\n\t\tMavo.all[this.id] = Mavo.all[this.index - 1] = null;\n\n\t\tthis.root.destroy();\n\n\t\tMavo.hooks.run(\"mavo-destroy-end\", this);\n\t},\n\n\tlive: {\n\t\tinProgress: function(value) {\n\t\t\t$.toggleAttribute(this.element, \"mv-progress\", value, value);\n\t\t\t$.toggleAttribute(this.element, \"aria-busy\", !!value, !!value);\n\t\t\tthis.element.style.setProperty(\"--mv-progress-text\", value? `\"${this._(value)}\"` : \"\");\n\t\t},\n\n\t\tunsavedChanges: function(value) {\n\t\t\tthis.element.classList.toggle(\"mv-unsaved-changes\", value);\n\t\t},\n\n\t\tneedsEdit: function(value) {\n\t\t\tif (this.bar) {\n\t\t\t\tthis.bar.toggle(\"edit\", value && this.permissions.edit);\n\t\t\t}\n\t\t},\n\n\t\tstorage: function(value) {\n\t\t\tif (value !== this._storage && !value) {\n\t\t\t\tvar permissions = new Mavo.Permissions({edit: true, save: false});\n\t\t\t\tpermissions.parent = this.permissions.parent;\n\t\t\t\tthis.permissions.parent = permissions;\n\t\t\t}\n\t\t},\n\n\t\tprimaryBackend: function(value) {\n\t\t\tvalue = value || null;\n\n\t\t\tif (value != this._primaryBackend) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t},\n\n\t\tuploadBackend: {\n\t\t\tget: function () {\n\t\t\t\tconst backend = this.uploads;\n\n\t\t\t\tif (backend?.upload) {\n\t\t\t\t\t// We need to authenticate a user if we haven't done that earlier\n\t\t\t\t\tif (backend.permissions.login) {\n\t\t\t\t\t\tbackend.login();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.uploads;\n\t\t\t\t}\n\n\t\t\t\tif (this.storage?.upload) {\n\t\t\t\t\t// Prioritize storage\n\t\t\t\t\treturn this.storage;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\tversion: \"v0.2.4\",\n\n\t\tall: {},\n\n\t\tget: function(id) {\n\t\t\tif (id instanceof Element) {\n\t\t\t\t// Get by element\n\t\t\t\tfor (var name in _.all) {\n\t\t\t\t\tif (_.all[name].element == id) {\n\t\t\t\t\t\treturn _.all[name];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar name = typeof id === \"number\"? Object.keys(_.all)[id] : id;\n\n\t\t\treturn _.all[name] || null;\n\t\t},\n\n\t\tsuperKey: navigator.platform.indexOf(\"Mac\") === 0? \"metaKey\" : \"ctrlKey\",\n\t\tbase: location.protocol == \"about:\"? (document.currentScript? document.currentScript.src : \"http://mavo.io\") : location,\n\t\tdependencies: [\n\t\t\t// Plugins.load() must be run after DOM load to pick up all mv-plugins attributes\n\t\t\t$.ready().then(() => _.Plugins.load()),\n\t\t],\n\n\t\t// Only naive tests here (no false positives, but false negatives are ok).\n\t\t// polyfill.io will do more proper checking\n\t\tpolyfillsNeeded: {\n\t\t\t\"blissfuljs\": Array.from && document.documentElement.closest && self.URL && \"searchParams\" in URL.prototype,\n\t\t\t\"Intl.~locale.en\": self.Intl,\n\t\t\t\"IntersectionObserver\": self.IntersectionObserver,\n\t\t\t\"Symbol\": self.Symbol,\n\t\t\t\"Element.prototype.remove\": Element.prototype.remove,\n\t\t\t\"Element.prototype.before\": Element.prototype.before,\n\t\t\t\"Element.prototype.after\": Element.prototype.after,\n\t\t\t\"Element.prototype.prepend\": Element.prototype.prepend,\n\t\t\t\"Array.prototype.flat\": Array.prototype.flat,\n\t\t\t\"Array.prototype.flatMap\": Array.prototype.flatMap,\n\t\t},\n\t\tpolyfills: [],\n\n\t\tinit: function(container = document) {\n\t\t\tvar mavos = Array.isArray(arguments[0])? arguments[0] : $$(_.selectors.init, container);\n\n\t\t\tvar ret = mavos.filter(element => !_.get(element)) // not already inited\n\t\t\t\t.map(element => new _(element));\n\n\t\t\treturn ret;\n\t\t},\n\n\t\tobserve (options, callback) {\n\t\t\t_.observers = _.observers || new Mavo.Observers();\n\t\t\treturn _.observers.observe(options, callback);\n\t\t},\n\n\t\tunobserve (options, callback) {\n\t\t\t_.observers.unobserve(options, callback);\n\t\t},\n\n\t\twarn: function warn(message, o = {}) {\n\t\t\twarn.history = warn.history || new Set();\n\n\t\t\tif (!_.warn.history.has(message)) {\n\t\t\t\tconsole.warn(message);\n\t\t\t}\n\n\t\t\tif (o.once !== false) {\n\t\t\t\twarn.history.add(message);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Similar to Promise.all() but can handle post-hoc additions\n\t\t * and does not reject if one promise rejects.\n\t\t */\n\t\tthenAll: function(iterable) {\n\t\t\t// Turn rejected promises into resolved ones\n\t\t\t$$(iterable).forEach(promise => {\n\t\t\t\tif ($.type(promise) == \"promise\") {\n\t\t\t\t\tpromise = promise.catch(err => err);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn Promise.all(iterable).then(resolved => {\n\t\t\t\tif (iterable.length != resolved.length) {\n\t\t\t\t\t// The list of promises or values changed. Return a new Promise.\n\t\t\t\t\t// The original promise won't resolve until the new one does.\n\t\t\t\t\treturn _.thenAll(iterable);\n\t\t\t\t}\n\n\t\t\t\t// The list of promises or values stayed the same.\n\t\t\t\t// Return results immediately.\n\t\t\t\treturn resolved;\n\t\t\t});\n\t\t},\n\n\t\tpromise: function(constructor) {\n\t\t\tvar res, rej;\n\n\t\t\tvar promise = new Promise((resolve, reject) => {\n\t\t\t\tif (typeof constructor === \"function\") {\n\t\t\t\t\tconstructor(resolve, reject);\n\t\t\t\t}\n\t\t\t\telse if (constructor instanceof Promise) {\n\t\t\t\t\tconstructor.then(resolve);\n\t\t\t\t\tconstructor.catch(reject);\n\t\t\t\t}\n\n\t\t\t\tres = resolve;\n\t\t\t\trej = reject;\n\t\t\t});\n\n\t\t\tpromise.resolve = a => {\n\t\t\t\tres(a);\n\t\t\t\treturn promise;\n\t\t\t};\n\n\t\t\tpromise.reject = a => {\n\t\t\t\trej(a);\n\t\t\t\treturn promise;\n\t\t\t};\n\n\t\t\treturn promise;\n\t\t},\n\n\t\tdefer: delay => new Promise(resolve => delay === undefined? requestAnimationFrame(resolve) : setTimeout(resolve, delay)),\n\n\t\tUI: {},\n\n\t\thooks: new $.Hooks(),\n\n\t\t// Will be filled with a union of all properties across all Mavos\n\t\tproperties: new Set(),\n\n\t\tattributes: [\n\t\t\t\"mv-app\", \"mv-storage\", \"mv-source\", \"mv-init\", \"mv-path\", \"mv-multiple-path\", \"mv-format\",\n\t\t\t\"mv-attribute\", \"mv-default\", \"mv-mode\", \"mv-edit\", \"mv-editor\", \"mv-permisssions\",\n\t\t\t\"mv-rel\", \"mv-value\"\n\t\t],\n\n\t\tlazy: {\n\t\t\tlocale: () => document.documentElement.lang || \"en-GB\"\n\t\t}\n\t}\n});\n\n// Define symbols\n// These are lazy to give the Symbol polyfill a chance to load if needed\n[\"toNode\", \"isProxy\", \"route\", \"parent\", \"property\", \"mavo\", \"groupedBy\", \"as\"].forEach(symbol => {\n\t$.lazy(_, symbol, () => Symbol(symbol));\n});\n\nObject.defineProperty(_.all, \"length\", {\n\tget: function() {\n\t\treturn Object.keys(this).length;\n\t}\n});\n\n{\n\nlet s = _.selectors = {\n\tinit: \"[mv-app], [data-mv-app]\",\n\tproperty: \"[property]\",\n\tspecificProperty: name => `[property=${name}]`,\n\tgroup: \"[typeof], [mv-group]\",\n\tprimitive: \"[property]:not([typeof]):not([mv-group])\",\n\tchildGroup: \"[typeof][property], [mv-group][property]\",\n\tmultiple: \"[mv-multiple]\",\n\tformControl: \"input, select, option, textarea\",\n\ttextInput: [\"text\", \"email\", \"url\", \"tel\", \"search\", \"number\"].map(t => `input[type=${t}]`).join(\", \") + \", input:not([type]), textarea\",\n\tui: \".mv-ui\",\n\tcontainer: {\n\t\t// \"li\": \"ul, ol\",\n\t\t\"tr\": \"table\",\n\t\t\"option\": \"select\",\n\t\t// \"dt\": \"dl\",\n\t\t// \"dd\": \"dl\"\n\t}\n};\n\n$.extend(_.selectors, {\n\titem: s.multiple + \", \" + s.group,\n\toutput: s.specificProperty(\"output\") + \", .mv-output\"\n});\n\n}\n\n$.each(_.polyfillsNeeded, (id, supported) => {\n\tif (!supported) {\n\t\t_.polyfills.push(id);\n\t}\n});\n\n_.ready = _.thenAll(_.dependencies);\n_.inited = _.promise();\n\n// Init mavo. Async to give other scripts a chance to modify stuff.\nawait _.defer();\n\nif (_.polyfills.length > 0) {\n\tvar polyfillURL = \"https://cdn.polyfill.io/v2/polyfill.min.js?unknown=polyfill&features=\" + _.polyfills.map(a => a + \"|gated\").join(\",\");\n\t_.dependencies.push($.include(polyfillURL));\n}\n\nawait $.ready();\n\n// Convert any data-mv-* attributes to mv-*\nMavo.attributeStartsWith(\"data-mv-\").forEach(attribute => {\n\tlet element = attribute.ownerElement;\n\tlet name = attribute.name.replace(\"data-\", \"\");\n\tMavo.setAttributeShy(element, name, attribute.value);\n});\n\n$$(_.selectors.init).forEach(function(elem) {\n\t// Skip if an instance has been created, for example by another script.\n\tif (!_.get(elem)) {\n\t\telem.setAttribute(\"mv-progress\", \"Loading\");\n\t}\n});\n\nawait _.ready;\n\n_.init();\n_.inited.resolve();\n\n})(Bliss, Bliss.$);\n\n(function ($, $$) {\n\nvar _ = $.extend(Mavo, {\n\t/**\n\t * Load a file, only once\n\t */\n\tload: (url, base = document.currentScript?.src ?? location) => {\n\t\treturn $.load(url, base);\n\t},\n\n\treadFile: (file, format = \"DataURL\") => {\n\t\tvar reader = new FileReader();\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treader.onload = f => resolve(reader.result);\n\t\t\treader.onerror = reader.onabort = reject;\n\t\t\treader[\"readAs\" + format](file);\n\t\t});\n\t},\n\n\ttoJSON: data => {\n\t\tif (data === null) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\t// Do not stringify twice!\n\t\t\treturn data;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.stringify(data, null, \"\\t\");\n\t\t}\n\t\tcatch (e) {\n\t\t\treturn e;\n\t\t}\n\t},\n\n\t/**\n\t * toJSON without cycles\n\t */\n\tsafeToJSON: function(o) {\n\t\tvar cache = new WeakSet();\n\n\t\treturn JSON.stringify(o, (key, value) => {\n\t\t\tif (typeof value === \"object\" && value !== null) {\n\t\t\t\t// No circular reference found\n\n\t\t\t\tif (cache.has(value)) {\n\t\t\t\t\treturn; // Circular reference found!\n\t\t\t\t}\n\n\t\t\t\tcache.add(value);\n\t\t\t}\n\n\t\t\treturn value;\n\t\t});\n\t},\n\n\t// Detect if this is a plain object, not an instance of some other class\n\tisPlainObject: o => {\n\t\tif ($.type(o) !== \"object\") {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar proto = Object.getPrototypeOf(o);\n\t\treturn proto.constructor?.name === \"Object\";\n\t},\n\n\t// Specifiy a primitive fallback for an object\n\tprimitivify: (object, primitive) => {\n\t\tif (object) {\n\t\t\tif (primitive && typeof primitive === \"object\") {\n\t\t\t\t// Primitive is objectified, must copy its metadata to avoid losing it\n\t\t\t\tObject.assign(object, primitive);\n\t\t\t\tprimitive = Mavo.value(primitive);\n\t\t\t}\n\n\t\t\tobject.valueOf = object.toJSON = object[Symbol.toPrimitive] = () => primitive;\n\t\t}\n\n\t\treturn object;\n\t},\n\n\tobjectify: (value, properties) => {\n\t\tvar primitive = Mavo.value(value);\n\n\t\tif (typeof value !== \"object\" || value === null) {\n\t\t\tif (value === null) {\n\t\t\t\tvalue = {\n\t\t\t\t\t[Symbol.toStringTag]: \"Null\",\n\t\t\t\t\ttoJSON: () => null\n\t\t\t\t};\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar constructor = value.constructor;\n\t\t\t\tvalue = new constructor(primitive);\n\t\t\t\tvalue[Symbol.toStringTag] = constructor.name;\n\t\t\t}\n\n\t\t\t_.primitivify(value, primitive);\n\t\t}\n\n\t\treturn $.extend(value, properties);\n\t},\n\n\tvalue: value => value?.valueOf? value.valueOf() : value,\n\n\t/**\n\t * Array & set utlities\n\t */\n\n\t// If the passed value is not an array, convert to an array\n\ttoArray: arr => {\n\t\treturn arr === undefined? [] : Array.isArray(arr)? arr : [arr];\n\t},\n\n\t// Delete an element from an array\n\t// @param all {Boolean} Delete more than one?\n\tdelete: (arr, element, all) => {\n\t\tdo {\n\t\t\tvar index = arr && arr.indexOf(element);\n\n\t\t\tif (index > -1) {\n\t\t\t\tarr.splice(index, 1);\n\t\t\t}\n\t\t} while (index > -1 && all);\n\t},\n\n\t// Push an item to an array iff it's not already in there\n\tpushUnique: (arr, item) => {\n\t\tif (arr.indexOf(item) === -1) {\n\t\t\tarr.push(item);\n\t\t}\n\t},\n\n\t// Adds items from set2 into set1, turns set1 into a set if it's not\n\tunion: (set1, set2) => {\n\t\tif (set1 instanceof Set && set2) {\n\t\t\tset2.forEach(x => set1.add(x));\n\t\t\treturn set1;\n\t\t}\n\n\t\treturn new Set([...(set1 || []), ...(set2 || [])]);\n\t},\n\n\t// Filter an array in place\n\t// TODO add index to callback\n\tfilter: (arr, callback) => {\n\t\tfor (var i=0; i<arr.length; i++) {\n\t\t\tif (!callback(arr[i])) {\n\t\t\t\tarr.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * DOM element utilities\n\t */\n\n\tis: function(thing, ...elements) {\n\t\tfor (let i=0, element; i < elements.length; i++) {\n\t\t\tif (elements?.[i]?.matches?.(_.selectors[thing])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t/**\n\t * Get the current value of a CSS property on an element\n\t */\n\tgetStyle: (element, property) => {\n\t\tif (element) {\n\t\t\tvar value = getComputedStyle(element).getPropertyValue(property);\n\n\t\t\treturn value?.trim();\n\t\t}\n\t},\n\t/**\n\t * Get/set data on an element\n\t */\n\tdata: function(element, name, value) {\n\t\tif (!element) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar data = _.elementData.get(element) || {}, ret;\n\n\t\tif (arguments.length == 2) {\n\t\t\tret = data[name];\n\t\t}\n\t\telse if (value === undefined) {\n\t\t\tdelete data[name];\n\t\t}\n\t\telse {\n\t\t\tret = data[name] = value;\n\t\t}\n\n\t\t_.elementData.set(element, data);\n\t\treturn ret;\n\t},\n\n\telementData: new WeakMap(),\n\n\t/**\n\t * Get node from path or get path of a node to an ancestor\n\t * For maximum robustness, all but the last path segment refer to elements only.\n\t * The last part of the path is a decimal: the integer part of the decimal is element index,\n\t * the decimal part is node index *after* that element and starts from 1.\n\t * If the node has no previous element sibling, the integer part of the index will be -1.\n\t */\n\telementPath: function (ancestor, element) {\n\t\tif (Array.isArray(element)) {\n\t\t\t// Get element by path\n\t\t\tvar path = element;\n\n\t\t\tvar ret = path.reduce((acc, cur) => {\n\t\t\t\treturn acc.children[cur >> 0] || acc;\n\t\t\t}, ancestor);\n\n\t\t\tvar last = path[path.length - 1];\n\n\t\t\tif (last != (last >> 0)) {\n\t\t\t\t// We are returning a non-element node\n\t\t\t\tvar offset = +(last + \"\").split(\".\")[1];\n\n\t\t\t\tif (last >> 0 < 0) {\n\t\t\t\t\tret = ret.firstChild;\n\t\t\t\t\toffset--;\n\t\t\t\t}\n\n\t\t\t\tfor (var i=0; i<offset; i++) {\n\t\t\t\t\tret = ret.nextSibling;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}\n\t\telse {\n\t\t\t// Get path\n\t\t\tvar path = [];\n\n\t\t\tfor (var parent = element; parent && parent != ancestor; parent = parent.parentNode) {\n\t\t\t\tvar index = 0;\n\t\t\t\tvar countNonElementSiblings = parent === element && element.nodeType !== 1;\n\t\t\t\tvar offset = countNonElementSiblings? 1 : 0;\n\t\t\t\tvar sibling = parent;\n\n\t\t\t\twhile (sibling = sibling[`previous${countNonElementSiblings? \"\" : \"Element\"}Sibling`]) {\n\t\t\t\t\tif (countNonElementSiblings) {\n\t\t\t\t\t\toffset++;\n\n\t\t\t\t\t\tif (sibling.nodeType == 1) {\n\t\t\t\t\t\t\tcountNonElementSiblings = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (offset > 0) {\n\t\t\t\t\tindex = index - 1 + \".\" + offset;\n\t\t\t\t}\n\n\t\t\t\tpath.unshift(index);\n\t\t\t}\n\n\t\t\treturn parent? path : null;\n\t\t}\n\t},\n\n\t/**\n\t * Revocably add/remove elements from the DOM\n\t */\n\trevocably: {\n\t\tadd: function(element, insert) {\n\t\t\tvar comment = _.revocably.isRemoved(element);\n\n\t\t\tif (comment?.parentNode) {\n\t\t\t\tcomment.parentNode.replaceChild(element, comment);\n\t\t\t}\n\t\t\telse if (element && insert && !element.parentNode) {\n\t\t\t\t// Has not been revocably removed because it has never even been added\n\t\t\t\tif (typeof insert === \"function\") {\n\t\t\t\t\tinsert(element);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tinsert.appendChild(element);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn comment;\n\t\t},\n\n\t\tremove: function(element, commentText) {\n\t\t\tif (!element) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar comment = _.data(element, \"commentstub\");\n\n\t\t\tif (!comment) {\n\t\t\t\tcommentText = commentText || element.id || element.className || element.nodeName;\n\t\t\t\tcomment = _.data(element, \"commentstub\", document.createComment(commentText));\n\t\t\t}\n\n\t\t\tif (element.parentNode) {\n\t\t\t\t// In DOM, remove\n\t\t\t\telement.parentNode.replaceChild(comment, element);\n\t\t\t}\n\n\t\t\treturn comment;\n\t\t},\n\n\t\tisRemoved: function(element) {\n\t\t\tif (!element || element.parentNode) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar comment = _.data(element, \"commentstub\");\n\n\t\t\tif (comment?.parentNode) {\n\t\t\t\treturn comment;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\tsetAttribute: function(element, attribute, value) {\n\t\t\tvar previousValue = _.data(element, \"attribute-\" + attribute);\n\n\t\t\tif (previousValue === undefined) {\n\t\t\t\t// Only set this when there's no old value stored, otherwise\n\t\t\t\t// if called multiple times, it could result in losing the original value\n\t\t\t\t_.data(element, \"attribute-\" + attribute, element.getAttribute(attribute));\n\t\t\t}\n\n\t\t\telement.setAttribute(attribute, value);\n\t\t},\n\n\t\trestoreAttribute: function(element, attribute) {\n\t\t\tvar previousValue = _.data(element, \"attribute-\" + attribute);\n\n\t\t\tif (previousValue !== undefined) {\n\t\t\t\t$.toggleAttribute(element, attribute, previousValue);\n\t\t\t\t_.data(element, \"attribute-\" + attribute, undefined);\n\t\t\t}\n\t\t}\n\t},\n\n\tinView: {\n\t\tis: element => {\n\t\t\tvar r = element.getBoundingClientRect();\n\n\t\t\treturn (0 <= r.bottom && r.bottom <= innerHeight || 0 <= r.top && r.top <= innerHeight) // vertical\n\t\t\t       && (0 <= r.right && r.right <= innerWidth || 0 <= r.left && r.left <= innerWidth); // horizontal\n\t\t},\n\n\t\twhen: (element, rootMargin = `${innerHeight / 2}px ${innerWidth/2}px`) => {\n\t\t\tvar observer = _.inView.observer = _.inView.observer || new IntersectionObserver(function(entries, observer) {\n\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\tif (entry.intersectionRatio > 0) {\n\t\t\t\t\t\tobserver.unobserve(entry.target);\n\t\t\t\t\t\t$.fire(entry.target, \"mv-inview\", {entry});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, {rootMargin});\n\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tif (_.is(element)) {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\n\t\t\t\tobserver.observe(element);\n\n\t\t\t\tvar callback = evt => {\n\t\t\t\t\telement.removeEventListener(\"mv-inview\", callback);\n\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\tresolve();\n\t\t\t\t};\n\n\t\t\t\telement.addEventListener(\"mv-inview\", callback);\n\t\t\t});\n\t\t}\n\t},\n\n\tscrollIntoViewIfNeeded: element => {\n\t\tif (element && !Mavo.inView.is(element)) {\n\t\t\telement.scrollIntoView({behavior: \"smooth\"});\n\t\t}\n\t},\n\n\t/**\n\t * Set attribute only if it doesn’t exist\n\t */\n\tsetAttributeShy: function(element, attribute, value) {\n\t\tif (!element.hasAttribute(attribute)) {\n\t\t\telement.setAttribute(attribute, value);\n\t\t}\n\t},\n\n\t/**\n\t * Get the value of an attribute, with fallback attributes in priority order.\n\t */\n\tgetAttribute: function(element, ...attributes) {\n\t\tfor (let i=0, attribute; attribute = attributes[i]; i++) {\n\t\t\tlet value = element.getAttribute(attribute);\n\n\t\t\tif (value) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tgetClosestAttribute: function(element, attribute) {\n\t\treturn element.closest(`[${attribute}]`)?.getAttribute(attribute) ?? null;\n\t},\n\n\t/**\n\t * Get the element identified by the URL hash\n\t */\n\tgetTarget: function() {\n\t\tvar id = location.hash.substr(1);\n\t\treturn document.getElementById(id);\n\t},\n\n\tXPath: function(query, context = document) {\n\t\tvar doc = context.ownerDocument || context;\n\t\tvar ret = [], node;\n\n\t\tif (doc.evaluate) {\n\t\t\tvar result = doc.evaluate(query, context, null, XPathResult.ANY_TYPE, null);\n\n\t\t\twhile (node = result.iterateNext()) {\n\t\t\t\tret.push(node);\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\t// Returns attribute nodes that start with `str` on or inside `context`\n\t// Use getAttributes() instead if you are only looking at the element itself and not its subtree\n\t// Use attr.ownerElement to get element\n\tattributeStartsWith: function(str, context = document.documentElement) {\n\t\treturn _.XPath(`.//@*[starts-with(name(), \"${str}\")]`, context);\n\t},\n\n\t// Returns attribute names that match a regex\n\tgetAttributes: function(element, regex) {\n\t\treturn element.getAttributeNames().filter(name => regex.test(name));\n\t},\n\n\t/**\n\t * Object utilities\n\t */\n\n\t/**\n\t * Check if property exists in object. Like the in operator but more robust and does not throw.\n\t * Why not just in? E.g. \"foo\".length is 3 but \"length\" in \"foo\" throws\n\t */\n\tin: function(property, obj) {\n\t\tif (obj) {\n\t\t\treturn (typeof obj === \"object\" && property in obj) || obj[property] !== undefined;\n\t\t}\n\t},\n\n\t/**\n\t * Get real property name from case insensitive property\n\t */\n\tgetCanonicalProperty: function(obj, property) {\n\t\tif (obj && (property || property === 0)) {\n\t\t\t// Property in object?\n\t\t\tif (_.in(property, obj)) {\n\t\t\t\treturn property;\n\t\t\t}\n\n\t\t\tif (property.toLowerCase) {\n\t\t\t\t// Lowercase property in object?\n\t\t\t\tvar propertyL = property.toLowerCase();\n\n\t\t\t\tif (_.in(propertyL, obj)) {\n\t\t\t\t\treturn propertyL;\n\t\t\t\t}\n\n\t\t\t\t// Any case property in object?\n\t\t\t\tvar properties = Object.keys(obj);\n\t\t\t\tvar i = properties.map(p => p.toLowerCase()).indexOf(propertyL);\n\n\t\t\t\tif (i > -1) {\n\t\t\t\t\treturn properties[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tsubset: function(obj, path, value) {\n\t\tif (arguments.length == 3) {\n\t\t\t// Put\n\t\t\tif (path.length) {\n\t\t\t\tvar last = path[path.length - 1];\n\t\t\t\tvar parent = $.value(obj, ...path.slice(0, -1));\n\n\t\t\t\tif (Array.isArray(parent) && Array.isArray(value)) {\n\t\t\t\t\t// Merge arrays instead of adding array inside array\n\t\t\t\t\tparent.splice(last, 1, ...value);\n\t\t\t\t}\n\t\t\t\telse if (parent) {\n\t\t\t\t\tparent[path[path.length - 1]] = value;\n\t\t\t\t}\n\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\t\telse if (typeof obj == \"object\" && path?.length) { // Get\n\t\t\treturn path.reduce((obj, property, i) => {\n\t\t\t\tvar meta = {};\n\t\t\t\tvar ret = Mavo.Functions.get(obj, property, meta);\n\n\t\t\t\t// We don't yet support multiple properties at the same level\n\t\t\t\t// i.e. the path can't be for the 2nd and 3rd item\n\t\t\t\tpath[i] = Array.isArray(meta.property)? meta.property[0] : meta.property;\n\n\t\t\t\tif (ret === undefined && meta.query) {\n\t\t\t\t\t// Not found, return dummy if query\n\t\t\t\t\tret = {[meta.query.property]: meta.query.value};\n\t\t\t\t}\n\n\t\t\t\treturn ret;\n\t\t\t}, obj);\n\t\t}\n\t\telse {\n\t\t\treturn obj;\n\t\t}\n\t},\n\n\tclone: function(o) {\n\t\tif (!o || typeof o !== \"object\") {\n\t\t\treturn o;\n\t\t}\n\n\t\treturn JSON.parse(_.safeToJSON(o));\n\t},\n\n\t// Will not work for symbols\n\tshallowClone: function(o) {\n\t\tif (!o || typeof o !== \"object\") {\n\t\t\treturn o;\n\t\t}\n\n\t\tif (Array.isArray(o)) {\n\t\t\treturn [...o];\n\t\t}\n\n\t\treturn $.extend({}, o);\n\t},\n\n\t// Credit: https://remysharp.com/2010/07/21/throttling-function-calls\n\tdebounce: function (fn, delay) {\n\t\tif (!delay) {\n\t\t\t// No throttling\n\t\t\treturn fn;\n\t\t}\n\n\t\tvar timer = null, code;\n\n\t\treturn function () {\n\t\t\tvar context = this, args = arguments;\n\n\t\t\tcode = function () {\n\t\t\t\tfn.apply(context, args);\n\t\t\t\tremoveEventListener(\"beforeunload\", code);\n\t\t\t};\n\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = setTimeout(code, delay);\n\t\t\taddEventListener(\"beforeunload\", code);\n\t\t};\n\t},\n\n\tescapeRegExp: s => s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\"),\n\n\tobserveResize: function(element, callbackOrObserver) {\n\t\tif (!self.ResizeObserver) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar previousRect = null;\n\t\tvar ro = callbackOrObserver instanceof ResizeObserver? callbackOrObserver : new ResizeObserver(entries => {\n\t\t\tvar contentRect = entries[entries.length - 1].contentRect;\n\n\t\t\tif (previousRect\n\t\t\t\t&& previousRect.width == contentRect.width\n\t\t\t\t&& previousRect.height == contentRect.height) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcallbackOrObserver(entries);\n\n\t\t\tpreviousRect = contentRect;\n\t\t});\n\n\t\tro.observe(element);\n\n\t\treturn ro;\n\t},\n\n\tObserver: class Observer {\n\t\tconstructor (element, attribute, callback, o = {}) {\n\t\t\tif (callback instanceof MutationObserver) {\n\t\t\t\tthis.observer = callback;\n\t\t\t}\n\n\t\t\tthis.observer = this.observer || new MutationObserver(callback);\n\t\t\tthis.callback = callback;\n\t\t\tthis.update(element, attribute, o);\n\n\t\t\tthis.run();\n\t\t}\n\n\t\tupdate (element, attribute, options) {\n\t\t\tthis.element = element;\n\t\t\tthis.attribute = attribute;\n\t\t\tthis.options = $.extend({}, options);\n\n\t\t\t// We use the user-provided options object verbatim if it exists and\n\t\t\t// is valid, i.e. has at least one of the required properties\n\t\t\tif (options === undefined || !options.attributes && !options.childList && !options.characterData) {\n\t\t\t\tif (this.attribute) {\n\t\t\t\t\tObject.assign(this.options, {\n\t\t\t\t\t\tattributes: true,\n\t\t\t\t\t\tattributeFilter: this.attribute == \"all\"? undefined : Mavo.toArray(this.attribute),\n\t\t\t\t\t\tattributeOldValue: !!options.oldValue\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (!this.attribute || this.attribute == \"all\") {\n\t\t\t\t\tObject.assign(this.options, {\n\t\t\t\t\t\tcharacterData: true,\n\t\t\t\t\t\tchildList: true,\n\t\t\t\t\t\tsubtree: true,\n\t\t\t\t\t\tcharacterDataOldValue: !!options.oldValue\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.observer?.running) {\n\t\t\t\tthis.stop();\n\t\t\t\tthis.run();\n\t\t\t}\n\t\t}\n\n\t\tflush () {\n\t\t\tlet records = this.observer?.takeRecords();\n\n\t\t\tif (records) {\n\t\t\t\tthis.callback(records);\n\t\t\t}\n\t\t}\n\n\t\tstop () {\n\t\t\tthis.observer?.disconnect();\n\t\t\tthis.running = false;\n\t\t\treturn this;\n\t\t}\n\n\t\trun () {\n\t\t\tif (this.observer) {\n\t\t\t\tthis.observer.observe(this.element, this.options);\n\t\t\t\tthis.running = true;\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\n\t\t/**\n\t\t * Like stop(), but saves running state and then resumes it\n\t\t */\n\t\tpause () {\n\t\t\tthis.runOnResume = this.running;\n\t\t\tthis.stop();\n\t\t}\n\n\t\t/**\n\t\t * Like run(), but runs only if observer was running before pause().\n\t\t */\n\t\tresume () {\n\t\t\tif (this.runOnResume !== false) {\n\t\t\t\tthis.run();\n\t\t\t}\n\n\t\t\tdelete this.runOnResume;\n\t\t}\n\n\t\tdestroy () {\n\t\t\tthis.stop();\n\t\t\tthis.observer = this.element = null;\n\t\t}\n\t},\n\n\t/**\n\t * Run & Return a function\n\t */\n\trr: function(f) {\n\t\tf();\n\t\treturn f;\n\t},\n\n\t// Get out of bounds array index to wrap around\n\twrap: (index, length) => index < 0? length - 1 : index >= length? 0 : index,\n\n\t/**\n\t * Parses a simple CSS-like text format for declaring key-value options:\n\t * Pairs are comma or semicolon-separated, key and value are colon separated.\n\t * Escapes are supported, via backslash. Useful for attributes.\n\t */\n\toptions: str => {\n\t\tvar ret = {};\n\n\t\tstr.trim().match(/(?:\\\\[,;]|[^,;])+/g)?.forEach(option => {\n\t\t\tif (option) {\n\t\t\t\toption = option.trim().replace(/\\\\([,;])/g, \"$1\");\n\t\t\t\tvar pair = option.match(/^\\s*((?:\\\\:|[^:])+?)\\s*:\\s*(.+)$/);\n\n\t\t\t\tif (pair) {\n\t\t\t\t\tret[pair[1].replace(/\\\\:/g, \":\")] = pair[2];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// If no value, it's boolean\n\t\t\t\t\tret[option] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn ret;\n\t},\n\n\t/**\n\t * Map that can hold multiple values per key\n\t */\n\tBucketMap: class BucketMap {\n\t\tconstructor({arrays = false} = {}) {\n\t\t\tthis.map = new Map();\n\t\t\tthis[Symbol.iterator] = this.map[Symbol.iterator];\n\t\t\tthis.arrays = arrays;\n\t\t}\n\n\t\tset(key, value) {\n\t\t\tif (this.arrays) {\n\t\t\t\tvar values = this.map.get(key) || [];\n\t\t\t\tvalues.push(value);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar values = this.map.get(key) || new Set();\n\t\t\t\tvalues.add(value);\n\t\t\t}\n\n\t\t\tthis.map.set(key, values);\n\t\t}\n\n\t\tdelete(key, value) {\n\t\t\tif (arguments.length == 2) {\n\t\t\t\tvar values = this.map.get(key);\n\n\t\t\t\tif (values) {\n\t\t\t\t\tif (this.arrays) {\n\t\t\t\t\t\t_.delete(values, value);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalues.delete(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.map.delete(key);\n\t\t\t}\n\t\t}\n\n\t\tforEach(...args) {\n\t\t\treturn this.map.forEach(...args);\n\t\t}\n\t}\n});\n\n/**\n * Collection of fake \"observers\" implemented over one large MutationObserver\n */\n_.Observers = class Observers extends Map {\n\tconstructor({observer, callback} = {}) {\n\t\tsuper();\n\n\t\tlet self = _.Observers;\n\t\tthis.callback = callback || self.callback;\n\t\tthis.observer = observer || (self.observer = self.observer || new MutationObserver(this.callback));\n\t}\n\n\tapplyRecord (r) {\n\t\tfor (let [o, callback] of this.entries()) {\n\t\t\tif (_.Observers.matchesRecord(o, r)) {\n\t\t\t\t// If we are here, the observer matches\n\t\t\t\tcallback.call(this, {\n\t\t\t\t\tnode: Mavo.Node.get(r.target, true),\n\t\t\t\t\telement: r.target,\n\t\t\t\t\ttype: r.type,\n\t\t\t\t\tattribute: r.attributeName,\n\t\t\t\t\trecord: r\n\t\t\t\t});\n\n\t\t\t\tif (o.once) {\n\t\t\t\t\tthis.unobserve(o, callback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic matchesRecord (o, r) {\n\t\tif (o.active === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet element = r.target;\n\n\t\tif (o.selector && !element.matches?.(o.selector)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (o.attribute) {\n\t\t\t// We are monitoring attribute changes only\n\t\t\tif (r.type !== \"attributes\") {\n\t\t\t\t// Not an attribute change\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (o.attribute !== true && o.attribute !== r.attributeName && !o.attribute.includes?.(r.attributeName)) {\n\t\t\t\t// We are monitoring specific attribute(s), and a different one changed\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse if (r.type === \"attributes\" && o.attribute === false) {\n\t\t\t// We explicitly opted out monitoring attributes, and an attribute has changed\n\t\t\treturn false;\n\t\t}\n\n\t\tif (o.element) {\n\t\t\tif (o.deep === false) {\n\t\t\t\treturn element === o.element;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn o.element.contains(element);\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tflush () {\n\t\tlet records = this.observer.takeRecords();\n\n\t\tif (records) {\n\t\t\tthis.callback(records);\n\t\t}\n\t}\n\n\tobserve (o = {}, callback) {\n\t\tthis.set(o, callback);\n\t\treturn callback;\n\t}\n\n\tunobserve (options, callback) {\n\t\tlet matches = this.find(options, callback);\n\n\t\tfor (let [o, c] of matches.entries()) {\n\t\t\tthis.delete(o);\n\t\t}\n\t}\n\n\tpause (options) {\n\t\tlet matches = this.find(options);\n\n\t\tfor (let [o, c] of matches.entries()) {\n\t\t\t// Decativate and store active state\n\t\t\to._active = o.active !== false && o._active !== false;\n\t\t\to.active = false;\n\t\t}\n\n\t\tthis.flush();\n\n\t\treturn matches;\n\t}\n\n\tresume (matches) {\n\t\tif (!(matches instanceof _.Observers)) {\n\t\t\tmatches = this.find(matches);\n\t\t}\n\n\t\tthis.flush();\n\n\t\tfor (let [o, c] of matches.entries()) {\n\t\t\t// Restore active state\n\t\t\to.active = o.active || o._active;\n\t\t\tdelete o._active;\n\t\t}\n\t}\n\n\tfind (options, callback) {\n\t\tlet keys = Object.keys(options);\n\t\tlet ret = new Mavo.Observers();\n\n\t\tfor (let [o, c] of this.entries()) {\n\t\t\tif (callback && callback !== c) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (keys.every(k => o[k] === options[k])) {\n\t\t\t\tret.set(o, c);\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t}\n};\n\n// Default callback\n_.Observers.callback = records => {\n\tif (this.size === 0) {\n\t\treturn;\n\t}\n\n\tfor (let r of records) {\n\t\t_.observers.applyRecord(r);\n\t}\n};\n\n// Bliss plugins\n\n// Provide shortcuts to long property chains\n$.proxy = $.classProps.proxy = $.overload(function(obj, property, proxy) {\n\tObject.defineProperty(obj, property, {\n\t\tget: function() {\n\t\t\treturn this[proxy][property];\n\t\t},\n\t\tset: function(value) {\n\t\t\tthis[proxy][property] = value;\n\t\t},\n\t\tconfigurable: true,\n\t\tenumerable: true\n\t});\n\n\treturn obj;\n});\n\n// :target-within shim\nfunction updateTargetWithin() {\n\tvar element = _.getTarget();\n\tconst cl = \"mv-target-within\";\n\n\t$$(\".\" + cl).forEach(el => el.classList.remove(cl));\n\n\twhile (element?.classList) {\n\t\telement.classList.add(cl);\n\t\telement = element.parentNode;\n\t}\n};\n\ndocument.addEventListener(\"mv-load\", updateTargetWithin);\naddEventListener(\"hashchange\", updateTargetWithin);\nMavo.observe({attribute: \"id\"}, updateTargetWithin);\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Locale = $.Class({\n\tconstructor: function(lang, phrases) {\n\t\tthis.lang = lang;\n\t\tthis.phrases = {};\n\t\tthis.extend(phrases);\n\t},\n\n\tget fallback() {\n\t\t// TODO should we fallback to other dialects? I.e. should en-US fallback to en-GB if en didn't exist?\n\t\tif (_.all[this.baseLang]) {\n\t\t\treturn _.all[this.baseLang];\n\t\t}\n\n\t\tif (this !== _.default) {\n\t\t\treturn _.default;\n\t\t}\n\t},\n\n\textend: function(phrases) {\n\t\t$.extend(this.phrases, phrases);\n\t},\n\n\tphrase: function(id, vars) {\n\t\tvar key = id.toLowerCase();\n\t\tvar phrase = this.phrases[key];\n\n\t\tif (phrase === undefined && this.fallback) {\n\t\t\tphrase = this.fallback.phrase(key);\n\t\t}\n\n\t\tif (phrase === undefined) {\n\t\t\t// Everything failed, use id\n\t\t\tphrase = key.replace(/\\b-\\b/g, \" \");\n\t\t}\n\t\telse if (vars) {\n\t\t\tvar keys = phrase.match(/\\{\\w+(?=\\})/g)?.map(v => v.slice(1)) ?? [];\n\t\t\tMavo.Functions.unique(keys).forEach(name => {\n\t\t\t\tif (name in vars) {\n\t\t\t\t\tphrase = phrase.replace(RegExp(`{${name}}`, \"gi\"), vars[name]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn phrase;\n\t},\n\n\tlive: {\n\t\tlang: function(lang) {\n\t\t\tthis.baseLang = _.getBaseLang(lang);\n\n\t\t\tif (lang == this.baseLang) {\n\t\t\t\tthis.baseLang = null;\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\tall: {},\n\n\t\t/**\n\t\t * Register new locale or extend existing locale\n\t\t */\n\t\tregister: function(lang, phrases) {\n\t\t\tif (_.all[lang]) {\n\t\t\t\t_.all[lang].extend(phrases);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_.all[lang] = new _(lang, phrases);\n\t\t\t}\n\t\t},\n\n\t\t// Get locale for a given language, use its base as fallback\n\t\tmatch: function(lang = \"\") {\n\t\t\treturn _.all[lang] || _.all[_.getBaseLang(lang)];\n\t\t},\n\n\t\t// Get locale for a given language, use its base as fallback, and the default locale if nothing exists\n\t\tget: function(lang) {\n\t\t\treturn _.match(lang) || _.default;\n\t\t},\n\n\t\tgetBaseLang: function(lang) {\n\t\t\treturn lang.split(\"-\")[0];\n\t\t},\n\n\t\tlazy: {\n\t\t\tdefault: () => {\n\t\t\t\treturn _.match(Mavo.locale) || _.all.en;\n\t\t\t}\n\t\t}\n\t}\n});\n\n/**\n * Use phrase\n */\nMavo.prototype._ = function(id, vars) {\n\treturn this.locale && id? this.locale.phrase(id, vars) : id;\n};\n\nMavo.ready.then(() => {\n\t$$(\"datalist.mv-phrases[lang]\").forEach(datalist => {\n\t\tvar phrases = $$(\"option\", datalist).reduce((o, option) => {\n\t\t\to[option.value] = option.textContent.trim();\n\t\t\treturn o;\n\t\t}, {});\n\n\t\tMavo.Locale.register(datalist.lang, phrases);\n\t});\n});\n\n})(Bliss, Bliss.$);\n\nMavo.Locale.register(\"en\", {\n\t\"second\": \"second\",\n\t\"seconds\": \"seconds\",\n\t\"minute\": \"minute\",\n\t\"minutes\": \"minutes\",\n\t\"hour\": \"hour\",\n\t\"hours\": \"hours\",\n\t\"day\": \"day\",\n\t\"days\": \"days\",\n\t\"week\": \"week\",\n\t\"weeks\": \"weeks\",\n\t\"month\": \"month\",\n\t\"months\": \"months\",\n\t\"year\": \"year\",\n\t\"years\": \"years\",\n\t\"edit\": \"Edit\",\n\t\"editing\": \"Editing\",\n\t\"save\": \"Save\",\n\t\"import\": \"Import\",\n\t\"export\": \"Export\",\n\t\"logout\": \"Logout\",\n\t\"login\": \"Login\",\n\t\"loading\": \"Loading\",\n\t\"uploading\": \"Uploading\",\n\t\"saving\": \"Saving\",\n\t\"dismiss\": \"Dismiss\",\n\t\"logged-in-as\": \"Logged in to {id} as \",\n\t\"login-to\": \"Login to {id}\",\n\t\"error-uploading\": \"Error uploading file\",\n\t\"cannot-load-uploaded-file\": \"Cannot load uploaded file\",\n\t\"filename\": \"Filename?\",\n\t\"problem-saving\": \"Problem saving data\",\n\t\"problem-loading\": \"Problem loading data\",\n\t\"cannot-parse\": \"Can’t understand this file\",\n\t\"http-error\": \"HTTP error {status}: {statusText}\",\n\t\"cant-connect\": \"Can’t connect to the Internet\",\n\t\"add-item\": \"Add {name}\",\n\t\"add-item-before\": \"Add new {name} before\",\n\t\"add-item-after\": \"Add new {name} after\",\n\t\"drag-to-reorder\": \"Drag to reorder {name}\",\n\t\"delete-item\": \"Delete this {name}\",\n\t\"item-deleted\": \"{name} deleted\",\n\t\"n-items\": \"{n} {name} items\",\n\t\"undo\": \"Undo\",\n\t\"gh-updated-file\": \"Updated {name}\",\n\t\"gh-login-fork-options\": \"You have your own copy of this page, would you like to use it?\",\n\t\"gh-use-my-fork\": \"Yes, show me my data.\"\n});\n\n(function ($, $$) {\n\nMavo.attributes.push(\"mv-plugins\");\n\nvar _ = Mavo.Plugins = {\n\tloaded: {},\n\n\tasync load () {\n\t\t_.plugins = new Set();\n\n\t\t$$(\"[mv-plugins]\").forEach(element => {\n\t\t\telement\n\t\t\t\t.getAttribute(\"mv-plugins\").trim().split(/\\s+/)\n\t\t\t\t.forEach(plugin => _.plugins.add(plugin));\n\t\t});\n\n\t\tif (!_.plugins.size) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Fetch plugin index\n\t\tlet response = await fetch(_.url + \"/plugins.json\");\n\t\tlet json = await response.json();\n\t\tlet plugin = json.plugin;\n\n\t\t// Fetch plugins\n\t\treturn Mavo.thenAll(plugin\n\t\t\t.filter(plugin => _.plugins.has(plugin.id))\n\t\t\t.map(plugin => {\n\t\t\t\tif (_.loaded[plugin.id]) {\n\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t}\n\n\t\t\t\t// Load plugin\n\t\t\t\tvar filename = `mavo-${plugin.id}.js`;\n\n\t\t\t\tif (plugin.repo) {\n\t\t\t\t\t// Plugin hosted in a separate repo\n\t\t\t\t\tvar url = `https://cdn.jsdelivr.net/gh/${plugin.repo}@master/${filename}`;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Plugin hosted in the mavo-plugins repo\n\t\t\t\t\tvar url = `${_.url}/${plugin.id}/${filename}`;\n\t\t\t\t}\n\n\t\t\t\treturn $.include(_.loaded[plugin.id], url);\n\t\t\t}));\n\t},\n\n\tregister: function(name, o = {}) {\n\t\tif (_.loaded[name]) {\n\t\t\t// Do not register same plugin twice\n\t\t\treturn;\n\t\t}\n\n\t\tMavo.hooks.add(o.hooks);\n\n\t\tfor (let Class in o.extend) {\n\t\t\tlet existing = Class == \"Mavo\"? Mavo : Mavo[Class];\n\n\t\t\tif ($.type(existing) === \"function\") {\n\t\t\t\t$.Class(existing, o.extend[Class]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$.extend(existing, o.extend[Class]);\n\t\t\t}\n\t\t}\n\n\t\tvar ready = [];\n\n\t\tif (o.ready) {\n\t\t\tready.push(o.ready);\n\t\t}\n\n\t\tif (o.dependencies) {\n\t\t\tvar base = document.currentScript? document.currentScript.src : location;\n\t\t\tvar dependencies = o.dependencies.map(url => Mavo.load(url, base));\n\t\t\tready.push(...dependencies);\n\t\t}\n\n\t\tif (ready.length) {\n\t\t\tMavo.dependencies.push(...ready);\n\t\t}\n\n\t\t_.loaded[name] = o;\n\n\t\tif (o.init) {\n\t\t\tPromise.all(ready).then(() => o.init());\n\t\t}\n\t},\n\n\turl: \"https://plugins.mavo.io\"\n};\n\n})(Bliss, Bliss.$);\n\n(function ($, $$) {\n\nMavo.attributes.push(\"mv-bar\");\n\nvar _ = Mavo.UI.Bar = $.Class({\n\tconstructor: function(mavo) {\n\t\tthis.mavo = mavo;\n\n\t\tthis.element = $(\".mv-bar\", this.mavo.element);\n\t\tthis.template = this.mavo.element.getAttribute(\"mv-bar\") || \"\";\n\n\t\tif (this.element) {\n\t\t\tthis.custom = true;\n\t\t\tthis.template += \" \" + (this.element.getAttribute(\"mv-bar\") || \"\");\n\t\t\tthis.template = this.template.trim();\n\n\t\t\tfor (let id in _.controls) {\n\t\t\t\tthis[id] = $(`.mv-${id}`, this.element);\n\n\t\t\t\tif (this[id]) {\n\t\t\t\t\tthis.template = this.template || \"with\";\n\t\t\t\t\tthis.template += ` ${id}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.element = $.create({\n\t\t\t\tclassName: \"mv-bar mv-ui\",\n\t\t\t\tstart: this.mavo.element,\n\t\t\t\tinnerHTML: \"<button>&nbsp;</button>\"\n\t\t\t});\n\t\t}\n\n\t\tif (this.element.classList.contains(\"mv-compact\")) {\n\t\t\tthis.noResize = true;\n\t\t}\n\n\t\tthis.controls = _.getControls(this.template);\n\n\t\tif (this.controls.length) {\n\t\t\t// Measure height of 1 row\n\t\t\tthis.targetHeight = this.element.offsetHeight;\n\t\t}\n\n\t\tif (!this.custom) {\n\t\t\tthis.element.innerHTML = \"\";\n\t\t}\n\n\t\tthis.controls.forEach(id => {\n\t\t\tlet o = _.controls[id];\n\n\t\t\tif (this[id]) {\n\t\t\t\t// Custom control, remove to not mess up order\n\t\t\t\tthis[id].remove();\n\t\t\t}\n\n\t\t\tif (o.create) {\n\t\t\t\tthis[id] = o.create.call(this.mavo, this[id]);\n\t\t\t}\n\t\t\telse if (!this[id]) {\n\t\t\t\tthis[id] = $.create(\"button\", {\n\t\t\t\t\ttype: \"button\",\n\t\t\t\t\tclassName: `mv-${id}`,\n\t\t\t\t\ttextContent: this.mavo._(id)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// We initially add all of them to retain order,\n\t\t\t// then we remove revocably when/if needed\n\t\t\tthis.add(id);\n\n\t\t\tif (o.permission) {\n\t\t\t\tthis.permissions.can(o.permission, () => {\n\t\t\t\t\tthis.toggle(id, !o.condition || o.condition.call(this.mavo));\n\t\t\t\t}, () => {\n\t\t\t\t\tthis.remove(id);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (o.condition && !o.condition.call(this.mavo)) {\n\t\t\t\tthis.remove(id);\n\t\t\t}\n\n\t\t\tfor (var events in o.events) {\n\t\t\t\t$.bind(this[id], events, o.events[events].bind(this.mavo));\n\t\t\t}\n\t\t});\n\n\t\tfor (let id in _.controls) {\n\t\t\tlet o = _.controls[id];\n\n\t\t\tif (o.action) {\n\t\t\t\t$.delegate(this.mavo.element, \"click\", \".mv-\" + id, evt => {\n\t\t\t\t\tif (!o.permission || this.permissions.is(o.permission)) {\n\t\t\t\t\t\to.action.call(this.mavo);\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (this.controls.length && !this.noResize) {\n\t\t\tthis.resize();\n\n\t\t\tif (self.ResizeObserver) {\n\t\t\t\tthis.resizeObserver = Mavo.observeResize(this.element, entries => {\n\t\t\t\t\tthis.resize();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\tresize: function() {\n\t\tif (!this.targetHeight) {\n\t\t\t// We don't have a correct measurement for target height, abort\n\t\t\tthis.targetHeight = this.element.offsetHeight;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.resizeObserver?.disconnect();\n\n\t\tthis.element.classList.remove(\"mv-compact\", \"mv-tiny\");\n\n\t\t// Remove pointless tooltips\n\t\t$$(\"button, .mv-button\", this.element).forEach(button => {\n\t\t\tif (button.title === button.textContent) {\n\t\t\t\tbutton.title = \"\";\n\t\t\t}\n\t\t});\n\n\t\t// Exceeded single row?\n\t\tif (this.element.offsetHeight > this.targetHeight * 1.6) {\n\t\t\tthis.element.classList.add(\"mv-compact\");\n\n\t\t\tif (this.element.offsetHeight > this.targetHeight * 1.2) {\n\t\t\t\t// Still too tall\n\t\t\t\tthis.element.classList.add(\"mv-tiny\");\n\n\t\t\t\t// Add tooltips, since only icons will be visible\n\t\t\t\t$$(\"button, .mv-button\", this.element).forEach(button => {\n\t\t\t\t\tif (!button.title) {\n\t\t\t\t\t\tbutton.title = button.textContent;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.resizeObserver?.observe(this.element);\n\t},\n\n\tadd: function(id) {\n\t\tvar o = _.controls[id];\n\n\t\tif (o.prepare) {\n\t\t\to.prepare.call(this.mavo);\n\t\t}\n\n\t\tMavo.revocably.add(this[id], this.element);\n\n\t\tif (!this.resizeObserver && !this.noResize) {\n\t\t\trequestAnimationFrame(() => this.resize());\n\t\t}\n\t},\n\n\tremove: function(id) {\n\t\tvar o =_.controls[id];\n\n\t\tMavo.revocably.remove(this[id], \"mv-\" + id);\n\n\t\tif (o.cleanup) {\n\t\t\to.cleanup.call(this.mavo);\n\t\t}\n\n\t\tif (!this.resizeObserver && !this.noResize) {\n\t\t\trequestAnimationFrame(() => this.resize());\n\t\t}\n\t},\n\n\ttoggle: function(id, add) {\n\t\treturn this[add? \"add\" : \"remove\"](id);\n\t},\n\n\tproxy: {\n\t\t\"permissions\": \"mavo\"\n\t},\n\n\tdestroy () {\n\t\tthis.resizeObserver.disconnect();\n\t\tthis.resizeObserver = null;\n\t},\n\n\tstatic: {\n\t\tgetControls: function(template) {\n\t\t\tvar all = Object.keys(_.controls);\n\n\t\t\tif (template && (template = template.trim())) {\n\t\t\t\tif (template == \"none\") {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tvar relative = /^with\\s|\\b(yes|no)-\\w+\\b/.test(template);\n\t\t\t\ttemplate = template.replace(/\\byes-|^with\\s+/g, \"\");\n\t\t\t\tvar ids = template.split(/\\s+/);\n\n\t\t\t\t// Drop duplicates (last one wins)\n\t\t\t\tids = Mavo.Functions.unique(ids.reverse()).reverse();\n\n\t\t\t\tif (relative) {\n\t\t\t\t\treturn all.filter(id => {\n\t\t\t\t\t\tvar positive = ids.lastIndexOf(id);\n\t\t\t\t\t\tvar negative = ids.lastIndexOf(\"no-\" + id);\n\t\t\t\t\t\tvar keep = positive > Math.max(-1, negative);\n\t\t\t\t\t\tvar drop = negative > Math.max(-1, positive);\n\n\t\t\t\t\t\treturn keep || (!_.controls[id].optional && !drop);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn ids;\n\t\t\t}\n\n\t\t\t// No template, return default set\n\t\t\treturn all.filter(id => !_.controls[id].optional);\n\t\t},\n\n\t\tcontrols: {\n\t\t\tstatus: {\n\t\t\t\tcreate: function(custom) {\n\t\t\t\t\treturn custom || $.create({\n\t\t\t\t\t\tclassName: \"mv-status\"\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tprepare: function() {\n\t\t\t\t\tvar backend = this.primaryBackend;\n\n\t\t\t\t\tif (backend?.user) {\n\t\t\t\t\t\tvar user = backend.user;\n\t\t\t\t\t\tvar html = [user.name || \"\"];\n\n\t\t\t\t\t\tif (user.avatar) {\n\t\t\t\t\t\t\thtml.unshift($.create(\"img\", {\n\t\t\t\t\t\t\t\tclassName: \"mv-avatar\",\n\t\t\t\t\t\t\t\tsrc: user.avatar\n\t\t\t\t\t\t\t}), \" \");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (user.url) {\n\t\t\t\t\t\t\thtml = [$.create(\"a\", {\n\t\t\t\t\t\t\t\thref: user.url,\n\t\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t\t\tcontents: html\n\t\t\t\t\t\t\t})];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.bar.status.textContent = \"\";\n\t\t\t\t\t\t$.contents(this.bar.status, [\n\t\t\t\t\t\t\t{tag: \"span\", innerHTML: this._(\"logged-in-as\", backend)},\n\t\t\t\t\t\t\t\" \",\n\t\t\t\t\t\t\t...html\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpermission: \"logout\"\n\t\t\t},\n\n\t\t\tedit: {\n\t\t\t\taction: function() {\n\t\t\t\t\tif (this.editing) {\n\t\t\t\t\t\tthis.done();\n\t\t\t\t\t\tthis.bar.edit.textContent = this._(\"edit\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.edit();\n\t\t\t\t\t\tthis.bar.edit.textContent = this._(\"editing\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpermission: [\"edit\", \"add\", \"delete\"],\n\t\t\t\tcleanup: function() {\n\t\t\t\t\tif (this.editing) {\n\t\t\t\t\t\tthis.done();\n\n\t\t\t\t\t\tif (this.bar?.edit) {\n\t\t\t\t\t\t\tthis.bar.edit.textContent = this._(\"edit\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcondition: function() {\n\t\t\t\t\treturn this.needsEdit;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsave: {\n\t\t\t\taction: function() {\n\t\t\t\t\tthis.save();\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t\"mouseenter focus\": function() {\n\t\t\t\t\t\tthis.element.classList.add(\"mv-highlight-unsaved\");\n\t\t\t\t\t},\n\t\t\t\t\t\"mouseleave blur\": function() {\n\t\t\t\t\t\tthis.element.classList.remove(\"mv-highlight-unsaved\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpermission: \"save\",\n\t\t\t\tcondition: function() {\n\t\t\t\t\treturn !this.autoSave || this.autoSaveDelay > 0;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\texport: {\n\t\t\t\tcreate: function(custom) {\n\t\t\t\t\tvar a;\n\n\t\t\t\t\tif (custom) {\n\t\t\t\t\t\ta = custom.matches(\"a\")? custom : $.create(\"a\", {\n\t\t\t\t\t\t\tclassName: \"mv-button\",\n\t\t\t\t\t\t\taround: custom\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ta = $.create(\"a\", {\n\t\t\t\t\t\t\tclassName: \"mv-export mv-button\",\n\t\t\t\t\t\t\ttextContent: this._(\"export\")\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\ta.setAttribute(\"download\", this.id + \".json\");\n\n\t\t\t\t\treturn a;\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tmousedown: function() {\n\t\t\t\t\t\tthis.bar.export.href = \"data:application/json;charset=UTF-8,\" + encodeURIComponent(this.toJSON());\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpermission: \"edit\",\n\t\t\t\toptional: true\n\t\t\t},\n\n\t\t\timport: {\n\t\t\t\tcreate: function(custom) {\n\t\t\t\t\tvar button = custom || $.create(\"span\", {\n\t\t\t\t\t\trole: \"button\",\n\t\t\t\t\t\ttabIndex: \"0\",\n\t\t\t\t\t\tclassName: \"mv-import mv-button\",\n\t\t\t\t\t\ttextContent: this._(\"import\"),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tfocus: evt => {\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tvar input = $.create(\"input\", {\n\t\t\t\t\t\ttype: \"file\",\n\t\t\t\t\t\tinside: button,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tchange: evt => {\n\t\t\t\t\t\t\t\tvar file = evt.target.files[0];\n\n\t\t\t\t\t\t\t\tif (file) {\n\t\t\t\t\t\t\t\t\tvar reader = $.extend(new FileReader(), {\n\t\t\t\t\t\t\t\t\t\tonload: evt => {\n\t\t\t\t\t\t\t\t\t\t\tthis.inProgress = false;\n\n\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\tvar json = JSON.parse(reader.result);\n\t\t\t\t\t\t\t\t\t\t\t\tthis.render(json);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.error(this._(\"cannot-parse\"));\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tonerror: evt => {\n\t\t\t\t\t\t\t\t\t\t\tthis.error(this._(\"problem-loading\"));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tthis.inProgress = this._(\"uploading\");\n\t\t\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\treturn button;\n\t\t\t\t},\n\t\t\t\toptional: true\n\t\t\t},\n\n\t\t\tlogin: {\n\t\t\t\taction: function() {\n\t\t\t\t\tthis.primaryBackend.login();\n\t\t\t\t},\n\t\t\t\tpermission: \"login\"\n\t\t\t},\n\n\t\t\tlogout: {\n\t\t\t\taction: function() {\n\t\t\t\t\tthis.primaryBackend.logout();\n\t\t\t\t},\n\t\t\t\tpermission: \"logout\"\n\t\t\t}\n\t\t},\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function ($, $$) {\n\nvar _ = Mavo.UI.Message = $.Class({\n\tconstructor: function(mavo, message, o = {}) {\n\t\tthis.mavo = mavo;\n\t\tthis.message = message;\n\t\tthis.closed = Mavo.promise();\n\t\tthis.options = o;\n\n\t\tthis.element = $.create({\n\t\t\tclassName: \"mv-ui mv-message\" + (o.type? \" mv-\" + o.type : \"\"),\n\t\t\t[$.type(this.message) == \"string\"? \"innerHTML\" : \"contents\"]: this.message,\n\t\t\tevents: {\n\t\t\t\tclick: e => Mavo.scrollIntoViewIfNeeded(this.mavo.element)\n\t\t\t},\n\t\t\t[this.mavo.bar? \"after\" : \"start\"]: (this.mavo.bar || this.mavo).element\n\t\t});\n\n\t\tif (o.style) {\n\t\t\t$.style(this.element, o.style);\n\t\t}\n\n\t\tif (o.classes) {\n\t\t\tthis.element.classList.add(...o.classes.split(/\\s+/));\n\t\t}\n\n\t\tif (o.type == \"error\") {\n\t\t\tthis.element.setAttribute(\"role\", \"alert\");\n\t\t}\n\t\telse {\n\t\t\tthis.element.setAttribute(\"aria-live\", \"polite\");\n\t\t}\n\n\t\to.dismiss = o.dismiss || {};\n\n\t\tif (typeof o.dismiss == \"string\" || Array.isArray(o.dismiss)) {\n\t\t\tvar dismiss = {};\n\n\t\t\tMavo.toArray(o.dismiss).forEach(prop => {\n\t\t\t\tdismiss[prop] = true;\n\t\t\t});\n\n\t\t\to.dismiss = dismiss;\n\t\t}\n\n\t\tif (o.dismiss.button) {\n\t\t\t$.create(\"button\", {\n\t\t\t\ttype: \"button\",\n\t\t\t\tclassName: \"mv-close mv-ui\",\n\t\t\t\ttextContent: \"×\",\n\t\t\t\tevents: {\n\t\t\t\t\t\"click\": evt => this.close()\n\t\t\t\t},\n\t\t\t\tstart: this.element,\n\t\t\t\ttitle: this.mavo._(\"dismiss\")\n\t\t\t});\n\t\t}\n\n\t\tif (o.dismiss.timeout) {\n\t\t\tvar timeout = typeof o.dismiss.timeout === \"number\"? o.dismiss.timeout : 5000;\n\n\t\t\t$.bind(this.element, {\n\t\t\t\tmouseenter: e => clearTimeout(this.closeTimeout),\n\t\t\t\tmouseleave: Mavo.rr(e => this.closeTimeout = setTimeout(() => this.close(), timeout)),\n\t\t\t});\n\t\t}\n\n\t\tif (o.dismiss.submit) {\n\t\t\tthis.element.addEventListener(\"submit\", evt => {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tthis.close(evt.target);\n\t\t\t});\n\t\t}\n\t},\n\n\tasync close (resolve) {\n\t\t// clearTimeout, make the callback available for garbage collection, and make it easier to debug memory issues\n\t\t// it does nothing if there is no timeout callback.\n\t\tclearTimeout(this.closeTimeout);\n\t\tvar duration = this.element.style.transition ? 1000 * parseFloat(window.getComputedStyle(this.element, null).transitionDuration) : 400;\n\t\tawait $.transition(this.element, {opacity: 0}, duration);\n\n\t\t$.remove(this.element);\n\t\tthis.closed.resolve(resolve);\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Permissions = $.Class({\n\tconstructor: function(o) {\n\t\tthis.triggers = [];\n\t\tthis.hooks = new $.Hooks();\n\n\t\t// If we don’t do this, there is no way to retrieve this from inside parentChanged\n\t\tthis.parentChanged = _.prototype.parentChanged.bind(this);\n\n\t\tthis.set(o);\n\t},\n\n\t// Set multiple permissions at once\n\tset: function(o) {\n\t\tfor (var action in o) {\n\t\t\tthis[action] = o[action];\n\t\t}\n\t},\n\n\t// Set a bunch of permissions to true. Chainable.\n\ton: function(actions) {\n\t\tMavo.toArray(actions).forEach(action => this[action] = true);\n\n\t\treturn this;\n\t},\n\n\t// Set a bunch of permissions to false. Chainable.\n\toff: function(actions) {\n\t\tactions = Array.isArray(actions)? actions : [actions];\n\n\t\tactions.forEach(action => this[action] = false);\n\n\t\treturn this;\n\t},\n\n\t// Fired once at least one of the actions passed can be performed\n\t// Kind of like a Promise that can be resolved multiple times.\n\tcan: function(actions, callback, cannot) {\n\t\tthis.observe(actions, true, callback);\n\n\t\tif (cannot) {\n\t\t\t// Fired once the action cannot be done anymore, even though it could be done before\n\t\t\tthis.cannot(actions, cannot);\n\t\t}\n\t},\n\n\t// Fired once NONE of the actions can be performed\n\tcannot: function(actions, callback) {\n\t\tthis.observe(actions, false, callback);\n\t},\n\n\t// Schedule a callback for when a set of permissions changes value\n\tobserve: function(actions, value, callback) {\n\t\tactions = Mavo.toArray(actions);\n\n\t\tif (this.is(actions, value)) {\n\t\t\t// Should be fired immediately\n\t\t\tcallback();\n\t\t}\n\n\t\t// For future transitions\n\t\tthis.triggers.push({ actions, value, callback, active: true });\n\t},\n\n\t// Compare a set of permissions with true or false\n\t// If comparing with true, we want at least one to be true, i.e. OR\n\t// If comparing with false, we want ALL to be false, i.e. NOR\n\tis: function(actions, able = true) {\n\t\tvar or = Mavo.toArray(actions).map(action => !!this[action])\n\t\t                .reduce((prev, current) => prev || current);\n\n\t\treturn able? or : !or;\n\t},\n\n\t// Monitor all changes\n\tonchange: function(callback) {\n\t\t// Future changes\n\t\tthis.hooks.add(\"change\", callback);\n\n\t\t// Fire for current values\n\t\t_.actions.forEach(action => {\n\t\t\tcallback.call(this, {action, value: this[action]});\n\t\t});\n\t},\n\n\tparentChanged: function(o = {}) {\n\t\tvar localValue = this[\"_\" + o.action];\n\n\t\tif (localValue !== undefined || o.from == o.value) {\n\t\t\t// We have a local value so we don’t care about parent changes OR nothing changed\n\t\t\treturn;\n\t\t}\n\n\t\tthis.fireTriggers(o.action);\n\n\t\tthis.hooks.run(\"change\", $.extend({context: this}, o));\n\t},\n\n\t// A single permission changed value\n\tchanged: function(action, value, from) {\n\t\tfrom = !!from;\n\t\tvalue = !!value;\n\n\t\tif (value == from) {\n\t\t\t// Nothing changed\n\t\t\treturn;\n\t\t}\n\n\t\t// $.live() calls the setter before the actual property is set so we\n\t\t// need to set it manually, otherwise it still has its previous value\n\t\tthis[\"_\" + action] = value;\n\n\t\tthis.fireTriggers(action);\n\n\t\tthis.hooks.run(\"change\", {action, value, from, context: this});\n\t},\n\n\tfireTriggers: function(action) {\n\t\tthis.triggers.forEach(trigger => {\n\t\t\tvar match = this.is(trigger.actions, trigger.value);\n\n\t\t\tif (trigger.active && trigger.actions.indexOf(action) > -1 && match) {\n\n\t\t\t\ttrigger.active = false;\n\t\t\t\ttrigger.callback();\n\t\t\t}\n\t\t\telse if (!match) {\n\t\t\t\t// This is so that triggers can only be executed in an actual transition\n\t\t\t\t// And that if there is a trigger for [a,b] it won't be executed twice\n\t\t\t\t// if a and b are set to true one after the other\n\t\t\t\ttrigger.active = true;\n\t\t\t}\n\t\t});\n\t},\n\n\tor: function(permissions) {\n\t\t_.actions.forEach(action => {\n\t\t\tthis[action] = this[action] || permissions[action];\n\t\t});\n\n\t\treturn this;\n\t},\n\n\tlive: {\n\t\tparent: function(parent) {\n\t\t\tvar oldParent = this._parent;\n\n\t\t\tif (oldParent == parent) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._parent = parent;\n\n\t\t\t// Remove previous trigger, if any\n\t\t\tif (oldParent) {\n\t\t\t\tMavo.delete(oldParent.hooks.change, this.parentChanged);\n\t\t\t}\n\n\t\t\t// What changes does this cause? Fire triggers for them\n\t\t\t_.actions.forEach(action => {\n\t\t\t\tthis.parentChanged({\n\t\t\t\t\taction,\n\t\t\t\t\tvalue: parent? parent[action] : undefined,\n\t\t\t\t\tfrom: oldParent? oldParent[action] : undefined\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif (parent) {\n\t\t\t\t// Add new trigger\n\t\t\t\tparent.onchange(this.parentChanged);\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\tactions: [],\n\n\t\t// Register a new permission type\n\t\tregister: function(action, setter) {\n\t\t\tif (Array.isArray(action)) {\n\t\t\t\taction.forEach(action => _.register(action, setter));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.live(_.prototype, action, {\n\t\t\t\tget: function() {\n\t\t\t\t\tvar ret = this[\"_\" + action];\n\n\t\t\t\t\tif (ret === undefined && this.parent) {\n\t\t\t\t\t\treturn this.parent[action];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn ret;\n\t\t\t\t},\n\t\t\t\tset: function(able, previous) {\n\t\t\t\t\tif (setter) {\n\t\t\t\t\t\tsetter.call(this, able, previous);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changed(action, able, previous);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t_.actions.push(action);\n\t\t}\n\t}\n});\n\n_.register([\"read\", \"save\"]);\n\n_.register(\"login\", function(can) {\n\tif (can && this.logout) {\n\t\tthis.logout = false;\n\t}\n});\n\n_.register(\"logout\", function(can) {\n\tif (can && this.login) {\n\t\tthis.login = false;\n\t}\n});\n\n_.register(\"edit\", function(can) {\n\tif (can) {\n\t\tthis.add = this.delete = true;\n\t}\n});\n\n_.register([\"add\", \"delete\"], function(can) {\n\tif (!can) {\n\t\tthis.edit = false;\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\n/**\n * Base class for all backends\n */\nvar _ = Mavo.Backend = $.Class({\n\tconstructor: function(url, o = {}) {\n\t\tthis.update(url, o);\n\n\t\t// Permissions of this particular backend.\n\t\tthis.permissions = new Mavo.Permissions();\n\t},\n\n\tupdate: function(url, o = {}) {\n\t\tthis.source = url;\n\n\t\t// Backends that are not URL-based should just ignore this\n\t\tthis.url = new URL(this.source, Mavo.base);\n\n\t\tthis.options = o;\n\t\tthis.mavo = o.mavo;\n\t\tthis.format = Mavo.Formats.create(o.format, this);\n\n\t\tif (this.constructor.key ?? o.key) {\n\t\t\tthis.key = o.key ?? this.constructor.key;\n\t\t}\n\t},\n\n\tasync get (url = new URL(this.url)) {\n\t\tif (url.protocol != \"data:\" && this.constructor.useCache !== false) {\n\t\t\turl.searchParams.set(\"timestamp\", Date.now()); // ensure fresh copy\n\t\t}\n\n\t\ttry {\n\t\t\tlet xhr = await $.fetch(url.href);\n\t\t\treturn xhr.responseText;\n\t\t}\n\t\tcatch (e) {\n\t\t\treturn null;\n\t\t}\n\t},\n\n\tasync load () {\n\t\tawait this.ready;\n\t\tlet response = await this.get();\n\n\t\tif (typeof response != \"string\") {\n\t\t\t// Backend did the parsing, we're done here\n\t\t\treturn response;\n\t\t}\n\n\t\tresponse = response.replace(/^\\ufeff/, \"\"); // Remove Unicode BOM\n\n\t\treturn this.format.parse(response);\n\t},\n\n\tasync store (data, {path, format = this.format} = {}) {\n\t\tawait this.ready;\n\n\t\tvar serialized = typeof data === \"string\"? data : await format.stringify(data);\n\t\tawait this.put(serialized, path);\n\n\t\treturn {data, serialized};\n\t},\n\n\t// To be be overriden by subclasses\n\tready: Promise.resolve(),\n\tlogin: () => Promise.resolve(),\n\tlogout: () => Promise.resolve(),\n\tput: () => Promise.reject(),\n\n\tisAuthenticated: function() {\n\t\treturn !!this.accessToken;\n\t},\n\n\t// Any extra params to be passed to the oAuth URL.\n\toAuthParams: () => \"\",\n\n\ttoString: function() {\n\t\treturn `${this.id} (${this.url})`;\n\t},\n\n\tequals: function(backend) {\n\t\treturn backend === this || (backend && this.id == backend.id && this.source == backend.source);\n\t},\n\n\t/**\n\t * Helper for making OAuth requests with JSON-based APIs.\n\t */\n\trequest: function(call, data, method = \"GET\", req = {}) {\n\t\treq = $.extend({}, req); // clone\n\t\treq.method = req.method || method;\n\t\treq.responseType = req.responseType || \"json\";\n\n\t\treq.headers = $.extend({\n\t\t\t\"Content-Type\": \"application/json; charset=utf-8\"\n\t\t}, req.headers || {});\n\n\t\tif (this.isAuthenticated()) {\n\t\t\treq.headers[\"Authorization\"] = req.headers[\"Authorization\"] || `Bearer ${this.accessToken}`;\n\t\t}\n\n\t\treq.data = data;\n\n\t\tcall = new URL(call, this.constructor.apiDomain);\n\n\t\t// Prevent getting a cached response. Cache-control is often not allowed via CORS\n\t\tif (req.method == \"GET\" && this.constructor.useCache !== false) {\n\t\t\tcall.searchParams.set(\"timestamp\", Date.now());\n\t\t}\n\n\t\tif ($.type(req.data) === \"object\") {\n\t\t\tif (req.method == \"GET\") {\n\t\t\t\tfor (let p in req.data) {\n\t\t\t\t\tlet action = req.data[p] === undefined? \"delete\" : \"set\";\n\t\t\t\t\tcall.searchParams[action](p, req.data[p]);\n\t\t\t\t}\n\n\t\t\t\tdelete req.data;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treq.data = JSON.stringify(req.data);\n\t\t\t}\n\t\t}\n\n\t\treturn $.fetch(call, req)\n\t\t\t.catch(err => {\n\t\t\t\tif (err?.xhr) {\n\t\t\t\t\treturn Promise.reject(err.xhr);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.mavo.error(\"Something went wrong while connecting to \" + this.id, err);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(xhr => req.method == \"HEAD\"? xhr : xhr.response);\n\t},\n\n\t/**\n\t * Helper method for authenticating in OAuth APIs\n\t */\n\toAuthenticate: function(passive) {\n\t\treturn this.ready.then(() => {\n\t\t\tif (this.isAuthenticated()) {\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tvar id = this.id.toLowerCase();\n\n\t\t\t\tif (passive) {\n\t\t\t\t\tthis.accessToken = localStorage[`mavo:${id}token`];\n\n\t\t\t\t\tif (this.accessToken) {\n\t\t\t\t\t\tresolve(this.accessToken);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Show window\n\t\t\t\t\tvar popup = {\n\t\t\t\t\t\twidth: Math.min(1000, innerWidth - 100),\n\t\t\t\t\t\theight: Math.min(800, innerHeight - 100)\n\t\t\t\t\t};\n\n\t\t\t\t\tpopup.top = (screen.height - popup.height)/2;\n\t\t\t\t\tpopup.left = (screen.width - popup.width)/2;\n\n\t\t\t\t\tvar state = {\n\t\t\t\t\t\turl: location.href,\n\t\t\t\t\t\tbackend: this.id\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.authPopup = open(`${this.constructor.oAuth}?client_id=${this.key}&state=${encodeURIComponent(JSON.stringify(state))}` + this.oAuthParams(),\n\t\t\t\t\t\t\"popup\", `width=${popup.width},height=${popup.height},left=${popup.left},top=${popup.top}`);\n\n\t\t\t\t\tif (!this.authPopup) {\n\t\t\t\t\t\tvar message = \"Login popup was blocked! Please check your popup blocker settings.\";\n\t\t\t\t\t\tthis.mavo.error(message);\n\t\t\t\t\t\treject(Error(message));\n\t\t\t\t\t}\n\n\t\t\t\t\taddEventListener(\"message\", evt => {\n\t\t\t\t\t\tif (evt.source === this.authPopup) {\n\t\t\t\t\t\t\tif (evt.data.backend == this.id) {\n\t\t\t\t\t\t\t\tthis.accessToken = localStorage[`mavo:${id}token`] = evt.data.token;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!this.accessToken) {\n\t\t\t\t\t\t\t\treject(Error(\"Authentication error\"));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve(this.accessToken);\n\n\t\t\t\t\t\t\t// Log in to other similar backends that are logged out\n\t\t\t\t\t\t\tfor (var appid in Mavo.all) {\n\t\t\t\t\t\t\t\tvar storage = Mavo.all[appid].primaryBackend;\n\n\t\t\t\t\t\t\t\tif (storage\n\t\t\t\t\t\t\t\t\t&& storage.id === this.id\n\t\t\t\t\t\t\t\t\t&& storage !== this\n\t\t\t\t\t\t\t\t\t&& !storage.isAuthenticated()) {\n\t\t\t\t\t\t\t\t\t\tstorage.login(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * oAuth logout helper\n\t */\n\toAuthLogout: function() {\n\t\tif (this.isAuthenticated()) {\n\t\t\tvar id = this.id.toLowerCase();\n\n\t\t\tlocalStorage.removeItem(`mavo:${id}token`);\n\t\t\tdelete this.accessToken;\n\n\t\t\tthis.permissions.off([\"edit\", \"add\", \"delete\", \"save\"]).on(\"login\");\n\n\t\t\t$.fire(this.mavo.element, \"mv-logout\", {backend: this});\n\t\t}\n\n\t\treturn Promise.resolve();\n\t},\n\n\tstatic: {\n\t\t// Return the appropriate backend(s) for this url\n\t\tcreate: function(url, o = {}, existing) {\n\t\t\tlet Backend;\n\n\t\t\tif (o.type) {\n\t\t\t\t// Using get() for case-insensitive property lookup\n\t\t\t\tBackend = Mavo.Functions.get(_, o.type);\n\t\t\t}\n\n\t\t\tif (url && !Backend) {\n\t\t\t\tBackend = _.types.find(Backend => Backend.test(url, o)) || _.Remote;\n\t\t\t}\n\n\t\t\t// Can we re-use the existing object perhaps?\n\t\t\tif (Backend && existing?.constructor === Backend && existing.constructor.prototype.hasOwnProperty(\"update\")) {\n\t\t\t\texisting.update(url, o);\n\t\t\t\treturn existing;\n\t\t\t}\n\n\t\t\treturn Backend? new Backend(url, o) : null;\n\t\t},\n\n\t\ttypes: [],\n\n\t\tregister: function(Class) {\n\t\t\t_[Class.prototype.id] = Class;\n\t\t\t_.types.push(Class);\n\t\t\treturn Class;\n\t\t}\n\t}\n});\n\n/**\n * Save in an HTML element\n */\n_.register($.Class({\n\tid: \"Element\",\n\textends: _,\n\tconstructor: function () {\n\t\tthis.permissions.on([\"read\", \"edit\", \"save\"]);\n\t},\n\n\tupdate: function(url, o) {\n\t\tthis.super.update.call(this, url, o);\n\n\t\tthis.element = $(this.source) || $.create(\"script\", {\n\t\t\ttype: \"application/json\",\n\t\t\tid: this.source.slice(1),\n\t\t\tinside: document.body\n\t\t});\n\t},\n\n\tget: function() {\n\t\treturn Promise.resolve(this.element.textContent);\n\t},\n\n\tput: function(serialized) {\n\t\treturn Promise.resolve(this.element.textContent = serialized);\n\t},\n\n\tstatic: {\n\t\ttest: url => url.indexOf(\"#\") === 0\n\t}\n}));\n\n// Load from a remote URL, no save\n_.register($.Class({\n\tid: \"Remote\",\n\textends: _,\n\tconstructor: function() {\n\t\tthis.permissions.on(\"read\");\n\t},\n\n\tstatic: {\n\t\ttest: url => false\n\t}\n}));\n\n// Save in localStorage\n_.register($.Class({\n\textends: _,\n\tid: \"Local\",\n\tconstructor: function() {\n\t\tthis.permissions.on([\"read\", \"edit\", \"save\"]);\n\t\tthis.key = this.mavo.id;\n\t},\n\n\tget: function() {\n\t\treturn Promise[this.key in localStorage? \"resolve\" : \"reject\"](localStorage[this.key]);\n\t},\n\n\tput: function(serialized) {\n\t\tif (!serialized) {\n\t\t\tdelete localStorage[this.key];\n\t\t}\n\t\telse {\n\t\t\tlocalStorage[this.key] = serialized;\n\t\t}\n\n\t\treturn Promise.resolve(serialized);\n\t},\n\n\tstatic: {\n\t\ttest: value => value == \"local\"\n\t}\n}));\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Formats = {};\n\nvar base = _.Base = $.Class({\n\tabstract: true,\n\tconstructor: function(backend) {\n\t\tthis.backend = backend;\n\t},\n\tproxy: {\n\t\t\"mavo\": \"backend\"\n\t},\n\n\t// So that child classes can only override the static methods if they don't\n\t// need access to any instance variables.\n\tparse: function(content) {\n\t\treturn this.constructor.parse(content, this);\n\t},\n\tstringify: function(data) {\n\t\treturn this.constructor.stringify(data, this);\n\t},\n\n\tstatic: {\n\t\tparse: serialized => Promise.resolve(serialized),\n\t\tstringify: data => Promise.resolve(data),\n\t\textensions: [],\n\t\tdependencies: [],\n\t\tready: function() {\n\t\t\treturn Promise.all(this.dependencies.map(d => $.include(d.test(), d.url)));\n\t\t}\n\t}\n});\n\nvar json = _.JSON = $.Class({\n\textends: _.Base,\n\tstatic: {\n\t\tparse: serialized => Promise.resolve(serialized? JSON.parse(serialized) : null),\n\t\tstringify: data => Promise.resolve(Mavo.toJSON(data)),\n\t\textensions: [\".json\", \".jsonld\"]\n\t}\n});\n\nvar text = _.Text = $.Class({\n\textends: _.Base,\n\tconstructor: function(backend) {\n\t\tthis.property = this.mavo.root.getNames(\"Primitive\")[0];\n\t},\n\n\tstatic: {\n\t\textensions: [\".txt\"],\n\t\tparse: (serialized, me) => Promise.resolve({[me? me.property : \"content\"]: serialized}),\n\t\tstringify: (data, me) => Promise.resolve(data[me? me.property : \"content\"])\n\t}\n});\n\nvar csv = _.CSV = $.Class({\n\textends: _.Base,\n\tconstructor: function(backend) {\n\t\tthis.property = this.mavo.root.getNames(\"Collection\")[0];\n\t\tthis.options = $.extend({}, _.CSV.defaultOptions);\n\t},\n\n\tstatic: {\n\t\textensions: [\".csv\", \".tsv\"],\n\t\tdefaultOptions: {\n\t\t\theader: true,\n\t\t\tdynamicTyping: true,\n\t\t\tskipEmptyLines: true\n\t\t},\n\t\tdependencies: [{\n\t\t\ttest: () => self.Papa,\n\t\t\turl: \"https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.4/papaparse.min.js\"\n\t\t}],\n\t\tready: base.ready,\n\t\tparse: async (serialized, me) => {\n\t\t\tawait csv.ready();\n\t\t\tvar data = Papa.parse(serialized, csv.defaultOptions);\n\t\t\tvar property = me? me.property : \"content\";\n\n\t\t\tif (me) {\n\t\t\t\t// Get delimiter & linebreak for serialization\n\t\t\t\tme.options.delimiter = data.meta.delimiter;\n\t\t\t\tme.options.linebreak = data.meta.linebreak;\n\t\t\t}\n\n\t\t\tif (data.meta.aborted) {\n\t\t\t\tthrow data.meta.errors.pop();\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t[property]: data.data\n\t\t\t};\n\t\t},\n\n\t\tstringify: async (data, me) => {\n\t\t\tawait csv.ready();\n\t\t\tvar property = me? me.property : \"content\";\n\t\t\tvar options = me? me.options : csv.defaultOptions;\n\t\t\treturn Papa.unparse(data[property], options);\n\t\t}\n\t}\n});\n\nObject.defineProperty(_, \"create\", {\n\tvalue: function(format, backend) {\n\t\tif (format && typeof format === \"object\") {\n\t\t\treturn format;\n\t\t}\n\n\t\tif (typeof format === \"string\") {\n\t\t\t// Search by id\n\t\t\tformat = format.toLowerCase();\n\n\t\t\tfor (var id in _) {\n\t\t\t\tvar Format = _[id];\n\n\t\t\t\tif (id.toLowerCase() == format) {\n\t\t\t\t\treturn new Format(backend);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!format) {\n\t\t\tvar url = backend.url? backend.url.pathname : backend.source;\n\t\t\tvar extension = url.match(/\\.\\w+$/)?.[0] ?? \".json\";\n\t\t\tvar Format = _.JSON;\n\n\t\t\tfor (var id in _) {\n\t\t\t\tif (_[id].extensions.indexOf(extension) > -1) {\n\t\t\t\t\t// Do not return match, as we may find another match later\n\t\t\t\t\t// and last match wins\n\t\t\t\t\tFormat = _[id];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn new Format(backend);\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Node = class Node {\n\tconstructor (element, mavo, options = {}) {\n\t\tif (!element || !mavo) {\n\t\t\tthrow new Error(\"Mavo.Node constructor requires an element argument and a mavo object\");\n\t\t}\n\n\t\tvar env = {context: this, options};\n\n\t\t// Set these first, for debug reasons\n\t\tthis.uid = _.all.push(this) - 1;\n\t\tthis.property = null;\n\t\tthis.element = element;\n\t\tthis.isHelperVariable = this.element.matches(\"meta\");\n\n\t\t$.extend(this, env.options);\n\n\t\t_.elements.set(element, [...(_.elements.get(this.element) || []), this]);\n\n\t\tthis.mavo = mavo;\n\t\tthis.group = this.parent = this.parentGroup = env.options.group;\n\n\t\tthis.template = env.options.template;\n\n\t\tthis.alias = this.element.getAttribute(\"mv-alias\");\n\n\t\tif (this.template) {\n\t\t\tthis.template.copies.push(this);\n\t\t}\n\t\telse {\n\t\t\t// First (or only) of its kind\n\t\t\tthis.copies = [];\n\t\t}\n\n\t\tif (!this.fromTemplate(\"property\", \"type\", \"storage\", \"path\")) {\n\t\t\tthis.property = _.getProperty(element);\n\t\t\tthis.type = Mavo.Group.normalize(element);\n\t\t\tthis.storage = this.element.getAttribute(\"mv-storage\");\n\t\t\tthis.path = this.getPath();\n\t\t}\n\n\t\tthis.modes = this.element.getAttribute(\"mv-mode\");\n\n\t\tMavo.hooks.run(\"node-init-start\", env);\n\n\t\tthis.mode = Mavo.getStyle(this.element, \"--mv-mode\") || \"read\";\n\n\t\tthis.collection = env.options.collection;\n\n\t\tif (this.collection) {\n\t\t\t// This is a collection item\n\t\t\tthis.group = this.parentGroup = this.collection.parentGroup;\n\t\t}\n\n\t\t// Must run before collections have a marker which messes up paths\n\t\tvar template = this.template;\n\n\t\tif (template?.expressions) {\n\t\t\t// We know which expressions we have, don't traverse again\n\t\t\tthis.expressions = template.expressions.map(et => new Mavo.DOMExpression({\n\t\t\t\ttemplate: et,\n\t\t\t\titem: this,\n\t\t\t\tmavo: this.mavo\n\t\t\t}));\n\t\t}\n\n\t\tif (this instanceof Mavo.Group || this.collection) {\n\t\t\t// Handle mv-value\n\t\t\t// TODO integrate with the code in Primitive that decides whether this is a computed property\n\t\t\tvar et = Mavo.DOMExpression.search(this.element).filter(et => et.originalAttribute == \"mv-value\")[0];\n\n\t\t\tif (et) {\n\t\t\t\tet.mavoNode = this;\n\t\t\t\tthis.expressionText = et;\n\t\t\t\tthis.storage = this.storage || \"none\";\n\t\t\t\tthis.modes = \"read\";\n\n\t\t\t\tif (this.collection) {\n\t\t\t\t\tthis.collection.expressions = [...(this.collection.expressions || []), et];\n\t\t\t\t\tet.mavoNode = this.collection;\n\t\t\t\t\tthis.collection.storage = this.collection.storage || \"none\";\n\t\t\t\t\tthis.collection.modes = \"read\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tMavo.hooks.run(\"node-init-end\", env);\n\t}\n\n\tget editing() {\n\t\treturn this.mode == \"edit\";\n\t}\n\n\tget isRoot() {\n\t\treturn !this.property;\n\t}\n\n\tget name() {\n\t\treturn Mavo.Functions.readable(this.property || this.type).toLowerCase();\n\t}\n\n\tget saved() {\n\t\treturn this.storage !== \"none\";\n\t}\n\n\tget properties() {\n\t\treturn Object.keys(this.liveData.data[Mavo.route]);\n\t}\n\n\t/**\n\t * Runs after the constructor is done (including the constructor of the inheriting class), synchronously\n\t */\n\tpostInit () {\n\t\tif (this.modes == \"edit\") {\n\t\t\tthis.edit();\n\t\t}\n\t}\n\n\tdestroy () {\n\t\tif (this.template) {\n\t\t\tMavo.delete(this.template.copies, this);\n\t\t}\n\n\t\tif (this.expressions) {\n\t\t\tthis.expressions.forEach(expression => expression.destroy());\n\t\t}\n\n\t\tif (this.itembar) {\n\t\t\tthis.itembar.destroy();\n\t\t}\n\n\t\tdelete _.all[this.uid];\n\n\t\tthis.propagate(\"destroy\");\n\t}\n\n\tgetLiveData () {\n\t\treturn this.liveData.proxy;\n\t}\n\n\tisDataNull (o = {}) {\n\t\tvar env = {\n\t\t\tcontext: this,\n\t\t\toptions: o,\n\t\t\tresult: !this.saved && !o.live\n\t\t};\n\n\t\tMavo.hooks.run(\"node-isdatanull\", env);\n\n\t\treturn env.result;\n\t}\n\n\t/**\n\t * Execute a callback on every node of the Mavo tree\n\t * If callback returns (strict) false, walk stops.\n\t * @param callback {Function}\n\t * @param path {Array} Initial path. Mostly used internally.\n\t * @param o {Object} Options:\n\t * \t\t\t- descentReturn {Boolean} If callback returns false, just don't descend\n\t * \t\t\t                Otherwise, if callback returns false, it stops.\n\t * @return false if was stopped via a false return value, true otherwise\n\t */\n\twalk (callback, path = [], o = {}) {\n\t\tvar walker = (obj, path) => {\n\t\t\tvar ret = callback(obj, path);\n\n\t\t\tif (ret !== false) {\n\t\t\t\tfor (let i in obj.children) {\n\t\t\t\t\tlet node = obj.children[i];\n\n\t\t\t\t\tif (node instanceof Mavo.Node) {\n\t\t\t\t\t\tvar ret = walker.call(node, node, [...path, i]);\n\n\t\t\t\t\t\tif (ret === false && !o.descentReturn) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn ret !== false;\n\t\t};\n\n\t\treturn walker(this, path);\n\t}\n\n\twalkUp (callback) {\n\t\tvar group = this;\n\n\t\twhile (group = group.parentGroup) {\n\t\t\tvar ret = callback(group);\n\n\t\t\tif (ret !== undefined) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\t}\n\n\tedit ({force} = {}) {\n\t\tthis.mode = \"edit\";\n\n\t\tif (!force && this.mode != \"edit\") {\n\t\t\treturn false;\n\t\t}\n\n\t\t$.fire(this.element, \"mv-edit\", {\n\t\t\tmavo: this.mavo,\n\t\t\tnode: this\n\t\t});\n\n\t\tMavo.hooks.run(\"node-edit-end\", this);\n\t}\n\n\tdone ({force} = {}) {\n\t\tthis.mode = Mavo.getStyle(this.element.parentNode, \"--mv-mode\") || \"read\";\n\n\t\tif (!force && this.mode != \"read\") {\n\t\t\treturn false;\n\t\t}\n\n\t\t$.unbind(this.element, \".mavo:edit\");\n\n\t\t$.fire(this.element, \"mv-done\", {\n\t\t\tmavo: this.mavo,\n\t\t\tnode: this\n\t\t});\n\n\t\tthis.propagate(\"done\");\n\n\t\tMavo.hooks.run(\"node-done-end\", this);\n\t}\n\n\tsave () {\n\t\tthis.unsavedChanges = false;\n\n\t\tthis.propagate(\"save\");\n\t}\n\n\tpropagate (callback) {\n\t\tfor (let i in this.children) {\n\t\t\tlet node = this.children[i];\n\n\t\t\tif (node instanceof Mavo.Node) {\n\t\t\t\tif (typeof callback === \"function\") {\n\t\t\t\t\tcallback.call(node, node);\n\t\t\t\t}\n\t\t\t\telse if (callback in node) {\n\t\t\t\t\tnode[callback]();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfromTemplate (...properties) {\n\t\tif (this.template) {\n\t\t\tproperties.forEach(property => this[property] = this.template[property]);\n\t\t}\n\n\t\treturn !!this.template;\n\t}\n\n\tasync render (data, o = {}) {\n\t\to.live = o.live || Mavo.in(Mavo.isProxy, data);\n\t\to.root = o.root || this;\n\n\t\t// Any promises pending to be rendered?\n\t\tdelete this.pending;\n\n\t\tif ($.type(data) === \"promise\") {\n\t\t\tlet pending = this.pending = data;\n\n\t\t\ttry {\n\t\t\t\tdata = await pending;\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tdata = e;\n\t\t\t}\n\n\t\t\tif (this.pending !== pending) {\n\t\t\t\t// Value has been superseded\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdelete this.pending;\n\t\t}\n\n\t\tif (o.live) {\n\t\t\t// Drop proxy\n\t\t\tdata = Mavo.clone(data);\n\t\t}\n\n\t\tthis.oldData = this.data;\n\t\tthis.data = data;\n\n\t\tif (!o.live) {\n\t\t\tdata = Mavo.subset(data, this.inPath);\n\t\t}\n\n\t\tvar env = {context: this, data, options: o};\n\n\t\tMavo.hooks.run(\"node-render-start\", env);\n\n\t\tif (!this.isHelperVariable) {\n\t\t\tif (!Array.isArray(this.children) && Array.isArray(env.data)) {\n\t\t\t\t// We are rendering an array on a singleton, what to do?\n\t\t\t\tif (this.isRoot) {\n\t\t\t\t\t// Get the name of the first property that is a collection without mv-value\n\t\t\t\t\t// OR if there is a collection with property=\"main\", prioritize that\n\t\t\t\t\tvar mainProperty = this.children.main instanceof Mavo.Collection? \"main\" : this.getNames((p, n) => {\n\t\t\t\t\t\treturn n instanceof Mavo.Collection && !n.expressions?.[0]?.isDynamicObject;\n\t\t\t\t\t})[0];\n\n\t\t\t\t\tif (mainProperty) {\n\t\t\t\t\t\tenv.data = {\n\t\t\t\t\t\t\t[mainProperty]: env.data\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!this.isRoot || !mainProperty) {\n\t\t\t\t\t// Otherwise, render first item\n\t\t\t\t\tthis.inPath.push(\"0\");\n\t\t\t\t\tenv.data = env.data[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.childrenNames?.length == 1 && this.childrenNames[0] === this.property\n\t\t\t         && env.data !== null && Mavo.isPlainObject(env.data)) {\n\t\t\t\t// {foo: {foo: 5}} should become {foo: 5}\n\t\t\t\tenv.data = env.data[this.property];\n\t\t\t}\n\t\t}\n\n\t\tif (this === o.root) {\n\t\t\tthis.expressionsEnabled = false;\n\t\t}\n\n\t\tvar editing = this.editing;\n\n\t\tif (editing) {\n\t\t\tthis.done();\n\t\t}\n\n\t\tvar changed = this.dataRender(env.data, o);\n\n\t\tif (editing) {\n\t\t\tthis.edit();\n\t\t}\n\n\t\tif (this === o.root) {\n\t\t\tthis.save();\n\n\t\t\tthis.expressionsEnabled = true;\n\n\t\t\tif (changed) {\n\t\t\t\trequestAnimationFrame(() => this.mavo.expressions.update(this));\n\t\t\t}\n\t\t}\n\n\t\tMavo.hooks.run(\"node-render-end\", env);\n\n\t\treturn changed;\n\t}\n\n\tdataChanged (action, o = {}) {\n\t\tvar change = $.extend({\n\t\t\taction,\n\t\t\tproperty: this.property,\n\t\t\tmavo: this.mavo,\n\t\t\tnode: this\n\t\t}, o);\n\n\t\t$.fire(o.element || this.element, \"mv-change\", change);\n\t\tthis.mavo.changed(change);\n\t}\n\n\ttoString () {\n\t\treturn `#${this.uid}: ${this.constructor.name} (${this.property})`;\n\t}\n\n\tgetClosestCollection () {\n\t\tvar closestItem = this.closestItem;\n\n\t\treturn closestItem? closestItem.collection : null;\n\t}\n\n\tgetClosestItem () {\n\t\tif (Array.isArray(this.collection?.children)) {\n\t\t\treturn this;\n\t\t}\n\n\t\treturn this.parentGroup?.closestItem || null;\n\t}\n\n\tgetPath () {\n\t\tvar path = this.parent?.path || [];\n\t\treturn this.property? [...path, this.property] : path;\n\t}\n\n\tpathFrom (node) {\n\t\tvar path = this.path;\n\t\tvar nodePath = node.path;\n\n\t\tfor (var i = 0; i<path.length && nodePath[i] == path[i]; i++) {}\n\n\t\treturn path.slice(i);\n\t}\n\n\tgetDescendant (path) {\n\t\treturn path.reduce((acc, cur) => acc.children[cur], this);\n\t}\n\n\t/**\n\t * Get same node in other item in same collection\n\t * E.g. for same node in the next item, use an offset of -1\n\t */\n\tgetCousin (offset, o = {}) {\n\t\tif (!this.closestCollection) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar collection = this.closestCollection;\n\t\tvar distance = Math.abs(offset);\n\t\tvar direction =  offset < 0? -1 : 1;\n\n\t\tif (collection.length < distance + 1) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar index = this.closestItem.index + offset;\n\n\t\tif (o.wrap) {\n\t\t\tindex = Mavo.wrap(index, collection.length);\n\t\t}\n\n\t\tfor (var i = 0; i<collection.length; i++) {\n\t\t\tvar ind = index + i * direction;\n\n\t\t\tif (o.wrap) {\n\t\t\t\tind = Mavo.wrap(ind, collection.length);\n\t\t\t}\n\n\t\t\tvar item = collection.children[ind];\n\n\t\t\tif (item) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!item || item == this.closestItem) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.collection) {\n\t\t\treturn item;\n\t\t}\n\n\t\tvar relativePath = this.pathFrom(this.closestItem);\n\t\treturn item.getDescendant(relativePath);\n\t}\n\n\tcontains (node) {\n\t\tdo {\n\t\t\tif (node === this) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tnode = node.parent;\n\t\t}\n\t\twhile (node);\n\n\t\treturn false;\n\t}\n\n\t// Evaluate expression on the fly with this node as context\n\teval(expr, o) {\n\t\treturn new Mavo.Expression(expr).eval(this.getLiveData(), o);\n\t}\n\n\tstatic create (element, mavo, o = {}) {\n\t\tif (Mavo.is(\"multiple\", element) && !o.collection) {\n\t\t\treturn new Mavo.Collection(element, mavo, o);\n\t\t}\n\n\t\treturn new Mavo[Mavo.is(\"group\", element)? \"Group\" : \"Primitive\"](element, mavo, o);\n\t}\n\n\t/**\n\t * Get & normalize property name, if exists\n\t */\n\tstatic getProperty (element) {\n\t\tvar property = element.getAttribute(\"property\") || element.getAttribute(\"itemprop\");\n\n\t\tif (!property) {\n\t\t\tvar multiple = element.getAttribute(\"mv-multiple\");\n\n\t\t\tif (element.hasAttribute(\"property\")) { // property used without a value\n\t\t\t\tproperty = multiple || element.name || element.id || element.classList[0];\n\n\t\t\t\tif (!property) {\n\t\t\t\t\tproperty = _.generatePropertyName(multiple === null? \"prop\" : \"collection\", element);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (property) {\n\t\t\telement.setAttribute(\"property\", property);\n\t\t}\n\n\t\treturn property;\n\t}\n\n\tstatic generatePropertyName(prefix, element = document.documentElement) {\n\t\tvar root = element.closest(Mavo.selectors.init);\n\n\t\tfor (var i=\"\"; i<10000; i++) { // 1000 is just a failsafe\n\t\t\tvar name = prefix + i;\n\n\t\t\tif (!$(Mavo.selectors.specificProperty(name), root)) {\n\t\t\t\treturn name;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic get (element, prioritizePrimitive) {\n\t\tvar nodes = (_.elements.get(element) || []).filter(node => !(Array.isArray(node.children)));\n\n\t\tif (nodes.length < 2 || !prioritizePrimitive) {\n\t\t\treturn nodes[0];\n\t\t}\n\n\t\tif (nodes[0] instanceof Mavo.Group) {\n\t\t\treturn nodes[1];\n\t\t}\n\t}\n\n\tstatic getClosest (element, prioritizePrimitive) {\n\t\tvar node;\n\n\t\tdo {\n\t\t\tnode = _.get(element, prioritizePrimitive);\n\t\t} while (!node && (element = element.parentNode));\n\n\t\treturn node;\n\t}\n\n\tstatic getClosestItem (element) {\n\t\tvar item = _.getClosest(element);\n\n\t\tif (item instanceof Mavo.Primitive && !item.collection) {\n\t\t\treturn item.parent;\n\t\t}\n\n\t\treturn item;\n\t}\n\n\t/**\n\t * Get all properties that are inside an element but not nested into other properties\n\t */\n\tstatic children (element) {\n\t\tvar ret = Mavo.Node.get(element);\n\n\t\tif (ret) {\n\t\t\t// element is a Mavo node\n\t\t\treturn [ret];\n\t\t}\n\n\t\tret = $$(Mavo.selectors.property, element)\n\t\t\t.map(e => Mavo.Node.get(e))\n\t\t\t.filter(e => !element.contains(e.parentGroup.element)) // drop nested properties\n\t\t\t.map(e => e.collection || e);\n\n\t\treturn Mavo.Functions.unique(ret);\n\t}\n};\n\n$.Class(_, {\n\ttoJSON: Mavo.prototype.toJSON,\n\n\tlazy: {\n\t\tclosestCollection: function() {\n\t\t\treturn this.getClosestCollection();\n\t\t},\n\n\t\tclosestItem: function() {\n\t\t\treturn this.getClosestItem();\n\t\t},\n\n\t\t// Are we only rendering and editing a subset of the data?\n\t\tinPath: function() {\n\t\t\tvar attribute = this instanceof Mavo.Collection? \"mv-multiple-path\" : \"mv-path\";\n\n\t\t\treturn (this.element.getAttribute(attribute) || \"\").split(\"/\").filter(p => p.length);\n\t\t}\n\t},\n\n\tlive: {\n\t\tstore: function(value) {\n\t\t\t$.toggleAttribute(this.element, \"mv-storage\", value);\n\t\t},\n\n\t\tunsavedChanges: function(value) {\n\t\t\tif (value && (!this.saved || !this.editing)) {\n\t\t\t\tvalue = false;\n\t\t\t}\n\n\t\t\tif (!Array.isArray(this.children)) {\n\t\t\t\tthis.element.classList.toggle(\"mv-unsaved-changes\", value);\n\t\t\t}\n\n\t\t\treturn value;\n\t\t},\n\n\t\tmode: function (value) {\n\t\t\tif (this._mode != value) {\n\t\t\t\t// Is it allowed?\n\t\t\t\tif (this.modes && value != this.modes) {\n\t\t\t\t\tvalue = this.modes;\n\t\t\t\t}\n\n\t\t\t\t// If we don't do this, setting the attribute below will\n\t\t\t\t// result in infinite recursion\n\t\t\t\tthis._mode = value;\n\n\t\t\t\tif (!Array.isArray(this.children) && [null, \"\", \"read\", \"edit\"].indexOf(this.element.getAttribute(\"mv-mode\")) > -1) {\n\t\t\t\t\t// If attribute is not one of the recognized values, leave it alone\n\t\t\t\t\tvar set = this.modes || value == \"edit\";\n\t\t\t\t\tlet matches = Mavo.observers.pause({attribute: \"mv-mode\"});\n\t\t\t\t\t$.toggleAttribute(this.element, \"mv-mode\", value, set);\n\t\t\t\t\tMavo.observers.resume(matches);\n\t\t\t\t}\n\n\t\t\t\treturn value;\n\t\t\t}\n\t\t},\n\n\t\tmodes: function(value) {\n\t\t\tif (value && value != \"read\" && value != \"edit\") {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tthis._modes = value;\n\n\t\t\tif (value && this.mode != value) {\n\t\t\t\tthis.mode = value;\n\t\t\t}\n\t\t},\n\n\t\tcollection: function(value) {\n\t\t\t// These only change when collection changes\n\t\t\tthis.parent = value || this.parentGroup;\n\t\t},\n\n\t\tindex: function(value) {\n\t\t\tif (this._index !== value) {\n\t\t\t\tthis._index = value;\n\t\t\t\tthis.liveData.updateKey();\n\t\t\t}\n\t\t},\n\n\t\texpressionsEnabled: {\n\t\t\tget: function() {\n\t\t\t\tif (this._expressionsEnabled === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn this.parent? this.parent.expressionsEnabled : true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\tall: [],\n\t\telements: new WeakMap()\n\t}\n});\n\nMavo.observe({attribute: \"mv-storage\"}, function({node}) {\n\t// Handle dynamic mv-storage on Mavo nodes (Fix for #576)\n\tif (node) {\n\t\tnode.storage = node.element.getAttribute(\"mv-storage\");\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Group = class Group extends Mavo.Node {\n\tconstructor (element, mavo, o) {\n\t\tsuper(element, mavo, o);\n\n\t\tthis.children = {};\n\n\t\tthis.group = this;\n\n\t\tMavo.hooks.run(\"group-init-start\", this);\n\n\t\t// Should this element also create a primitive?\n\t\tif (Mavo.Primitive.getValueAttribute(this.element)) {\n\t\t\tthis.children[this.property] = new Mavo.Primitive(this.element, this.mavo, {group: this});\n\t\t}\n\n\t\t// Create Mavo objects for all properties in this group (primitives or groups),\n\t\t// but not properties in descendant groups (they will be handled by their group)\n\t\tvar properties = $$(Mavo.selectors.property + \", \" + Mavo.selectors.multiple, this.element).filter(element => {\n\t\t\treturn this.element === (element.parentNode.closest(Mavo.selectors.childGroup) || this.mavo.element);\n\t\t});\n\n\t\t// Figure out which properties are mv-multiple\n\t\tvar collections = {};\n\t\tproperties.forEach(element => {\n\t\t\tvar property = Mavo.Node.getProperty(element);\n\n\t\t\tif (collections[property] !== \"multiple\") {\n\t\t\t\tcollections[property] = Mavo.is(\"multiple\", element)? \"multiple\" : (collections[property] || 0) + 1;\n\t\t\t}\n\t\t});\n\n\t\t// Now create the node objects\n\t\tproperties.forEach((element, i) => {\n\t\t\tvar property = Mavo.Node.getProperty(element);\n\t\t\tvar template = this.template? this.template.children[property] : null;\n\t\t\tvar options = {template, group: this};\n\t\t\tvar isCollection = collections[property];\n\n\t\t\tif (isCollection === \"multiple\") {\n\t\t\t\tvar existing = this.children[property];\n\n\t\t\t\tif (existing instanceof Mavo.Collection) {\n\t\t\t\t\texisting.add(element);\n\t\t\t\t}\n\t\t\t\telse if (Mavo.is(\"multiple\", element)) {\n\t\t\t\t\t// We must create the collection with the element that actually has mv-multiple\n\t\t\t\t\t// otherwise the template will be all wrong\n\t\t\t\t\tthis.children[property] = new Mavo.Collection(element, this.mavo, options);\n\t\t\t\t\t(existing || []).forEach((e, i) => this.children[property].add(e, i));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.children[property] = [...(existing || []), element];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (isCollection > 1) {\n\t\t\t\tif (!this.children[property]) {\n\t\t\t\t\tthis.children[property] = new Mavo.ImplicitCollection(element, this.mavo, options);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.children[property].add(element);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Normal case\n\t\t\t\tthis.children[property] = Mavo.Node.create(element, this.mavo, options);\n\t\t\t}\n\t\t});\n\n\t\tthis.childrenNames = Object.keys(this.children);\n\n\t\tthis.vocab = Mavo.getClosestAttribute(this.element, \"vocab\");\n\n\t\tthis.postInit();\n\n\t\tMavo.hooks.run(\"group-init-end\", this);\n\t}\n\n\tget isRoot() {\n\t\treturn !this.property;\n\t}\n\n\tgetNames (type = \"Node\") {\n\t\tvar filter = typeof type === \"function\"? type : (p, n) => n instanceof Mavo[type];\n\t\treturn Object.keys(this.children).filter(p => filter(p, this.children[p]));\n\t}\n\n\tgetData (o = {}) {\n\t\tvar env = {\n\t\t\tcontext: this,\n\t\t\toptions: o\n\t\t};\n\n\t\tif (this.isDataNull(o)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tenv.data = Mavo.shallowClone(Mavo.subset(this.data, this.inPath)) || {};\n\n\t\tfor (var property in this.children) {\n\t\t\tvar obj = this.children[property];\n\n\t\t\tif (obj.saved) {\n\t\t\t\tvar data = obj.getData(env.options);\n\t\t\t}\n\n\t\t\tif (obj.saved && Mavo.value(data) !== null) {\n\t\t\t\tenv.data[obj.property] = data;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdelete env.data[obj.property];\n\t\t\t}\n\t\t}\n\n\t\tif (!this.childrenNames.length && !this.isRoot && !this.collection) {\n\t\t\t// Avoid {} in the data\n\t\t\tenv.data = null;\n\t\t}\n\t\telse if (this.childrenNames.length === 1 && this.property in this.children) {\n\t\t\tenv.data = env.data[this.property];\n\t\t}\n\t\telse if (env.data && typeof env.data === \"object\") {\n\t\t\t// Add JSON-LD stuff\n\t\t\tif (this.type && this.type != _.DEFAULT_TYPE) {\n\t\t\t\tenv.data[\"@type\"] = this.type;\n\t\t\t}\n\n\t\t\tif (this.vocab) {\n\t\t\t\tenv.data[\"@context\"] = this.vocab;\n\t\t\t}\n\t\t}\n\n\t\t// If storing, use the rendered data too\n\t\tenv.data = Mavo.subset(this.data, this.inPath, env.data);\n\n\t\tMavo.hooks.run(\"node-getdata-end\", env);\n\n\t\treturn env.data;\n\t}\n\n\tedit (o = {}) {\n\t\tif (super.edit() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn Promise.all(Object.keys(this.children).map(prop => this.children[prop].edit(o)));\n\t}\n\n\tdataRender (data, o = {}) {\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet changed = false;\n\n\t\t// What if data is not an object?\n\t\tlet noWriteableProperty;\n\t\tlet wasPrimitive;\n\n\t\tif (typeof data !== \"object\") {\n\t\t\twasPrimitive = true;\n\t\t\tlet property = this.property;\n\n\t\t\t// Data is a primitive, render it on this.property or failing that, any writable property\n\t\t\tif (!(this.property in this.children)) {\n\t\t\t\tlet type = $.type(data);\n\t\t\t\tlet score = prop => (this.children[prop] instanceof Mavo.Primitive) + (this.children[prop].datatype == type);\n\n\t\t\t\tproperty = Object.keys(this.children)\n\t\t\t\t\t.filter(p => !this.children[p].expressionText)\n\t\t\t\t\t.sort((prop1, prop2) => score(prop1) - score(prop2))\n\t\t\t\t\t.reverse()[0];\n\t\t\t}\n\n\t\t\tif (!property) {\n\t\t\t\t// No appropriate property found, use this.property\n\t\t\t\tproperty = this.property;\n\t\t\t\tnoWriteableProperty = true;\n\t\t\t}\n\n\t\t\tdata = {[property]: data};\n\n\t\t\tthis.data = Mavo.subset(this.data, this.inPath, data);\n\t\t}\n\n\t\tlet copy; // to handle renaming\n\n\t\tthis.propagate(obj => {\n\t\t\tlet propertyData = data[obj.property];\n\n\t\t\t// find first alias with data, load that data, and set to be copied\n\t\t\tif (obj.alias) {\n\t\t\t\tlet aliasesArr = obj.alias.split(\" \");\n\n\t\t\t\tfor (let i = 0; i < aliasesArr.length; i++) {\n\t\t\t\t\tlet currentAlias = aliasesArr[i];\n\n\t\t\t\t\tif (data[currentAlias] !== undefined) {\n\t\t\t\t\t\tobj.currentAlias = currentAlias;\n\t\t\t\t\t\tcopy = copy || $.extend({}, data);\n\t\t\t\t\t\tpropertyData = data[obj.currentAlias];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tchanged = obj.render(propertyData, o) || changed;\n\t\t});\n\n\t\t// Rename properties. This needs to be done separately to handle swapping.\n\t\tif (copy) {\n\t\t\tthis.propagate(obj => {\n\t\t\t\tif (obj.currentAlias) {\n\t\t\t\t\tdata[obj.property] = copy[obj.currentAlias];\n\n\t\t\t\t\tif (!(obj.currentAlias in this.children)) {\n\t\t\t\t\t\tdelete data[obj.currentAlias];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!wasPrimitive || noWriteableProperty) {\n\t\t\t// Fire mv-change events for properties not in the template,\n\t\t\t// since nothing else will and they can still be referenced in expressions\n\t\t\tlet oldData = Mavo.subset(this.oldData, this.inPath);\n\n\t\t\tfor (let property in data) {\n\t\t\t\tif (!(property in this.children)) {\n\t\t\t\t\tlet value = data[property];\n\t\t\t\t\tchanged = changed || data[property] !== this.liveData.data[property];\n\n\t\t\t\t\tthis.liveData.set(property, value);\n\n\t\t\t\t\tif (typeof value != \"object\" && (!oldData || oldData[property] != value)) {\n\t\t\t\t\t\t// Property actually changed. Why != \"object\" though?\n\t\t\t\t\t\tthis.dataChanged(\"propertychange\", {property});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tstatic normalize (element) {\n\t\t// Get & normalize typeof name, if exists\n\t\tif (Mavo.is(\"group\", element)) {\n\t\t\tvar type = Mavo.getAttribute(element, \"typeof\", \"mv-group\") || _.DEFAULT_TYPE;\n\n\t\t\telement.setAttribute(\"typeof\", type);\n\n\t\t\treturn type;\n\t\t}\n\n\t\treturn null;\n\t}\n};\n\n$.Class(_, {\n\tlazy: {\n\t\tliveData: function() {\n\t\t\treturn new Mavo.Data(this, {});\n\t\t}\n\t},\n\n\tstatic: {\n\t\tall: new WeakMap(),\n\n\t\tDEFAULT_TYPE: \"Item\"\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(async function($, $$) {\n\nvar _ = Mavo.Primitive = class Primitive extends Mavo.Node {\n\tconstructor(element, mavo, o) {\n\t\tsuper(element, mavo, o);\n\n\t\tthis.liveData = new Mavo.Data(this);\n\n\t\tif (!this.fromTemplate(\"config\", \"attribute\", \"templateValue\", \"originalEditor\")) {\n\t\t\tthis.config = _.getConfig(element);\n\n\t\t\t// Which attribute holds the data, if any?\n\t\t\t// \"null\" or null for none (i.e. data is in content).\n\t\t\tthis.attribute = this.config.attribute;\n\n\t\t\t// HTML attribute names are case insensitive (Fix for #515)\n\t\t\tif (this.attribute && !document.xmlVersion) {\n\t\t\t\tthis.attribute = this.attribute.toLowerCase();\n\t\t\t}\n\t\t}\n\n\t\tthis.datatype = this.config.datatype;\n\n\t\tif (\"modes\" in this.config) {\n\t\t\t// If modes are related to element type, this overrides everything\n\t\t\t// because it means the other mode makes no sense for that element\n\t\t\tthis.modes = this.config.modes;\n\t\t\tthis.element.setAttribute(\"mv-mode\", this.config.modes);\n\t\t}\n\n\t\tMavo.hooks.run(\"primitive-init-start\", this);\n\n\t\t// Link primitive with its expressionText object\n\t\t// We need to do this before any editing UI is generated\n\t\tthis.expressionText = this.expressionText || Mavo.DOMExpression.search(this.element, this.attribute);\n\n\t\tif (this.expressionText && !this.expressionText.mavoNode) {\n\t\t\t// Computed property\n\t\t\tthis.expressionText.primitive = this;\n\t\t\tthis.storage = this.storage || \"none\";\n\t\t\tthis.modes = \"read\";\n\t\t\tthis.element.setAttribute(\"aria-live\", \"polite\");\n\t\t}\n\n\t\t/**\n\t\t * Set up input widget\n\t\t */\n\n\t\tif (this.config.init) {\n\t\t\tthis.config.init.call(this, this.element);\n\t\t}\n\n\t\tif (this.config.initOnce && !this.config.initOnce.called) {\n\t\t\tthis.config.initOnce.call(this, this.element);\n\t\t\tthis.config.initOnce.called = true;\n\t\t}\n\n\t\tif (this.config.changeEvents) {\n\t\t\t$.bind(this.element, this.config.changeEvents, evt => {\n\t\t\t\tif (evt.target === this.element) {\n\t\t\t\t\tthis.value = this.getValue();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.expressionText) {\n\t\t\tthis.setValue(this.expressionText.value, {silent: true});\n\t\t}\n\t\telse {\n\t\t\tif (this.element.hasAttribute(\"aria-label\")) {\n\t\t\t\t// Custom label\n\t\t\t\tthis.label = this.element.getAttribute(\"aria-label\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.label = Mavo.Functions.readable(this.property);\n\t\t\t\tthis.pauseObserver();\n\t\t\t\tthis.element.setAttribute(\"aria-label\", this.label);\n\t\t\t\tthis.resumeObserver();\n\t\t\t}\n\n\t\t\t// Linked widgets\n\t\t\tif (this.element.hasAttribute(\"mv-editor\")) {\n\t\t\t\tthis.originalEditorUpdated();\n\n\t\t\t\tlet editorValue = this.editorValue;\n\n\t\t\t\tif (!this.datatype && (typeof editorValue == \"number\" || typeof editorValue == \"boolean\")) {\n\t\t\t\t\tthis.datatype = typeof editorValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.templateValue = this.getValue();\n\n\t\t\tthis._default = this.element.getAttribute(\"mv-default\");\n\n\t\t\tif (this.default === null) { // no mv-default\n\t\t\t\tthis._default = this.modes? this.templateValue : this.editorValue;\n\t\t\t\tthis.defaultSource = this.modes? \"template\" : \"editor\";\n\t\t\t}\n\t\t\telse if (this.default === \"\") { // mv-default exists, no value, default is template value\n\t\t\t\tthis._default = this.templateValue;\n\t\t\t\tthis.defaultSource = \"template\";\n\t\t\t}\n\t\t\telse { // mv-default with value\n\t\t\t\tthis.defaultExpression = Mavo.DOMExpression.search(this.element, \"mv-default\");\n\n\t\t\t\tif (this.defaultExpression) {\n\t\t\t\t\t// To preserve type, e.g. booleans should stay booleans, not become strings\n\t\t\t\t\tthis.defaultExpression.output = value => this.default = value;\n\t\t\t\t}\n\n\t\t\t\tthis.defaultSource = \"attribute\";\n\t\t\t}\n\n\t\t\tvar keepTemplateValue = !this.template // not in a collection or first item\n\t\t\t                        || this.template.templateValue != this.templateValue // or different template value than first item\n\t\t\t\t\t\t\t\t\t|| this.modes == \"edit\"; // or is always edited\n\n\t\t\tif (this.default === undefined && keepTemplateValue) {\n\t\t\t\tthis.initialValue = this.templateValue;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.initialValue = this.default;\n\t\t\t}\n\n\t\t\tif (this.initialValue === undefined) {\n\t\t\t\tthis.initialValue = this.emptyValue;\n\t\t\t}\n\n\t\t\tthis.setValue(this.initialValue, {silent: true});\n\t\t}\n\n\t\tthis.postInit();\n\n\t\tMavo.hooks.run(\"primitive-init-end\", this);\n\t}\n\n\tget editorValue() {\n\t\tlet editor = this.editor || this.originalEditor;\n\n\t\tif (editor) {\n\t\t\tif (editor.matches(Mavo.selectors.formControl)) {\n\t\t\t\treturn _.getValue(editor, {datatype: this.datatype});\n\t\t\t}\n\n\t\t\t// if we're here, this.editor is an entire HTML structure\n\t\t\tlet output = $(Mavo.selectors.output + \", \" + Mavo.selectors.formControl, editor);\n\n\t\t\tif (output) {\n\t\t\t\treturn _.getValue(output);\n\t\t\t}\n\t\t}\n\t}\n\n\tset editorValue(value) {\n\t\tif (this.config.setEditorValue && this.datatype !== \"boolean\") {\n\t\t\treturn this.config.setEditorValue.call(this, value);\n\t\t}\n\n\t\tif (this.editor) {\n\t\t\tif (this.editor.matches(Mavo.selectors.formControl)) {\n\t\t\t\tif (this.editor.matches(\"select\")) {\n\t\t\t\t\tlet text = [...this.editor.options].find(o => o.value == value)?.textContent;\n\n\t\t\t\t\t// We have a local editor, do we need to add/remove temp options?\n\t\t\t\t\tif (text === undefined) {\n\t\t\t\t\t\t// Option not found in the select menu, add a temp option\n\t\t\t\t\t\t$.create(\"option\", {\n\t\t\t\t\t\t\tclassName: \"mv-volatile\",\n\t\t\t\t\t\t\ttextContent: value,\n\t\t\t\t\t\t\tinside: this.editor,\n\t\t\t\t\t\t\tselected: true,\n\t\t\t\t\t\t\tdisabled: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t_.setValue(this.editor, value, {config: this.editorDefaults});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// if we're here, this.editor is an entire HTML structure\n\t\t\t\tvar output = $(Mavo.selectors.output + \", \" + Mavo.selectors.formControl, this.editor);\n\n\t\t\t\tif (output) {\n\t\t\t\t\t_.setValue(output, value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy () {\n\t\tsuper.destroy();\n\t\tthis.originalEditorObserver?.destroy();\n\t}\n\n\tisDataNull(o) {\n\t\treturn super.isDataNull(o) || this._value === null || this._value === undefined;\n\t}\n\n\tgetData (o = {}) {\n\t\tvar env = {\n\t\t\tcontext: this,\n\t\t\toptions: o\n\t\t};\n\n\t\tif (this.isDataNull(o)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tenv.data = this.value;\n\n\t\tif (env.data === \"\" && (!this.templateValue || this.initialValue !== this.templateValue)) {\n\t\t\tenv.data = null;\n\t\t}\n\n\t\tif (this.inPath.length) {\n\t\t\tenv.data = Mavo.subset(this.data, this.inPath, env.data);\n\t\t}\n\n\t\tMavo.hooks.run(\"node-getdata-end\", env);\n\n\t\treturn env.data;\n\t}\n\n\t// Why this complexity? Because it needs to be a stack, so that\n\t// pause, pause, resume doesn't actually resume, you need to resume as many\n\t// times as you paused, so that nested function calls work as expected.\n\tget pausedObserver () {\n\t\treturn this.observerPauses?.length > 0;\n\t}\n\n\tpauseObserver () {\n\t\tMavo.observers.flush();\n\t\tthis.observerPauses = this.observerPauses || [];\n\t\tthis.observerPauses.push(1);\n\t}\n\n\tresumeObserver () {\n\t\tMavo.observers.flush();\n\t\tthis.observerPauses?.pop?.();\n\t}\n\n\tsave() {\n\t\tthis.savedValue = this.value;\n\t\tthis.unsavedChanges = false;\n\t}\n\n\t// Called only the first time this primitive is edited\n\tinitEdit () {\n\t\tif (!this.editor && this.originalEditor) {\n\t\t\tthis.editor = this.originalEditor.cloneNode(true);\n\t\t}\n\n\t\tthis.editorUpdated();\n\n\t\tthis.initEdit = null;\n\t}\n\n\tgenerateDefaultEditor() {\n\t\t// No editor provided, generate default for element type\n\t\t// Find default editor for datatype\n\t\tlet editor = this.config.editor;\n\n\t\tif (!editor || this.datatype == \"boolean\") {\n\t\t\teditor = Mavo.Elements.defaultConfig[this.datatype || \"string\"].editor;\n\t\t}\n\n\t\tthis.editor = $.create($.type(editor) === \"function\"? editor.call(this) : editor);\n\t\tthis.editorValue = this.value;\n\t}\n\n\tupdateEditType() {\n\t\tlet ret = this.element.getAttribute(\"mv-edit-type\")?.trim() ?? \"auto\";\n\n\t\tif (ret === \"auto\") {\n\t\t\t// attribute may be \"auto\", in which case we want to get in here\n\t\t\tret = this.config.editType ?? \"auto\";\n\t\t}\n\n\t\tif (ret === \"auto\") {\n\t\t\tret = this.attribute? \"popup\" : \"inline\";\n\t\t}\n\n\t\treturn this.editType = ret;\n\t}\n\n\teditorUpdated () {\n\t\tif (!this.editor) {\n\t\t\tthis.generateDefaultEditor();\n\t\t}\n\n\t\t$.bind(this.editor, {\n\t\t\t\"input change\": evt => {\n\t\t\t\tthis.value = this.editorValue;\n\t\t\t},\n\t\t\t\"mv-change\": evt => {\n\t\t\t\tif (evt.property === \"output\") {\n\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\t$.fire(this.editor, \"input\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tlet multiline = this.editor.matches(\"textarea\");\n\n\t\tif (!multiline) {\n\t\t\tthis.editor.addEventListener(\"focus\", evt => {\n\t\t\t\tthis.editor.select?.();\n\t\t\t});\n\t\t}\n\n\t\tif (\"placeholder\" in this.editor && !this.editor.placeholder) {\n\t\t\tthis.editor.placeholder = `(${this.label})`;\n\t\t}\n\n\t\t// Copy any mv-editor-* attributes from the element to the editor\n\t\tfor (let name of Mavo.getAttributes(this.element, /^mv-editor-/)) {\n\t\t\tlet value = this.element.getAttribute(name);\n\t\t\tname = name.replace(/^mv-editor-/, \"\");\n\t\t\tthis.editor.setAttribute(name, value);\n\t\t}\n\t}\n\n\toriginalEditorUpdated () {\n\t\tlet previousOriginalEditor = this.originalEditor;\n\t\tlet selector = this.element.getAttribute(\"mv-editor\");\n\n\t\ttry {\n\t\t\tthis.originalEditor = $(selector);\n\t\t}\n\t\tcatch (e) {\n\t\t\t// Invalid selector, potentially expression that has not yet evaluated?\n\t\t\tthis.originalEditor = null;\n\t\t}\n\n\t\tif (previousOriginalEditor === this.originalEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.originalEditor) {\n\t\t\tif (this.editor) {\n\t\t\t\tthis.editor = this.originalEditor.cloneNode(true);\n\t\t\t\tthis.setValue(this.value, {force: true, silent: true});\n\t\t\t}\n\n\t\t\t// Update editor if original mutates\n\t\t\t// This means that expressions on mv-editor for individual collection items will not be picked up\n\t\t\tif (!this.template || this.originalEditor !== this.template.originalEditor) {\n\t\t\t\tthis.originalEditorObserver?.destroy();\n\n\t\t\t\tthis.originalEditorObserver = new Mavo.Observer(this.originalEditor, \"all\", records => {\n\t\t\t\t\tlet nodes = [this];\n\n\t\t\t\t\tif (this.template) {\n\t\t\t\t\t\tlet copies = this.copies.filter(n => n.originalEditor === this.originalEditor);\n\t\t\t\t\t\tnodes.push(...copies);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let primitive of nodes) {\n\t\t\t\t\t\tif (primitive.defaultSource == \"editor\") {\n\t\t\t\t\t\t\tprimitive.default = this.originalEditor.value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (primitive.editor) {\n\t\t\t\t\t\t\tprimitive.editor = this.originalEditor.cloneNode(true);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tprimitive.setValue(primitive.value, {force: true, silent: true});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (this.editor) {\n\t\t\t\tthis.generateDefaultEditor();\n\t\t\t\tthis.editorUpdated();\n\t\t\t}\n\t\t}\n\t}\n\n\tedit (o = {}) {\n\t\tlet wasEditing = this.editing;\n\n\t\tif (super.edit(o) === false) {\n\t\t\t// Invalid edit\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!o.force && wasEditing && !this.initEdit) {\n\t\t\t// Already being edited\n\t\t\treturn true;\n\t\t}\n\n\t\tif ($.type(this._value) === \"object\") {\n\t\t\t// Editing is disabled when value is an object (see #692)\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!wasEditing) {\n\t\t\t// Make element focusable, so it can actually receive focus\n\t\t\tif (this.element.tabIndex === -1) {\n\t\t\t\tMavo.revocably.setAttribute(this.element, \"tabindex\", \"0\");\n\t\t\t}\n\n\t\t\t// Prevent default actions while editing\n\t\t\t// e.g. following links etc\n\t\t\tif (!this.modes) {\n\t\t\t\t$.bind(this.element, \"click.mavo:edit\", evt => {\n\t\t\t\t\tif (!this.editor.contains(evt.target)) {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (this.closestCollection && this.editor && this.editor.matches(Mavo.selectors.textInput)) {\n\t\t\t// If pasting text with line breaks and this is a single-line input\n\t\t\t// Insert them as multiple items\n\t\t\tlet multiline = this.editor.matches(\"textarea\");\n\n\t\t\tif (!multiline) {\n\t\t\t\t$.bind(this.editor, \"paste.mavo:edit\", evt => {\n\t\t\t\t\tif (!this.closestCollection.editing || !evt.clipboardData) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet text = evt.clipboardData.getData(\"text/plain\");\n\t\t\t\t\tconst CRLF = /\\r?\\n|\\r/;\n\n\t\t\t\t\tif (CRLF.test(text)) {\n\t\t\t\t\t\tevt.preventDefault();\n\n\t\t\t\t\t\tlet lines = text.split(CRLF);\n\n\t\t\t\t\t\t// \"Paste\" first line where the cursor is\n\t\t\t\t\t\tthis.editor.setRangeText(lines[0]);\n\t\t\t\t\t\t$.fire(this.editor, \"input\");\n\n\t\t\t\t\t\t// Insert the rest of the lines as new items\n\t\t\t\t\t\t// FIXME DRYfy the repetition between this code and the one below\n\t\t\t\t\t\tlet collection = this.closestCollection;\n\t\t\t\t\t\tlet index = closestItem?.index || 0;\n\n\t\t\t\t\t\tfor (let i=1; i<lines.length; i++) {\n\t\t\t\t\t\t\tlet closestItem = this.closestItem;\n\t\t\t\t\t\t\tlet next = collection.add(undefined, index + i);\n\t\t\t\t\t\t\tcollection.editItem(next); // TODO add() should take care of this\n\n\t\t\t\t\t\t\tlet copy = this.getCousin(i);\n\t\t\t\t\t\t\tcopy.render(lines[i]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t$.bind(this.editor, \"keydown.mavo:edit\", evt => {\n\t\t\t\tif (!this.closestCollection.editing) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (evt.key == \"Enter\" && (evt.shiftKey || !multiline)) {\n\t\t\t\t\tif (this.bottomUp) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet closestItem = this.closestItem;\n\t\t\t\t\tlet next = this.closestCollection.add(undefined, closestItem?.index + 1);\n\t\t\t\t\tthis.closestCollection.editItem(next);\n\n\t\t\t\t\tlet copy = this.getCousin(1);\n\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\tcopy.edit();\n\t\t\t\t\t\tcopy.editor.focus();\n\t\t\t\t\t});\n\n\t\t\t\t\tif (multiline) {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (evt.key == \"Backspace\" && (this.empty || evt[Mavo.superKey])) {\n\t\t\t\t\t// Focus on sibling afterwards\n\t\t\t\t\tlet sibling = this.getCousin(1) || this.getCousin(-1);\n\n\t\t\t\t\t// Backspace on empty primitive or Cmd/Ctrl + Backspace should delete item\n\t\t\t\t\tthis.closestCollection.delete(this.closestItem);\n\n\t\t\t\t\tif (sibling) {\n\t\t\t\t\t\tsibling.edit();\n\t\t\t\t\t\tsibling.editor.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.config.edit) {\n\t\t\tthis.config.edit.call(this);\n\t\t\tthis.initEdit = null;\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.pauseObserver();\n\n\t\t// Actual edit\n\n\t\tif (this.initEdit) {\n\t\t\tthis.initEdit();\n\t\t}\n\n\t\tthis.editor.classList.toggle(\"mv-editor\", this.editType !== \"popup\");\n\n\t\tif (this.editType === \"popup\") {\n\t\t\tif (!this.popup) {\n\t\t\t\tthis.popup = new Mavo.UI.Popup(this);\n\t\t\t}\n\n\t\t\tthis.popup.prepare();\n\n\t\t\tlet events = \"mousedown focus dragover dragenter\".split(\" \").map(e => e + \".mavo:edit\").join(\" \");\n\n\t\t\t$.bind(this.element, events, _ => this.popup.show());\n\t\t}\n\t\telse if (this.editType === \"inline\") {\n\t\t\tif (!this.editor.isConnected) {\n\t\t\t\tthis.editorValue = this.value;\n\n\t\t\t\tif (this.config.hasChildren) {\n\t\t\t\t\tthis.element.textContent = \"\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_.setText(this.element, \"\");\n\t\t\t\t}\n\n\t\t\t\t// If there's an expression on .textContent, it will kick\n\t\t\t\t// the editor out of the DOM next time it's updated.\n\t\t\t\t// To fix this, we re-assign it to the actual text node.\n\t\t\t\tif (!this.contentExpression) {\n\t\t\t\t\tthis.contentExpression = Mavo.DOMExpression.search(this.element, null);\n\t\t\t\t}\n\n\t\t\t\tif (this.contentExpression) {\n\t\t\t\t\tthis.contentExpression.active = false;\n\t\t\t\t}\n\n\t\t\t\tthis.element.prepend(this.editor);\n\t\t\t}\n\n\t\t\tif (!this.collection) {\n\t\t\t\tMavo.revocably.restoreAttribute(this.element, \"tabindex\");\n\t\t\t}\n\t\t}\n\n\t\tthis.resumeObserver();\n\n\t\treturn true;\n\t} // edit\n\n\tdone (o) {\n\t\tif (super.done(o) === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\t$.unbind(this.element, \".mavo:edit\");\n\n\t\tthis.pauseObserver();\n\n\t\tif (this.config.done) {\n\t\t\tthis.config.done.call(this);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.editType === \"popup\") {\n\t\t\tthis.popup?.close();\n\t\t}\n\t\telse if (this.editType === \"inline\" && this.editor) {\n\t\t\tthis.editor.remove();\n\n\t\t\tif (this.contentExpression) {\n\t\t\t\t// This only works because nothing else sets active\n\t\t\t\t// Eventually, we'll need to move to a stack of some sort\n\t\t\t\t// to cater to cases where active was false before, so should be false after\n\t\t\t\tthis.contentExpression.active = true;\n\t\t\t\tthis.contentExpression.update();\n\t\t\t}\n\n\t\t\t// force: true is needed because otherwise setValue() aborts when it sees\n\t\t\t// that the value we are trying to set is the same as the existing one\n\t\t\tthis.setValue(this.editorValue, {silent: true, force: true});\n\t\t}\n\n\t\tif (this.editor?.matches(\"select\")) {\n\t\t\t// Remove any temp options that we don’t need anymore\n\t\t\t$$(\".mv-volatile\", this.editor).forEach(o => {\n\t\t\t\tif (!o.selected) {\n\t\t\t\t\to.remove();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.resumeObserver();\n\n\t\tif (!this.collection) {\n\t\t\tMavo.revocably.restoreAttribute(this.element, \"tabindex\");\n\t\t}\n\t}\n\n\tdataRender (data, {live, root} = {}) {\n\t\tvar previousValue = this._value;\n\n\t\tif ($.type(data) === \"object\") {\n\t\t\tif (Symbol.toPrimitive in data) {\n\t\t\t\tdata = data[Symbol.toPrimitive](\"default\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Disable editing when the value is an object\n\t\t\t\t// We do that by calling .done() and then rejecting in .edit()\n\t\t\t\tif (this.editing) {\n\t\t\t\t\tthis.done();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data === undefined) {\n\t\t\t// New property has been added to the schema and nobody has saved since\n\t\t\tif (!this.modes && this.value === this.templateValue) {\n\t\t\t\tthis.value = this.closestCollection? this.default : this.templateValue;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.value = data;\n\t\t}\n\n\t\treturn this._value !== previousValue;\n\t}\n\n\tfind (property, o = {}) {\n\t\tif (this.property == property && o.exclude !== this) {\n\t\t\treturn this;\n\t\t}\n\t}\n\n\t/**\n\t * Get value from the DOM\n\t */\n\tgetValue (o) {\n\t\tif (this.editing && this.editor && this.editor !== this.element) {\n\t\t\treturn this.editorValue;\n\t\t}\n\n\t\treturn _.getValue(this.element, {\n\t\t\tconfig: this.config,\n\t\t\tattribute: this.attribute,\n\t\t\tdatatype: this.datatype\n\t\t});\n\t}\n\n\tsetValue (value, o = {}) {\n\t\tif (value === undefined) {\n\t\t\tvalue = null;\n\t\t}\n\n\t\tlet oldDatatype = this.datatype;\n\n\t\t// If there's no datatype, adopt that of the value\n\t\tif (!this.datatype && (typeof value == \"number\" || typeof value == \"boolean\")) {\n\t\t\tthis.datatype = typeof value;\n\t\t}\n\n\t\tvalue = _.safeCast(value, this.datatype);\n\n\t\tif (!o.force && value === this._value && oldDatatype == this.datatype) {\n\t\t\t// Do nothing if value didn't actually change, unless forced to\n\t\t\treturn value;\n\t\t}\n\n\t\tthis.pauseObserver();\n\n\t\tif (this.editor && this.editorValue != value) {\n\t\t\t// If an editor is present, set its value to match\n\t\t\tthis.editorValue = value;\n\t\t}\n\n\t\t// Also set DOM value if either using a popup, or there's no editor\n\t\t// or the editor is not inside the element (e.g. it could be a nested editor that is now detached)\n\t\tif (this.editType == \"popup\" || !this.editor || (this.editor !== document.activeElement && !this.element.contains(this.editor))) {\n\t\t\tif (this.config.setValue) {\n\t\t\t\tthis.config.setValue.call(this, this.element, value);\n\t\t\t}\n\t\t\telse if (!o.dataOnly) {\n\t\t\t\tlet map = this.originalEditor || this.editor;\n\t\t\t\tlet presentational;\n\n\t\t\t\tif (map?.matches(\"select\")) {\n\t\t\t\t\tpresentational = [...map.options].find(o => o.value == value)?.textContent;\n\t\t\t\t}\n\n\t\t\t\t_.setValue(this.element, value, {\n\t\t\t\t\tconfig: this.config,\n\t\t\t\t\tattribute: this.attribute,\n\t\t\t\t\tdatatype: this.datatype,\n\t\t\t\t\tpresentational,\n\t\t\t\t\tnode: this\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.empty = !value && value !== 0;\n\n\t\tthis._value = value;\n\n\t\tthis.liveData.update();\n\n\t\tif (!o.silent) {\n\t\t\tif (this.saved) {\n\t\t\t\tthis.unsavedChanges = this.mavo.unsavedChanges = true;\n\t\t\t}\n\n\t\t\tthis.dataChanged(\"propertychange\", {value});\n\t\t}\n\n\t\tthis.resumeObserver();\n\n\t\treturn value;\n\t}\n\n\tdataChanged (action = \"propertychange\", o) {\n\t\treturn super.dataChanged(action, o);\n\t}\n\n\tasync upload (file, name = file.name) {\n\t\tif (!this.mavo.uploadBackend || !self.FileReader) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tempURL = URL.createObjectURL(file);\n\n\t\t// FIXME what if there's no attribute?\n\t\tthis.pauseObserver();\n\t\tthis.element.setAttribute(this.attribute, tempURL);\n\t\tthis.resumeObserver();\n\n\t\tvar path = this.element.getAttribute(\"mv-upload-path\") || \"\";\n\t\tvar relative = path + \"/\" + name;\n\n\t\tlet url = await this.mavo.upload(file, relative);\n\t\t// Do we have a URL override?\n\t\tvar base = Mavo.getClosestAttribute(this.element, \"mv-upload-url\");\n\n\t\tif (base) {\n\t\t\t// Throw away backend-provided URL and use the override instead\n\t\t\turl = new URL(relative, new URL(base, location)) + \"\";\n\t\t}\n\n\t\tthis.value = url;\n\n\t\tif (!this.element.matches(\"a\")) {\n\t\t\t// <a> should get the proper URL immediately, because hovering would reveal what it is\n\t\t\t// for other types, we should keep the temporary URL because the real one may not have deployed yet\n\t\t\t// If the editor is manually edited, this will change anyway\n\t\t\tthis.pauseObserver();\n\t\t\tthis.element.setAttribute(this.attribute, tempURL);\n\t\t\tthis.resumeObserver();\n\t\t}\n\t}\n\n\tcreateUploadPopup (type, kind = \"file\", ext) {\n\t\tvar env = { context: this, type, kind, ext };\n\n\t\tenv.mainInput = $.create(\"input\", {\n\t\t\t\"type\": \"url\",\n\t\t\t\"placeholder\": `http://example.com/${kind}.${ext}`,\n\t\t\t\"className\": \"mv-output\",\n\t\t\t\"aria-label\": `URL to ${kind}`\n\t\t});\n\n\t\tif (this.mavo.uploadBackend && self.FileReader) {\n\t\t\tvar checkType = file => file && (!type || file.type.indexOf(type.replace(\"*\", \"\")) === 0);\n\n\t\t\tenv.events = {\n\t\t\t\t\"paste\": evt => {\n\t\t\t\t\t// Look for the first file in the clipboard\n\t\t\t\t\tvar item = Array.from(evt.clipboardData.items).find(item => item.kind === \"file\");\n\t\t\t\t\tvar ext = item?.type.split(\"/\")[1];\n\n\t\t\t\t\tif (item && checkType(item)) {\n\t\t\t\t\t\t// Is a file of the correct type, upload!\n\t\t\t\t\t\t// First, try to find its name in the clipboard\n\t\t\t\t\t\tvar defaultName = evt.clipboardData.getData(\"text\") || `pasted-${kind}-${Date.now()}.${ext}`;\n\t\t\t\t\t\tvar name = prompt(this.mavo._(\"filename\"), defaultName);\n\n\t\t\t\t\t\tif (name === \"\") {\n\t\t\t\t\t\t\tname = defaultName;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (name !== null) {\n\t\t\t\t\t\t\tthis.upload(item.getAsFile(), name, type);\n\t\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"drag dragstart dragend dragover dragenter dragleave drop\": evt => {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t},\n\t\t\t\t\"dragover dragenter\": evt => {\n\t\t\t\t\tenv.popup.classList.add(\"mv-dragover\");\n\t\t\t\t\tthis.element.classList.add(\"mv-dragover\");\n\t\t\t\t},\n\t\t\t\t\"dragleave dragend drop\": evt => {\n\t\t\t\t\tenv.popup.classList.remove(\"mv-dragover\");\n\t\t\t\t\tthis.element.classList.remove(\"mv-dragover\");\n\t\t\t\t},\n\t\t\t\t\"drop\": evt => {\n\t\t\t\t\tvar file = evt.dataTransfer.files[0];\n\n\t\t\t\t\tif (file && checkType(file)) {\n\t\t\t\t\t\tthis.upload(file);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tMavo.hooks.run(\"primitive-createuploadpopup-beforecreate\", env);\n\n\t\t\tenv.popup = $.create({\n\t\t\t\tclassName: \"mv-upload-popup\",\n\t\t\t\tcontents: [\n\t\t\t\t\tenv.mainInput, {\n\t\t\t\t\t\ttag: \"input\",\n\t\t\t\t\t\ttype: \"file\",\n\t\t\t\t\t\t\"aria-label\": `Upload ${kind}`,\n\t\t\t\t\t\taccept: type,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tchange: evt => {\n\t\t\t\t\t\t\t\tvar file = evt.target.files[0];\n\n\t\t\t\t\t\t\t\tif (file && checkType(file)) {\n\t\t\t\t\t\t\t\t\tthis.upload(file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tclassName: \"mv-tip\",\n\t\t\t\t\t\tinnerHTML: \"<strong>Tip:</strong> You can also drag & drop or paste!\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tevents: env.events\n\t\t\t});\n\n\t\t\t// Drag & Drop should also work on the <img> element itself\n\t\t\t$.bind(this.element, env.events);\n\n\t\t\tMavo.hooks.run(\"primitive-createuploadpopup-beforereturn\", env);\n\n\t\t\treturn env.popup;\n\t\t}\n\t\telse {\n\t\t\treturn env.mainInput;\n\t\t}\n\t}\n\n\tstatic getText (element) {\n\t\tvar node = element.nodeType === Node.TEXT_NODE? element : element.firstChild;\n\n\t\tif (node?.nodeType === Node.TEXT_NODE) {\n\t\t\treturn node.nodeValue;\n\t\t}\n\t\telse {\n\t\t\treturn \"\";\n\t\t}\n\t}\n\n\tstatic setText (element, text) {\n\t\tvar node = element.nodeType === Node.TEXT_NODE? element : element.firstChild;\n\n\t\tif (node?.nodeType === Node.TEXT_NODE) {\n\t\t\tnode.nodeValue = text;\n\t\t}\n\t\telse {\n\t\t\telement.prepend(text);\n\t\t}\n\t}\n\n\tstatic getValueAttribute (element, config = Mavo.Elements.search(element)) {\n\t\tvar ret = element.getAttribute(\"mv-attribute\") || config.attribute;\n\n\t\tif (!ret || ret === \"null\" || ret === \"none\") {\n\t\t\tret = null;\n\t\t}\n\n\t\treturn ret;\n\t}\n\n\t/**\n\t * Only cast if conversion is lossless\n\t */\n\tstatic safeCast (value, datatype) {\n\t\tvar existingType = typeof value;\n\t\tvar cast = _.cast(value, datatype);\n\n\t\tif (datatype == \"boolean\") {\n\t\t\tif (!value) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (value === \"true\" || value > 0) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\n\t\tif (datatype == \"number\") {\n\t\t\tif (/^[-+]?[0-9.e]+$/i.test(value + \"\")) {\n\t\t\t\treturn cast;\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\n\t\tif (value === null || value === undefined) {\n\t\t\treturn value;\n\t\t}\n\n\t\treturn cast;\n\t}\n\n\t/**\n\t * Cast to a different primitive datatype\n\t */\n\tstatic cast (value, datatype) {\n\t\tswitch (datatype) {\n\t\t\tcase \"number\": return +value;\n\t\t\tcase \"boolean\": return !!value;\n\t\t\tcase \"string\": return value + \"\";\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tstatic getValue (element, {config, attribute, datatype} = {}) {\n\t\tif (!config) {\n\t\t\tconfig = _.getConfig(element, attribute);\n\t\t}\n\n\t\tattribute = config.attribute;\n\t\tdatatype = config.datatype;\n\n\t\tif (config.getValue && attribute == config.attribute) {\n\t\t\treturn config.getValue(element);\n\t\t}\n\n\t\tvar ret;\n\n\t\tif (attribute in element && _.useProperty(element, attribute)) {\n\t\t\t// Returning properties (if they exist) instead of attributes\n\t\t\t// is needed for dynamic elements such as checkboxes, sliders etc\n\t\t\tret = element[attribute];\n\t\t}\n\t\telse if (attribute) {\n\t\t\tret = element.getAttribute(attribute);\n\t\t}\n\t\telse {\n\t\t\tret = element.getAttribute(\"content\") || _.getText(element) || null;\n\t\t}\n\n\t\treturn _.safeCast(ret, datatype);\n\t}\n\n\tstatic getConfig (element, attribute, datatype) {\n\t\tif (attribute === undefined) {\n\t\t\tattribute = element.getAttribute(\"mv-attribute\") || undefined;\n\t\t}\n\n\t\tif (attribute == \"null\" || attribute == \"none\") {\n\t\t\tattribute = null;\n\t\t}\n\n\t\tvar isAttributeDefault = attribute === undefined || attribute == _.getValueAttribute(element);\n\n\t\tif (!datatype && isAttributeDefault) {\n\t\t\tdatatype = element.getAttribute(\"datatype\") || undefined;\n\t\t}\n\n\t\tvar config = Mavo.Elements.search(element, attribute, datatype);\n\t\tconfig = Object.assign({}, config);\n\n\t\tif (config.attribute === undefined) {\n\t\t\tconfig.attribute = attribute || null;\n\t\t}\n\n\t\tif (config.datatype === undefined) {\n\t\t\tconfig.datatype = datatype;\n\t\t}\n\n\t\treturn config;\n\t}\n\n\t// This is called both on primitive nodes to set their value,\n\t// as well as (primitive) expressions\n\tstatic async setValue (element, value, o = {}) {\n\t\tdelete _.pending.get(element)?.[o.attribute];\n\n\t\tif ($.type(value) === \"promise\") {\n\t\t\tif (!_.pending.has(element)) {\n\t\t\t\t_.pending.set(element, {});\n\t\t\t}\n\n\t\t\tlet pending = value;\n\t\t\t_.pending.get(element)[o.attribute] = pending;\n\n\t\t\ttry {\n\t\t\t\tvalue = await pending;\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tvalue = e;\n\t\t\t}\n\n\t\t\tif (_.pending.get(element)[o.attribute] !== pending) {\n\t\t\t\t// Value has been superseded\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdelete _.pending.get(element)?.[o.attribute];\n\t\t}\n\n\t\tif (element.nodeType === 1) {\n\t\t\tif (!o.config) {\n\t\t\t\to.config = _.getConfig(element, o.attribute);\n\t\t\t}\n\n\t\t\to.attribute = o.attribute !== undefined? o.attribute : o.config.attribute;\n\t\t\to.datatype = o.datatype !== undefined? o.datatype : o.config.datatype;\n\n\t\t\tif (o.config.setValue && o.attribute == o.config.attribute) {\n\t\t\t\treturn o.config.setValue(element, value, o.attribute);\n\t\t\t}\n\t\t}\n\n\t\tif (value === null && !o.datatype) {\n\t\t\tvalue = \"\";\n\t\t}\n\n\t\tif (o.attribute) {\n\t\t\tif (o.attribute in element && _.useProperty(element, o.attribute) && element[o.attribute] !== value) {\n\t\t\t\t// Setting properties (if they exist) instead of attributes\n\t\t\t\t// is needed for dynamic elements such as checkboxes, sliders etc\n\t\t\t\ttry {\n\t\t\t\t\tvar previousValue = element[o.attribute];\n\t\t\t\t\tvar newValue = element[o.attribute] = value;\n\t\t\t\t}\n\t\t\t\tcatch (e) {}\n\t\t\t}\n\n\t\t\t// Set attribute anyway, even if we set a property because when\n\t\t\t// they're not in sync it gets really fucking confusing.\n\t\t\tif (o.datatype == \"boolean\") {\n\t\t\t\tif (value != element.hasAttribute(o.attribute)) {\n\t\t\t\t\t$.toggleAttribute(element, o.attribute, value, value);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (element.getAttribute(o.attribute) != value) {  // intentionally non-strict, e.g. \"3.\" !== 3\n\t\t\t\telement.setAttribute(o.attribute, value);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvar presentational = o.presentational ?? _.format(value, o);\n\n\t\t\tif (o.node && !o.config.hasChildren) {\n\t\t\t\t_.setText(element, presentational);\n\t\t\t}\n\t\t\telse {\n\t\t\t\telement.textContent = presentational;\n\t\t\t}\n\n\t\t\tif (presentational !== value && element.setAttribute) {\n\t\t\t\telement.setAttribute(\"content\", value);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t *  Set/get a property or an attribute?\n\t * @return {Boolean} true to use a property, false to use the attribute\n\t */\n\tstatic useProperty (element, attribute) {\n\t\tif ([\"href\", \"src\"].indexOf(attribute) > -1) {\n\t\t\t// URL properties resolve \"\" as location.href, fucking up emptiness checks\n\t\t\treturn false;\n\t\t}\n\n\t\tif (element.namespaceURI == \"http://www.w3.org/2000/svg\") {\n\t\t\t// SVG has a fucked up DOM, do not use these properties\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstatic format (value, o = {}) {\n\t\tif (($.type(value) === \"number\" || o.datatype == \"number\")) {\n\t\t\tif (value === null) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\n\t\t\tvar skipNumberFormatting = o.attribute || o.element?.matches(\"style, pre\");\n\n\t\t\tif (!skipNumberFormatting) {\n\t\t\t\treturn _.formatNumber(value);\n\t\t\t}\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(_.format).join(\", \");\n\t\t}\n\n\t\tif ($.type(value) === \"object\") {\n\t\t\t// Oops, we have an object. Print something more useful than [object Object]\n\t\t\treturn Mavo.toJSON(value);\n\t\t}\n\n\t\treturn value;\n\t}\n};\n\n$.Class(_, {\n\tlazy: {\n\t\temptyValue: function() {\n\t\t\tswitch (this.datatype) {\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\treturn false;\n\t\t\t\tcase \"number\":\n\t\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn \"\";\n\t\t},\n\n\t\teditorDefaults: function() {\n\t\t\treturn this.editor && _.getConfig(this.editor);\n\t\t},\n\n\t\teditType: function() {\n\t\t\treturn this.updateEditType();\n\t\t}\n\t},\n\n\tlive: {\n\t\teditor: function (value) {\n\t\t\tif (this._editor === value) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If we are editing the node, just setting this.editor won't help\n\t\t\t// we also need to update it in the DOM\n\t\t\tthis._editor?.replaceWith(value);\n\n\t\t\tthis._editor = value;\n\n\t\t\tif (this.defaultSource === \"editor\") {\n\t\t\t\tthis.default = this.editorValue;\n\t\t\t}\n\n\t\t\tthis.editorUpdated();\n\t\t},\n\n\t\tdefault: function (value) {\n\t\t\tif (this.value == this._default) {\n\t\t\t\tthis.value = value;\n\t\t\t}\n\t\t},\n\n\t\tvalue: function (value) {\n\t\t\treturn this.setValue(value);\n\t\t},\n\n\t\tdatatype: function (value) {\n\t\t\tif (value !== this._datatype) {\n\t\t\t\tif (value == \"boolean\" && !this.attribute) {\n\t\t\t\t\tthis.attribute = Mavo.Elements.defaultConfig.boolean.attribute;\n\t\t\t\t}\n\n\t\t\t\t$.toggleAttribute(this.element, \"datatype\", value, value && value !== \"string\");\n\t\t\t}\n\t\t},\n\n\t\tempty: function (value) {\n\t\t\tlet hide = value && // is empty\n\t\t\t           !this.modes && // and supports both modes\n\t\t\t           (!this.attribute || !$(Mavo.selectors.property, this.element)) && // and has no property inside\n\t\t\t\t\t   // and is not boolean OR if it is, its attribute is the default boolean attribute (see #464)\n\t\t\t           (this.datatype !== \"boolean\" || this.attribute === Mavo.Elements.defaultConfig.boolean.attribute);\n\n\t\t\tthis.element.classList.toggle(\"mv-empty\", !!hide);\n\t\t}\n\t},\n\n\tstatic: {\n\t\tall: new WeakMap(),\n\t\tpending: new Map(),\n\n\t\tlazy: {\n\t\t\tformatNumber: () => {\n\t\t\t\tvar numberFormat = new Intl.NumberFormat(Mavo.locale, {maximumFractionDigits:2});\n\n\t\t\t\treturn function(value) {\n\t\t\t\t\tif (value === Infinity || value === -Infinity) {\n\t\t\t\t\t\t// Pretty print infinity\n\t\t\t\t\t\treturn value < 0? \"-∞\" : \"∞\";\n\t\t\t\t\t}\n\n\t\t\t\t\treturn numberFormat.format(value);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n});\n\nMavo.observe({id: \"primitive\"}, function({node, type, attribute, record, element}) {\n\tif (node instanceof Mavo.Primitive && node.config && !node.pausedObserver) {\n\t\tif (attribute === \"mv-default\" && !node.defaultExpression) {\n\t\t\tnode.default = element.getAttribute(\"mv-default\");\n\t\t}\n\t\telse if (attribute === \"aria-label\") {\n\t\t\tnode.label = element.getAttribute(\"aria-label\");\n\n\t\t\tif (Mavo.in(\"placeholder\", node.editor)) {\n\t\t\t\tnode.editor.placeholder = `(${node.label})`;\n\t\t\t}\n\t\t}\n\t\telse if (attribute && attribute === \"mv-editor\") {\n\t\t\tnode.originalEditorUpdated();\n\t\t}\n\t\telse if (attribute && attribute === \"mv-edit-type\") {\n\t\t\tlet editing = node.editing;\n\n\t\t\tif (editing) {\n\t\t\t\t// Undo whatever editing UI we currently have\n\t\t\t\tnode.done({force: true});\n\t\t\t}\n\n\t\t\tnode.updateEditType();\n\n\t\t\tif (editing) {\n\t\t\t\tnode.edit({force: true});\n\t\t\t}\n\t\t}\n\t\telse if (attribute && attribute.indexOf(\"mv-editor-\") === 0) {\n\t\t\tnode.editor?.setAttribute(attribute.slice(10), element.getAttribute(attribute));\n\t\t}\n\t\telse if (node.config.observer !== false) {\n\t\t\t// Main value observer\n\t\t\tlet update = node.config.subtree; // always update when this flag is on regardless of what changed\n\n\t\t\tif (!update && (!node.editing || node.modes === \"edit\")) {\n\t\t\t\tupdate = attribute === node.attribute // note: these may be null\n\t\t\t\t         || node.config.observedAttributes?.includes(attribute)\n\t\t\t\t         || type === \"characterData\" && !node.attribute;\n\t\t\t}\n\n\t\t\tif (update) {\n\t\t\t\tnode.value = node.getValue();\n\t\t\t}\n\t\t}\n\t}\n});\n\nawait $.ready();\n\n// Migration from mv-edit-* to mv-editor-*\nlet inputTypes = [\n\t\"checkbox\", \"color\", \"date\", \"datetime-local\", \"email\", \"file\", \"month\", \"number\",\n\t\"password\", \"radio\", \"range\", \"search\", \"submit\", \"tel\", \"text\", \"time\", \"url\", \"week\", \"datetime\"];\nlet oldMvEdit = Mavo.attributeStartsWith(\"mv-edit-\")\n\t.filter(a => a.name !== \"mv-edit-type\" || inputTypes.includes(a.value))\n\t.map(a => a.name);\nlet newMvEdit = Mavo.attributeStartsWith(\"mv-editor-\");\n\nif ($(\"[mv-edit]\")) {\n\toldMvEdit.unshift(\"mv-edit\");\n}\n\nif (oldMvEdit.length > 0) {\n\tlet oldMvEditUnique = [...new Set(oldMvEdit)];\n\n\tfor (let name of oldMvEditUnique) {\n\t\tlet newName = name.replace(/^mv-edit(-|$)/, \"mv-editor$1\");\n\t\tlet elements = $$(`[${name}]`);\n\n\t\tconsole.log(`You are using attribute ${name} on ${elements.length} element(s). This syntax is deprecated and will be removed in the next version of Mavo. Please use ${newName} instead.`);\n\n\t\tfor (let element of elements) {\n\t\t\tMavo.setAttributeShy(element, newName, element.getAttribute(name));\n\t\t}\n\t}\n}\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.UI.Popup = $.Class({\n\tconstructor: function(primitive) {\n\t\tthis.primitive = primitive;\n\n\t\t// Need to be defined here so that this is what expected\n\t\tthis.position = evt => {\n\t\t\tvar bounds = this.primitive.element.getBoundingClientRect();\n\t\t\tvar x = bounds.left;\n\t\t\tvar y = bounds.bottom;\n\t\t\tvar pointDown = false;\n\n\t\t\tif (this.element.offsetHeight) {\n\t\t\t\t// Is in the DOM, check if it fits\n\t\t\t\tthis.height = this.element.getBoundingClientRect().height || this.height;\n\t\t\t}\n\n\t\t\tif (this.height + y + 20 > innerHeight) {\n\t\t\t\t// Normal positioning means the popup would be cut off or too close to the edge, adjust\n\n\t\t\t\t// Perhaps placing it above is better\n\t\t\t\tif (bounds.top - this.height > 20) {\n\t\t\t\t\tvar pointDown = true;\n\t\t\t\t\ty = bounds.top - this.height - 20;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Nah, just raise it a bit\n\t\t\t\t\ty = innerHeight - this.height - 20;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.element.classList.toggle(\"mv-point-down\", pointDown);\n\n\t\t\t$.style(this.element, { top:  `${y}px`, left: `${x}px` });\n\t\t};\n\n\t\tthis.element = $.create(\"div\", {\n\t\t\tclassName: \"mv-popup\",\n\t\t\thidden: true,\n\t\t\tcontents: {\n\t\t\t\ttag: \"fieldset\",\n\t\t\t\tcontents: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttag: \"legend\",\n\t\t\t\t\t\ttextContent: this.primitive.label + \":\"\n\t\t\t\t\t},\n\t\t\t\t\tthis.editor\n\t\t\t\t]\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tkeyup: evt => {\n\t\t\t\t\tif (evt.keyCode == 13 || evt.keyCode == 27) {\n\t\t\t\t\t\tif (this.element.contains(document.activeElement)) {\n\t\t\t\t\t\t\tthis.primitive.element.focus();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttransitionend: this.position\n\t\t\t}\n\t\t});\n\n\t\t// No point in having a dropdown in a popup\n\t\tif (this.editor.matches(\"select\")) {\n\t\t\tthis.editor.size = Math.min(10, this.editor.children.length);\n\t\t}\n\t\tthis.hideCallback = evt => {\n\t\t\tif (!this.element.contains(evt.target) && !this.primitive.element.contains(evt.target)) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t};\n\t},\n\n\tshow: function() {\n\t\t$.unbind([this.primitive.element, this.element], \".mavo:showpopup\");\n\n\t\tthis.shown = true;\n\n\t\tthis.element.style.transition = \"none\";\n\t\tthis.element.removeAttribute(\"hidden\");\n\n\t\tthis.position();\n\n\t\tthis.element.setAttribute(\"hidden\", \"\");\n\t\tthis.element.style.transition = \"\";\n\n\t\tdocument.body.appendChild(this.element);\n\n\t\tsetTimeout(() => {\n\t\t\tthis.element.removeAttribute(\"hidden\");\n\t\t}, 100); // trigger transition. rAF or timeouts < 100 don't seem to, oddly.\n\n\t\t$.bind(document, \"focus click\", this.hideCallback, true);\n\t\twindow.addEventListener(\"scroll\", this.position, {passive: true});\n\t},\n\n\thide: function() {\n\t\t$.unbind(document, \"focus click\", this.hideCallback, true);\n\t\twindow.removeEventListener(\"scroll\", this.position, {passive: true});\n\t\tthis.element.setAttribute(\"hidden\", \"\"); // trigger transition\n\t\tthis.shown = false;\n\n\t\tsetTimeout(() => {\n\t\t\t$.remove(this.element);\n\t\t}, parseFloat(getComputedStyle(this.element).transitionDuration) * 1000 || 400); // TODO transition-duration could override this\n\t},\n\n\tprepare: function() {\n\t\t$.bind(this.primitive.element, {\n\t\t\t\"click.mavo:edit\": evt => {\n\t\t\t\tthis.show();\n\t\t\t},\n\t\t\t\"keyup.mavo:edit\": evt => {\n\t\t\t\tif ([13, 113].indexOf(evt.keyCode) > -1) { // Enter or F2\n\t\t\t\t\tthis.show();\n\t\t\t\t\tthis.editor.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (!this.element.contains(this.editor)) {\n\t\t\t// This can happen if edit type changes from popup to inline\n\t\t\tthis.element.append(this.editor);\n\t\t}\n\t},\n\n\tclose: function() {\n\t\tthis.hide();\n\t\t$.unbind(this.primitive.element, \".mavo:edit .mavo:preedit .mavo:showpopup\");\n\t},\n\n\tproxy: {\n\t\t\"editor\": \"primitive\"\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n/**\n * Configuration for different types of elements. Options:\n * - attribute {String}\n * - useProperty {Boolean}\n * - datatype {\"number\"|\"boolean\"|\"string\"} Default is \"string\"\n * - modes\n * - editor {Object|Function}\n * - setEditorValue temporary\n * - edit\n * - done\n * - observe\n * - default: If there is no attribute, can we use that rule to pick one?\n * @\n */\n(function($, $$) {\n\nvar _ = Mavo.Elements = {};\n\nObject.defineProperties(_, {\n\t\"register\": {\n\t\tvalue: function(id, config) {\n\t\t\tif (typeof arguments[0] === \"object\") {\n\t\t\t\t// Multiple definitions\n\t\t\t\tfor (let s in arguments[0]) {\n\t\t\t\t\t_.register(s, arguments[0][s]);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (config.extend) {\n\t\t\t\tvar base = _[config.extend];\n\n\t\t\t\tconfig = $.extend($.extend({}, base), config);\n\t\t\t}\n\n\t\t\tif (id.indexOf(\"@\") > -1) {\n\t\t\t\tvar parts = id.split(\"@\");\n\n\t\t\t\tconfig.selector = config.selector || parts[0] || \"*\";\n\n\t\t\t\tif (config.attribute === undefined) {\n\t\t\t\t\tconfig.attribute = parts[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.selector = config.selector || id;\n\t\t\tconfig.id = id;\n\n\t\t\tif (Array.isArray(config.attribute)) {\n\t\t\t\tconfig.attribute.forEach(attribute => {\n\t\t\t\t\tvar o = $.extend({}, config);\n\t\t\t\t\to.attribute = attribute;\n\n\t\t\t\t\t_[`${id}@${attribute}`] = o;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_[id] = config;\n\t\t\t}\n\n\t\t\treturn _;\n\t\t}\n\t},\n\t\"search\": {\n\t\tvalue: function(element, attribute, datatype) {\n\t\t\tvar matches = _.matches(element, attribute, datatype);\n\n\t\t\tif (matches.length === 0 && datatype) {\n\t\t\t\t// 0 matches, try again without datatype\n\t\t\t\tmatches = _.matches(element, attribute);\n\t\t\t}\n\n\t\t\tvar lastMatch = matches[matches.length - 1];\n\n\t\t\tif (lastMatch) {\n\t\t\t\treturn lastMatch;\n\t\t\t}\n\n\t\t\tvar config = $.extend({}, _.defaultConfig[datatype || \"string\"]);\n\t\t\tconfig.attribute = attribute === undefined? config.attribute : attribute;\n\n\t\t\treturn config;\n\t\t}\n\t},\n\t\"matches\": {\n\t\tvalue: function(element, attribute, datatype) {\n\t\t\tvar matches = [];\n\n\t\t\tselectorloop: for (var id in _) {\n\t\t\t\tvar o = _[id];\n\n\t\t\t\t// Passes attribute test?\n\t\t\t\tvar attributeMatches = attribute === undefined && o.default || attribute === o.attribute;\n\n\t\t\t\tif (!attributeMatches) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Passes datatype test?\n\t\t\t\tif (datatype !== undefined && datatype !== \"string\" && datatype !== o.datatype) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Passes selector test?\n\t\t\t\tvar selector = o.selector || id;\n\n\t\t\t\tif (!element.matches(selector)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Passes arbitrary test?\n\t\t\t\tif (o.test && !o.test(element, attribute, datatype)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// All tests have passed\n\t\t\t\tmatches.push(o);\n\t\t\t}\n\n\t\t\treturn matches;\n\t\t}\n\t},\n\n\tisSVG: {\n\t\tvalue: e => e.namespaceURI == \"http://www.w3.org/2000/svg\"\n\t},\n\n\tdefaultConfig: {\n\t\tvalue: {\n\t\t\t\"string\":  {\n\t\t\t\teditor: { tag: \"input\" }\n\t\t\t},\n\t\t\t\"number\":  {\n\t\t\t\teditor: { tag: \"input\", type: \"number\" }\n\t\t\t},\n\t\t\t\"boolean\": {\n\t\t\t\tattribute: \"content\",\n\t\t\t\teditor: { tag: \"input\", type: \"checkbox\" }\n\t\t\t}\n\t\t}\n\t}\n});\n\n_.register({\n\t\"@hidden\": {\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"@y\": {\n\t\ttest: _.isSVG,\n\t\tdatatype: \"number\"\n\t},\n\n\t\"@x\": {\n\t\tdefault: true,\n\t\ttest: _.isSVG,\n\t\tdatatype: \"number\"\n\t},\n\n\t\"media\": {\n\t\tdefault: true,\n\t\tselector: \"img, video, audio\",\n\t\tattribute: \"src\",\n\t\teditor: function() {\n\t\t\tvar kind = this.element.nodeName.toLowerCase();\n\t\t\tkind = kind == \"img\"? \"image\" : kind;\n\t\t\tMavo.setAttributeShy(this.element, \"mv-upload-path\", kind + \"s\");\n\n\t\t\treturn this.createUploadPopup(kind + \"/*\", kind, \"png\");\n\t\t}\n\t},\n\n\t\"a, link\": {\n\t\tdefault: true,\n\t\tattribute: \"href\"\n\t},\n\n\t\"a[mv-upload-path], link[mv-upload-path]\": {\n\t\tdefault: true,\n\t\tattribute: \"href\",\n\t\teditor: function() {\n\t\t\tvar type = this.element.getAttribute(\"type\");\n\t\t\tvar ext = type && !/\\/\\*$/.test(type)? type.split(\"/\")[1] : \"pdf\";\n\t\t\treturn this.createUploadPopup(type, undefined, ext);\n\t\t}\n\t},\n\n\t\"video, audio\": {\n\t\tattribute: [\"autoplay\", \"buffered\", \"loop\"],\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"details\": {\n\t\tattribute: \"open\",\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"input, select, button, textarea\": {\n\t\tattribute: \"disabled\",\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"formControl\": {\n\t\tselector: \"input\",\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tmodes: \"edit\",\n\t\teditType: \"self\",\n\t\tchangeEvents: \"input change\",\n\t\tedit: () => {},\n\t\tdone: () => {},\n\t\tinit: function() {\n\t\t\tthis._editor = this.element;\n\t\t}\n\t},\n\n\t\"select\": {\n\t\textend: \"formControl\",\n\t\tselector: \"select\",\n\t\tsubtree: true\n\t},\n\n\t\"select[multiple]\": {\n\t\textend: \"select\",\n\t\tselector: \"select[multiple]\",\n\t\tgetValue: element => {\n\t\t\treturn Array.from(element.selectedOptions).map(option => option.value).join();\n\t\t},\n\t\tsetValue: (element, value) => {\n\t\t\t// Why +\"\"? If the value is being set via mv-value and is a number,\n\t\t\t// we must convert it to a string to avoid extra checks.\n\t\t\tvalue = Array.isArray(value)? value : (value + \"\").split(/\\s*,/);\n\n\t\t\tArray.from(element.options).forEach(option => {\n\t\t\t\t// Why? If the value is being set via mv-value,\n\t\t\t\t// we want the element to reflect the changes properly.\n\t\t\t\toption.selected = false;\n\n\t\t\t\t// Why +\"\"? Options' values are strings, so we want \"1\" instead of 1.\n\t\t\t\tvalue = value.map(v => v + \"\");\n\n\t\t\t\tif (value.includes(option.value)) {\n\t\t\t\t\toption.selected = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t\"option\": {\n\t\tattribute: null,\n\t\tmodes: \"read\",\n\t\tdefault: true\n\t},\n\n\t\"textarea\": {\n\t\textend: \"formControl\",\n\t\tselector: \"textarea\",\n\t\tattribute: null,\n\t\tgetValue: element => element.value,\n\t\tsetValue: (element, value) => element.value = value\n\t},\n\n\t\"formNumber\": {\n\t\textend: \"formControl\",\n\t\tselector: \"input[type=range], input[type=number]\",\n\t\tdatatype: \"number\",\n\t\tsetValue: function(element, value) {\n\t\t\telement.value = value;\n\t\t\telement.setAttribute(\"value\", value);\n\n\t\t\tvar attribute = value > element.value? \"max\" : \"min\";\n\n\t\t\tif (!isNaN(value) && element.value != value && !Mavo.data(element, \"boundObserver\")) {\n\t\t\t\t// Value out of bounds, maybe race condition? See #295\n\t\t\t\t// Observe min/max attrs until user interaction or data change\n\t\t\t\tif (Mavo.observers.find({element, id: \"oob\"}).size === 0) {\n\t\t\t\t\tMavo.observe({\n\t\t\t\t\t\tid: \"oob\",\n\t\t\t\t\t\telement, attribute,\n\t\t\t\t\t\tonce: true\n\t\t\t\t\t}, () => element.value = value);\n\t\t\t\t}\n\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t$.bind(element, \"input mv-change\", function handler() {\n\t\t\t\t\t\tMavo.unobserve({element, id: \"oob\"});\n\n\t\t\t\t\t\t// Why not just use {once: true}? because we have two events\n\t\t\t\t\t\t$.unbind(element, \"input mv-change\", handler);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tobservedAttributes: [\"min\", \"max\"]\n\t},\n\n\t\"checkbox\": {\n\t\textend: \"formControl\",\n\t\tselector: \"input[type=checkbox]\",\n\t\tattribute: \"checked\",\n\t\tdatatype: \"boolean\",\n\t\tchangeEvents: \"click\"\n\t},\n\n\t\"input[type=checkbox]\": {\n\t\tattribute: \"indeterminate\",\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"radio\": {\n\t\textend: \"formControl\",\n\t\tselector: \"input[type=radio]\",\n\t\tattribute: \"checked\",\n\t\tmodes: \"edit\",\n\t\tgetValue: element => {\n\t\t\tif (element.form) {\n\t\t\t\treturn element.form[element.name].value;\n\t\t\t}\n\n\t\t\tlet checked = $(`input[type=radio][name=\"${element.name}\"]:checked`);\n\t\t\treturn checked && checked.value;\n\t\t},\n\t\tsetValue: (element, value) => {\n\t\t\tif (element.form) {\n\t\t\t\telement.form[element.name].value = value;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet toCheck = $(`input[type=radio][name=\"${element.name}\"][value=\"${value}\"]`);\n\t\t\tif (toCheck) {\n\t\t\t\ttoCheck.checked = true;\n\t\t\t}\n\t\t},\n\t\tinitOnce: function(element) {\n\t\t\tfunction radioChanged(radio) {\n\t\t\t\tlet name = radio.name;\n\t\t\t\tfor (let otherRadio of $$(`input[type=radio][name=\"${radio.name}\"]`)) {\n\t\t\t\t\tlet node = Mavo.Node.get(otherRadio, true);\n\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tnode.value = node.getValue();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdocument.addEventListener(\"change\", evt => {\n\t\t\t\tif (evt.target.matches(\"input[type=radio]\")) {\n\t\t\t\t\tradioChanged(evt.target);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tMavo.observe({\n\t\t\t\tattribute: \"value\",\n\t\t\t\tselector: \"input[type=radio]\"\n\t\t\t}, r => radioChanged(r.element));\n\t\t},\n\t\tobservedAttributes: [\"value\"]\n\t},\n\n\t\"counter\": {\n\t\textend: \"formControl\",\n\t\tselector: \"button, .counter\",\n\t\tattribute: \"mv-clicked\",\n\t\tdatatype: \"number\",\n\t\tinit: function(element) {\n\t\t\tif (this.attribute === \"mv-clicked\") {\n\t\t\t\telement.setAttribute(\"mv-clicked\", \"0\");\n\n\t\t\t\telement.addEventListener(\"click\", evt => {\n\t\t\t\t\tlet clicked = +element.getAttribute(\"mv-clicked\") || 0;\n\t\t\t\t\tthis.value = ++clicked;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t\"meter, progress\": {\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tdatatype: \"number\",\n\t\tedit: function() {\n\t\t\tvar min = +this.element.getAttribute(\"min\") || 0;\n\t\t\tvar max = +this.element.getAttribute(\"max\") || 1;\n\t\t\tvar range = max - min;\n\t\t\tvar step = +this.element.getAttribute(\"mv-editor-step\") || (range > 1? 1 : range/100);\n\n\t\t\t$.bind(this.element, \"mousemove.mavo:edit\", evt => {\n\t\t\t\t// Change property as mouse moves\n\t\t\t\tvar left = this.element.getBoundingClientRect().left;\n\t\t\t\tvar offset = Math.max(0, (evt.clientX - left) / this.element.offsetWidth);\n\t\t\t\tvar newValue = min + range * offset;\n\t\t\t\tvar mod = newValue % step;\n\n\t\t\t\tnewValue += mod > step/2? step - mod : -mod;\n\t\t\t\tnewValue = Math.max(min, Math.min(newValue, max));\n\n\t\t\t\tthis.pauseObserver();\n\t\t\t\tthis.element.setAttribute(\"value\", newValue);\n\t\t\t\tthis.resumeObserver();\n\t\t\t});\n\n\t\t\t$.bind(this.element, \"mouseleave.mavo:edit\", evt => {\n\t\t\t\t// Return to actual value\n\t\t\t\tthis.pauseObserver();\n\t\t\t\tthis.element.setAttribute(\"value\", this.value);\n\t\t\t\tthis.resumeObserver();\n\t\t\t});\n\n\t\t\t$.bind(this.element, \"click.mavo:edit\", evt => {\n\t\t\t\t// Register change\n\t\t\t\tthis.value = this.getValue();\n\t\t\t});\n\n\t\t\t$.bind(this.element, \"keydown.mavo:edit\", evt => {\n\t\t\t\t// Edit with arrow keys\n\t\t\t\tif (evt.target == this.element && (evt.keyCode == 37 || evt.keyCode == 39)) {\n\t\t\t\t\tvar increment = step * (evt.keyCode == 39? 1 : -1) * (evt.shiftKey? 10 : 1);\n\t\t\t\t\tvar newValue = this.value + increment;\n\t\t\t\t\tnewValue = Math.max(min, Math.min(newValue, max));\n\n\t\t\t\t\tthis.element.setAttribute(\"value\", newValue);\n\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdone: function() {\n\t\t\t$.unbind(this.element, \".mavo:edit\");\n\t\t},\n\t\tobservedAttributes: [\"min\", \"max\"]\n\t},\n\n\t\"meta\": {\n\t\tdefault: true,\n\t\tattribute: \"content\"\n\t},\n\n\t\"block\": {\n\t\tdefault: true,\n\t\tselector: \"p, div, dt, dd, h1, h2, h3, h4, h5, h6, article, section, address, pre\",\n\t\teditor: function() {\n\t\t\tvar cs = getComputedStyle(this.element);\n\t\t\tvar display = cs.display;\n\t\t\tvar tag = display.indexOf(\"inline\") === 0? \"input\" : \"textarea\";\n\t\t\tvar editor = $.create(tag);\n\n\t\t\tif (tag == \"textarea\") {\n\t\t\t\t// Actually multiline\n\t\t\t\tvar width = this.element.offsetWidth;\n\n\t\t\t\tif (width) {\n\t\t\t\t\teditor.width = width;\n\t\t\t\t}\n\n\t\t\t\t// We cannot collapse whitespace because then users\n\t\t\t\t// are adding characters they don’t see (#300).\n\t\t\t\teditor.style.whiteSpace = ({\n\t\t\t\t\t\"normal\": \"pre-wrap\",\n\t\t\t\t\t\"nowrap\": \"pre\"\n\t\t\t\t})[cs.whiteSpace] || \"inherit\";\n\t\t\t}\n\n\t\t\treturn editor;\n\t\t},\n\n\t\tsetEditorValue: function(value) {\n\t\t\tif (this.datatype && this.datatype != \"string\") {\n\t\t\t\tvalue = value + \"\";\n\t\t\t}\n\n\t\t\tvar cs = getComputedStyle(this.element);\n\t\t\tvalue = value || \"\";\n\n\t\t\tif ([\"normal\", \"nowrap\"].indexOf(cs.whiteSpace) > -1) {\n\t\t\t\t// Collapse lines\n\t\t\t\tvalue = value.replace(/\\r?\\n/g, \" \");\n\t\t\t}\n\n\t\t\tif ([\"normal\", \"nowrap\", \"pre-line\"].indexOf(cs.whiteSpace) > -1) {\n\t\t\t\t// Collapse whitespace\n\t\t\t\tvalue = value.replace(/^[ \\t]+|[ \\t]+$/gm, \"\").replace(/[ \\t]+/g, \" \");\n\t\t\t}\n\n\t\t\tthis.editor.value = value;\n\t\t\treturn true;\n\t\t}\n\t},\n\n\t\"time\": {\n\t\tattribute: \"datetime\",\n\t\tdefault: true,\n\t\tinit: function() {\n\t\t\tif (!this.fromTemplate(\"dateType\")) {\n\t\t\t\tvar dateFormat = Mavo.DOMExpression.search(this.element, null);\n\t\t\t\tvar datetime = this.element.getAttribute(\"datetime\") || \"YYYY-MM-DD\";\n\n\t\t\t\tfor (var type in this.config.dateTypes) {\n\t\t\t\t\tif (this.config.dateTypes[type].test(datetime)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.dateType = type;\n\n\t\t\t\tif (!dateFormat) {\n\t\t\t\t\t// TODO what about mv-expressions?\n\t\t\t\t\tthis.element.textContent = this.config.defaultFormats[this.dateType](this.property);\n\t\t\t\t\tthis.mavo.expressions.extract(this.element, null);\n\n\t\t\t\t\tif (dateFormat = Mavo.DOMExpression.search(this.element, null)) {\n\t\t\t\t\t\tthis.mavo.treeBuilt.then(() => {\n\t\t\t\t\t\t\tdateFormat.update();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdateTypes: {\n\t\t\t\"month\": /^[Y\\d]{4}-[M\\d]{2}$/i,\n\t\t\t\"time\": /^[H\\d]{2}:[M\\d]{2}/i,\n\t\t\t\"datetime-local\": /^[Y\\d]{4}-[M\\d]{2}-[D\\d]{2} [H\\d]{2}:[Mi\\d]{2}/i,\n\t\t\t\"date\": /^[Y\\d]{4}-[M\\d]{2}-[D\\d]{2}$/i,\n\t\t},\n\t\tdefaultFormats: {\n\t\t\t\"date\": name => `[day(${name})] [month(${name}, 'shortname')] [year(${name})]`,\n\t\t\t\"month\": name => `[month(${name}, 'name')] [year(${name})]`,\n\t\t\t\"time\": name => `[hour(${name}, '00')]:[minute(${name}, '00')]`,\n\t\t\t\"datetime-local\": function(name) {\n\t\t\t\treturn this.date(name) + \" \" + this.time(name);\n\t\t\t}\n\t\t},\n\t\teditor: function() {\n\t\t\treturn {tag: \"input\", type: this.dateType};\n\t\t}\n\t},\n\n\t\"circle@r\": {\n\t\tdefault: true,\n\t\tdatatype: \"number\"\n\t},\n\n\t\"circle\": {\n\t\tattribute: [\"cx\", \"cy\"],\n\t\tdatatype: \"number\"\n\t},\n\n\t\"text\": {\n\t\tdefault: true,\n\t\teditType: \"popup\"\n\t},\n\n\t\".mv-toggle\": {\n\t\tdefault: true,\n\t\tattribute: \"aria-checked\",\n\t\tdatatype: \"boolean\",\n\t\tedit: function() {\n\t\t\tMavo.revocably.setAttribute(this.element, \"role\", \"checkbox\");\n\n\t\t\t$.bind(this.element, \"click.mavo:edit keyup.mavo:edit keydown.mavo:edit\", evt => {\n\t\t\t\tif (evt.type == \"click\" || evt.key == \" \" || evt.key == \"Enter\") {\n\t\t\t\t\tif (evt.type != \"keydown\") {\n\t\t\t\t\t\tthis.value = !this.value;\n\t\t\t\t\t}\n\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdone: function() {\n\t\t\tMavo.revocably.restoreAttribute(this.element, \"role\");\n\n\t\t\t$.unbind(this.element, \".mavo:edit\");\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nMavo.attributes.push(\"mv-multiple\", \"mv-order\", \"mv-accepts\", \"mv-initial-items\", \"mv-like\");\n\nvar _ = Mavo.Collection = class Collection extends Mavo.Node {\n\tconstructor (element, mavo, o) {\n\t\tsuper(element, mavo, o);\n\n\t\t/*\n\t\t * Create the template, remove it from the DOM and store it\n\t\t */\n\t\tthis.templateElement = this.element;\n\n\t\tthis.children = [];\n\t\tthis.liveData = new Mavo.Data(this, []);\n\n\t\t// Keep position of the template in the DOM, since we might remove it\n\t\tthis.marker = document.createComment(\"mv-marker\");\n\t\tMavo.data(this.marker, \"collection\", this);\n\n\t\tthis.templateElement.after(this.marker);\n\t\tthis.addButton = this.createAddButton();\n\n\t\tif (this.templateElement.hasAttribute(\"mv-like\")) {\n\t\t\tMavo.warn(\"@mv-like is deprecated and will be removed in the next version of Mavo\");\n\t\t}\n\n\t\tif (this.mavo.root || !this.templateElement.hasAttribute(\"mv-like\")) {\n\t\t\t// Synchronous init\n\t\t\tthis.init();\n\t\t}\n\t\telse {\n\t\t\t// Async init, we're borrowing the template from elsewhere so we need\n\t\t\t// to give the rest of the tree a chance to initialize\n\t\t\tthis.mavo.treeBuilt.then(() => this.init());\n\t\t}\n\t}\n\n\tcreateAddButton() {\n\t\t// Find add button if provided, or generate one\n\t\tvar selector = `button[class~=\"mv-add-${this.property}\"]`;\n\t\tvar group = this.parentGroup.element;\n\n\t\tvar button = $$(selector, group).filter(button => {\n\t\t\treturn !this.templateElement.contains(button)  // is outside the template element\n\t\t\t\t&& !Mavo.data(button, \"collection\"); // and does not belong to another collection\n\t\t})[0];\n\n\t\tif (button) {\n\t\t\t// Custom add button\n\t\t\tif (button.compareDocumentPosition(this.marker) & Node.DOCUMENT_POSITION_FOLLOWING) {\n\t\t\t\t// Button precedes collection, make collection bottom-up if no mv-order is set\n\t\t\t\tMavo.setAttributeShy(this.templateElement, \"mv-order\", \"desc\");\n\t\t\t}\n\n\t\t\tMavo.revocably.remove(button);\n\t\t}\n\t\telse {\n\t\t\tbutton = $.create(\"button\", {\n\t\t\t\ttype: \"button\",\n\t\t\t\tclassName: \"mv-ui\",\n\t\t\t\ttextContent: this.mavo._(\"add-item\", this)\n\t\t\t});\n\t\t};\n\n\t\tbutton.classList.add(\"mv-add\", `mv-add-${this.property}`);\n\t\tMavo.data(button, \"collection\", this);\n\n\t\tMavo.setAttributeShy(button, \"mv-action\", `add(${this.property})`);\n\n\t\treturn button;\n\t}\n\n\tinit () {\n\t\tif (!this.fromTemplate(\"templateElement\", \"accepts\", \"initialItems\", \"like\", \"likeNode\")) {\n\t\t\tthis.like = this.templateElement.getAttribute(\"mv-like\");\n\n\t\t\tif (this.like) {\n\t\t\t\tvar candidates = [];\n\t\t\t\tthis.mavo.walk(obj => {\n\t\t\t\t\tif (obj instanceof _ && obj.property === this.like && obj !== this) {\n\t\t\t\t\t\tcandidates.push(obj);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (candidates.length > 0) {\n\t\t\t\t\t// If there are multiple collections that match,\n\t\t\t\t\t// compare the paths and select the one that has the most overlap\n\t\t\t\t\tthis.likeNode = candidates.sort((a, b) => {\n\t\t\t\t\t\treturn a.pathFrom(this).length - b.pathFrom(this).length;\n\t\t\t\t\t})[0];\n\n\t\t\t\t\tthis.likeNode = this.likeNode.likeNode || this.likeNode;\n\t\t\t\t\tthis.likeNode = this.likeNode.template || this.likeNode;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.like = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.accepts = this.templateElement.getAttribute(\"mv-accepts\");\n\t\t\tthis.accepts = new Set(this.accepts?.split(/\\s+/));\n\n\t\t\tthis.initialItems = +(this.templateElement.getAttribute(\"mv-initial-items\") || (this.like? 0 : 1));\n\n\t\t\t// Must clone because otherwise once expressions are parsed on the template element\n\t\t\t// we will not be able to pick them up from subsequent items\n\t\t\tthis.templateElement = this.templateElement.cloneNode(true);\n\t\t}\n\n\t\tif (this.likeNode) {\n\t\t\tthis.itemTemplate = this.likeNode.itemTemplate || this.likeNode;\n\n\t\t\tvar templateElement = this.likeNode.templateElement || this.likeNode.collection?.templateElement || this.likeNode.element;\n\t\t\tthis.templateElement = templateElement.cloneNode(true);\n\t\t\tthis.templateElement.setAttribute(\"property\", this.property);\n\n\t\t\tif (!this.accepts.size) {\n\t\t\t\tthis.accepts = this.likeNode.accepts || this.accepts;\n\t\t\t}\n\t\t}\n\t\telse if (this.initialItems > 0 || !this.template) {\n\t\t\tvar item = this.createItem(this.element);\n\t\t\tthis.add(item, undefined, {silent: true});\n\t\t}\n\n\t\tthis.mavo.treeBuilt.then(() => {\n\t\t\tif (!this.initialItems) {\n\t\t\t\tif (item) {\n\t\t\t\t\tthis.delete(item, {silent: true});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// No item to delete\n\t\t\t\t\tthis.element.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.initialItems > 1) {\n\t\t\t\t// Add extra items\n\t\t\t\tfor (let i=1; i<this.initialItems; i++) {\n\t\t\t\t\tthis.add();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.postInit();\n\n\t\tMavo.hooks.run(\"collection-init-end\", this);\n\t}\n\n\tget length() {\n\t\treturn this.children.length;\n\t}\n\n\tgetData (o = {}) {\n\t\tvar env = {\n\t\t\tcontext: this,\n\t\t\toptions: o\n\t\t};\n\n\t\tenv.data = this.children.map(item => item.getData(env.options))\n\t\t                     .filter(itemData => Mavo.value(itemData) !== null);\n\t\tenv.data = Mavo.subset(this.data, this.inPath, env.data);\n\n\t\tMavo.hooks.run(\"node-getdata-end\", env);\n\n\t\treturn env.data;\n\t}\n\n\t// Create item but don't insert it anywhere\n\t// Mostly used internally\n\tcreateItem (element) {\n\t\tif (!element) {\n\t\t\telement = this.templateElement.cloneNode(true);\n\t\t}\n\n\t\tvar template = this.itemTemplate || this.template?.itemTemplate || null;\n\n\t\tvar item = Mavo.Node.create(element, this.mavo, {\n\t\t\tcollection: this,\n\t\t\ttemplate,\n\t\t\tproperty: this.property,\n\t\t\ttype: this.type\n\t\t});\n\n\t\tif (!this.itemTemplate) {\n\t\t\tthis.itemTemplate = template || item;\n\t\t}\n\n\t\treturn item;\n\t}\n\n\t/**\n\t * Add a new item to this collection\n\t * @param item {Node|Mavo.Node} Optional. Element or Mavo object for the new item\n\t * @param index {Number} Optional. Index of existing item, will be added opposite to list direction\n\t * @param silent {Boolean} Optional. Throw a datachange event? Mainly used internally.\n\t */\n\tadd (item, index, o = {}) {\n\t\tif (item instanceof Node) {\n\t\t\titem = Mavo.Node.get(item) || this.createItem(item);\n\t\t}\n\t\telse {\n\t\t\titem = item || this.createItem();\n\t\t}\n\n\t\tif (item.collection != this) {\n\t\t\t// Move item to this collection from elsewhere\n\t\t\tif (item.collection) {\n\t\t\t\t// It belongs to another collection, delete from there first\n\t\t\t\titem.collection.splice({remove: item});\n\t\t\t\titem.collection.dataChanged(\"delete\");\n\t\t\t}\n\n\t\t\t// FIXME this only includes saved data\n\t\t\t// Expressions can be recalculated, but writeable data that is simply not saved will not be here\n\t\t\tlet data = item.getData();\n\t\t\tlet editing = item.editing;\n\t\t\titem.element.remove();\n\t\t\titem.destroy();\n\n\t\t\titem = this.createItem();\n\n\t\t\tif (editing) {\n\t\t\t\tthis.editItem(item);\n\t\t\t}\n\n\t\t\titem.render(data);\n\t\t}\n\n\t\tif (index === undefined) {\n\t\t\tindex = this.bottomUp? 0 : this.length;\n\t\t}\n\n\t\t// Add it to the DOM, or fix its place\n\t\tvar rel = this.children?.[index]?.element ?? this.marker;\n\t\t$.before(item.element, rel);\n\n\t\tvar env = {context: this, item};\n\n\t\tenv.previousIndex = item.index;\n\n\t\t// Update internal data model\n\t\tenv.changed = this.splice({\n\t\t\tremove: env.item\n\t\t}, {\n\t\t\tindex: index,\n\t\t\tadd: env.item\n\t\t});\n\n\t\tif (this.mavo.expressions.active && !o.silent) {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tenv.changed.forEach(i => {\n\t\t\t\t\ti.dataChanged(i == env.item && env.previousIndex === undefined? \"add\" : \"move\");\n\t\t\t\t\ti.unsavedChanges = true;\n\t\t\t\t});\n\n\t\t\t\tthis.unsavedChanges = this.mavo.unsavedChanges = true;\n\n\t\t\t\tthis.mavo.expressions.update(env.item);\n\t\t\t});\n\t\t}\n\n\t\tMavo.hooks.run(\"collection-add-end\", env);\n\n\t\treturn env.item;\n\t}\n\n\tsplice (...actions) {\n\t\tactions.forEach(action => {\n\t\t\tif (action.index === undefined && action.remove && isNaN(action.remove)) {\n\t\t\t\t// Remove is an item\n\t\t\t\taction.index = this.children.indexOf(action.remove);\n\t\t\t\taction.remove = 1;\n\t\t\t}\n\t\t});\n\n\t\t// Sort in reverse index order\n\t\tactions.sort((a, b) => b.index - a.index);\n\n\t\tvar changed = [], deleted = [];\n\n\t\t// FIXME this could still result in buggy behavior.\n\t\t// Think of e.g. adding items on i, then removing > 1 items on i-1.\n\t\t// The new items would get removed instead of the old ones.\n\t\t// Not a pressing issue though since we always remove 1 max when adding things too.\n\t\tactions.forEach(action => {\n\t\t\tif (action.index > -1 && (action.remove || action.add)) {\n\t\t\t\taction.remove = action.remove || 0;\n\t\t\t\taction.add = Mavo.toArray(action.add);\n\t\t\t\tdeleted.push(...this.children.splice(action.index, +action.remove, ...action.add));\n\t\t\t}\n\t\t});\n\n\t\tdeleted = new Set(deleted);\n\n\t\t// Update indices\n\t\tfor (let i = 0; i < this.length; i++) {\n\t\t\tlet item = this.children[i];\n\t\t\tdeleted.delete(item);\n\n\t\t\tif (item && item.index !== i) {\n\t\t\t\titem.index = i;\n\t\t\t\tchanged.push(item);\n\t\t\t}\n\t\t}\n\n\t\t// Unregister expressions for deleted items\n\t\tdeleted.forEach(item => {\n\t\t\titem.expressions?.forEach(domexpression => {\n\t\t\t\titem.mavo.expressions.unregister(domexpression);\n\t\t\t});\n\t\t});\n\n\t\tthis.liveData.update();\n\n\t\treturn changed;\n\t}\n\n\tasync delete (item, {silent, undoable = !silent, transition = !silent, destroy = !undoable} = {}) {\n\t\titem.element.classList.remove(\"mv-highlight\");\n\n\t\tthis.splice({remove: item});\n\n\t\tif (!silent && transition) {\n\t\t\tawait $.transition(item.element, {opacity: 0});\n\t\t\titem.element.style.opacity = \"\";\n\t\t}\n\n\t\t$.remove(item.element);\n\n\t\tif (!silent) {\n\t\t\tthis.unsavedChanges = item.unsavedChanges = this.mavo.unsavedChanges = true;\n\n\t\t\titem.collection.dataChanged(\"delete\", {index: item.index});\n\t\t}\n\n\t\tif (undoable) {\n\t\t\tthis.mavo.setDeleted(item);\n\t\t}\n\t\telse if (destroy) {\n\t\t\titem.destroy();\n\t\t}\n\n\t\treturn item;\n\t}\n\n\t/**\n\t * Move existing item to a new position. Wraps around if position is out of bounds.\n\t * @offset relative position\n\t */\n\tmove (item, offset) {\n\t\tvar index = item.index + offset + (offset > 0);\n\n\t\tindex = Mavo.wrap(index, this.children.length + 1);\n\n\t\tthis.add(item, index);\n\t}\n\n\teditItem (item, o = {}) {\n\t\t// Get rid of old promise and replace it with new promise\n\t\titem.preEdit?.resolve(\"abort\");\n\n\t\tlet immediately = o.immediately || Mavo.inView.is(item.element);\n\n\t\titem.preEdit = Mavo.promise(immediately? Promise.resolve() : Mavo.inView.when(item.element));\n\n\t\treturn item.preEdit.then(value => {\n\t\t\tif (value === \"abort\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!item.itembar) {\n\t\t\t\titem.itembar = new Mavo.UI.Itembar(item);\n\t\t\t}\n\n\t\t\titem.itembar.add();\n\n\t\t\treturn item.edit(o);\n\t\t});\n\t}\n\n\tdoneItem (item) {\n\t\titem.itembar?.remove();\n\t\titem.preEdit?.resolve(\"abort\");\n\t}\n\n\tedit (o = {}) {\n\t\tif (super.edit() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Insert the add button if it's not already in the DOM\n\t\tif (!this.addButton.parentNode) {\n\t\t\tvar tag = this.element.tagName.toLowerCase();\n\n\t\t\tif (tag in Mavo.selectors.container) {\n\t\t\t\tvar rel = this.marker.parentNode.closest(Mavo.selectors.container[tag]);\n\t\t\t}\n\t\t\telse if (this.bottomUp && this.children[0]) {\n\t\t\t\tvar rel = this.children[0].element;\n\t\t\t}\n\n\t\t\trel = rel || this.marker;\n\t\t\tMavo.revocably.add(this.addButton, e => $[this.bottomUp? \"before\" : \"after\"](e, rel));\n\t\t}\n\n\t\t// Set up drag & drop\n\t\t_.dragula.then(() => {\n\t\t\tthis.getDragula();\n\t\t});\n\n\t\t// Edit items, maybe insert item bar\n\t\treturn Promise.all(this.children.map(item => this.editItem(item, o)));\n\t}\n\n\tdone () {\n\t\tif (super.done() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\tMavo.revocably.remove(this.addButton);\n\n\t\tthis.propagate(item => this.doneItem(item));\n\t}\n\n\tdataChanged (action, o = {}) {\n\t\to.element = o.element || this.marker;\n\t\treturn super.dataChanged(action, o);\n\t}\n\n\tdataRender (data, o = {}) {\n\t\tif (data === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tdata = data === null? [] : Mavo.toArray(data).filter(i => i !== null);\n\t\tvar changed = false;\n\n\t\t// First render on existing items\n\t\tfor (var i = 0; i < this.children.length; i++) {\n\t\t\tvar item = this.children[i];\n\n\t\t\tif (i < data.length) {\n\t\t\t\tchanged = item.render(data[i], o) || changed;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchanged = true;\n\t\t\t\tthis.delete(item, {silent: true});\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\n\t\tif (data.length > i) {\n\t\t\t// There are still remaining items\n\t\t\t// Using document fragments improves performance by 60%\n\t\t\tvar fragment = document.createDocumentFragment();\n\n\t\t\tfor (var j = i; j < data.length; j++) {\n\t\t\t\tvar item = this.createItem();\n\n\t\t\t\tchanged = item.render(data[j], o) || changed;\n\n\t\t\t\tthis.children.push(item);\n\t\t\t\titem.index = j;\n\n\t\t\t\tfragment.appendChild(item.element);\n\n\t\t\t\tvar env = {context: this, item};\n\t\t\t\tMavo.hooks.run(\"collection-add-end\", env);\n\n\t\t\t}\n\n\t\t\tthis.marker.before(fragment);\n\t\t}\n\n\t\tthis.liveData.update();\n\n\t\tif (data.length > i) {\n\t\t\tfor (var j = i; j < this.children.length; j++) {\n\t\t\t\tthis.children[j].dataChanged(\"add\");\n\t\t\t}\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tisCompatible (c) {\n\t\treturn c && this.itemTemplate.constructor == c.itemTemplate.constructor && (c === this\n\t\t       || c.template == this || this.template == c || this.template && this.template == c.template\n\t\t       || this.accepts.has(c.property) > -1);\n\t}\n\n\t// Make sure to remove reference to .dragula\n\t// it seems to cause problem on OS chrome.\n\tdestroy () {\n\t\tsuper.destroy();\n\n\t\tthis.dragula?.destroy();\n\t\tthis.dragula = null;\n\n\t\tthis.propagate(\"destroy\");\n\t}\n\n\t// Make sure to only call after dragula has loaded\n\tgetDragula () {\n\t\tif (this.dragula) {\n\t\t\treturn this.dragula;\n\t\t}\n\n\t\tif (this.template) {\n\t\t\tMavo.pushUnique(this.template.getDragula().containers, this.marker.parentNode);\n\t\t\treturn this.dragula = this.template.dragula || this.template.getDragula();\n\t\t}\n\n\t\tthis.dragula = dragula({\n\t\t\tcontainers: [this.marker.parentNode],\n\t\t\tisContainer: el => {\n\t\t\t\tif (this.accepts.size) {\n\t\t\t\t\treturn Array.from(el.childNodes).some(child => {\n\t\t\t\t\t\tvar collection = _.get(child);  // Map children to any associated collections\n\n\t\t\t\t\t\treturn collection && this.accepts.has(collection.property);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tmoves: (el, container, handle) => {\n\t\t\t\treturn handle.classList.contains(\"mv-drag-handle\") && handle.closest(Mavo.selectors.multiple) == el;\n\t\t\t},\n\t\t\taccepts: function(el, target, source, next) {\n\t\t\t\tif (el.contains(target)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar previous = next?.previousElementSibling ?? target.lastElementChild;\n\n\t\t\t\tvar collection = _.get(previous) || _.get(next);\n\n\t\t\t\tif (!collection) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar item = Mavo.Node.get(el);\n\n\t\t\t\treturn item?.collection.isCompatible(collection);\n\t\t\t}\n\t\t});\n\n\t\tthis.dragula.on(\"drop\", (el, target, source) => {\n\t\t\tvar item = Mavo.Node.get(el);\n\t\t\t// var oldIndex = item && item.index;\n\t\t\tvar next = el.nextElementSibling;\n\t\t\tvar previous = el.previousElementSibling;\n\t\t\tvar collection = _.get(previous) || _.get(next);\n\t\t\tvar closestItem = Mavo.Node.get(previous) || Mavo.Node.get(next);\n\n\t\t\tif (closestItem && closestItem.collection != collection) {\n\t\t\t\tclosestItem = null;\n\t\t\t}\n\n\t\t\tif (item.collection.isCompatible(collection)) {\n\t\t\t\tvar index = closestItem? closestItem.index + (closestItem.element === previous) : collection.length;\n\t\t\t\tcollection.add(item, index);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.dragula.cancel(true);\n\t\t\t}\n\t\t});\n\n\t\t_.dragulas.push(this.dragula);\n\n\t\treturn this.dragula;\n\t}\n\n\tgetClosestCollection () {\n\t\treturn this;\n\t}\n\n\tstatic get (element) {\n\t\t// Is it an add button or a marker?\n\t\tvar collection = Mavo.data(element, \"collection\");\n\n\t\tif (collection) {\n\t\t\treturn collection;\n\t\t}\n\n\t\t// Maybe it's a collection item?\n\t\tvar item = Mavo.Node.get(element);\n\n\t\treturn item?.collection || null;\n\t}\n\n\t// Delete multiple items from potentially multiple collections or even multiple mavos\n\tstatic async delete (nodes, o = {}) {\n\t\t// Drop nodes that are not collection items\n\t\tnodes = nodes.filter(node => !!node.collection);\n\n\t\tif (nodes.length === 0) {\n\t\t\treturn [];\n\t\t}\n\t\telse if (nodes.length === 1) {\n\t\t\tlet ret = await nodes[0].collection.delete(nodes[0], o);\n\t\t\treturn [ret];\n\t\t}\n\n\t\tlet deleted = new Mavo.BucketMap({arrays: true}); // Mavos and deleted items\n\t\tlet collections = new Set(); // Collections items were deleted from\n\n\t\tlet promises = nodes.map(async node => {\n\t\t\t\tcollections.add(node.collection);\n\t\t\t\t// We set undoable: false to suppress the Undo UI for individual items\n\t\t\t\t// so we can show one notice about all items\n\t\t\t\tlet options = {silent: true, undoable: false, destroy: false};\n\t\t\t\tlet item = await node.collection.delete(node, options);\n\t\t\t\titem.unsavedChanges = true;\n\t\t\t\tdeleted.set(node.mavo, node);\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\tlet ret = await Promise.all(promises);\n\n\t\tif (o.silent !== false) {\n\t\t\t// Here we are also batching change notifications to limit pointless expression recalc\n\t\t\t// Hopefully at some point we'll utilize a queue on the expression side\n\t\t\t// so we won't need to be careful about this in data modification code\n\t\t\tcollections.forEach(collection => {\n\t\t\t\tcollection.unsavedChanges = collection.mavo.unsavedChanges = true;\n\t\t\t\tcollection.dataChanged(\"delete\");\n\t\t\t});\n\n\t\t\tif (o.undoable !== false) {\n\t\t\t\tdeleted.forEach((nodes, mavo) => {\n\t\t\t\t\tmavo.setDeleted(...nodes);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t}\n};\n\n$.Class(_, {\n\tlazy: {\n\t\tbottomUp: function() {\n\t\t\t/**\n\t\t\t * Add new items at the top or bottom?\n\t\t\t */\n\n\t\t\treturn /^desc\\b/i.test(this.templateElement.getAttribute(\"mv-order\"));\n\t\t}\n\t},\n\n\tstatic: {\n\t\tdragulas: [],\n\n\t\tlazy: {\n\t\t\tdragula: () => $.include(self.dragula, \"https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js\")\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.ImplicitCollection = class ImplicitCollection extends Mavo.Node {\n\tconstructor (element, mavo, o) {\n\t\tsuper(element, mavo, o);\n\n\t\tthis.children = [];\n\t\tthis.liveData = new Mavo.Data(this, []);\n\n\t\tthis.add(element);\n\t\tthis.postInit();\n\n\t\tMavo.hooks.run(\"implicit-collection-init-end\", this);\n\t}\n\n\tget length() {\n\t\treturn this.children.length;\n\t}\n\n\tgetData (o = {}) {\n\t\tvar env = {\n\t\t\tcontext: this,\n\t\t\toptions: o,\n\t\t\tdata: []\n\t\t};\n\n\t\tthis.children.forEach(node => {\n\t\t\tif (!node.isDataNull()) {\n\t\t\t\tenv.data.push(node.getData(o));\n\t\t\t}\n\t\t});\n\n\t\tif (this.data) {\n\t\t\t// Maybe rendered data had more items than we could show? Add it back.\n\t\t\tvar rendered = Mavo.toArray(Mavo.subset(this.data, this.inPath));\n\n\t\t\tif (rendered.length > env.data.length) {\n\t\t\t\tenv.data = env.data.concat(rendered.slice(env.data.length));\n\t\t\t}\n\t\t}\n\n\t\tif (Array.isArray(env.data) && env.data.length <= 1) {\n\t\t\tenv.data = env.data.length === 1? env.data[0] : null;\n\t\t}\n\n\t\tenv.data = Mavo.subset(this.data, this.inPath, env.data);\n\n\t\tMavo.hooks.run(\"node-getdata-end\", env);\n\n\t\treturn env.data;\n\t}\n\n\t/**\n\t * Add a new item to this collection\n\t * @param item Element or Mavo object for the new item\n\t */\n\tadd (element) {\n\t\tvar item = Mavo.Node.create(element, this.mavo, {\n\t\t\tcollection: this,\n\t\t\ttemplate: this.template?.children?.[this.length] ?? null,\n\t\t\tproperty: this.property,\n\t\t\ttype: this.type\n\t\t});\n\n\t\titem.index = this.length;\n\t\tthis.children.push(item);\n\n\t\t// item may have tried to propagate updates to us when we created it,\n\t\t// but that wouldn't have worked since item was not yet in\n\t\t// this.children, so we need to update manually.\n\t\tthis.liveData.update();\n\n\t\treturn item;\n\t}\n\n\tedit (o = {}) {\n\t\tif (super.edit() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Edit items\n\t\treturn Promise.all(this.children.map(item => item.edit(o)));\n\t}\n\n\tdataRender (data, o = {}) {\n\t\tif (data !== undefined) {\n\t\t\tdata = data === null? [] : Mavo.toArray(data).filter(i => i !== null);\n\t\t\tvar changed = data.length !== this.liveData.length;\n\n\t\t\tthis.children.forEach((item, i) => changed = item.render(data?.[i], o) ?? changed);\n\t\t}\n\n\t\tthis.liveData.update();\n\t}\n};\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.UI.Itembar = $.Class({\n\tconstructor: function(item) {\n\t\tthis.item = item;\n\n\t\tthis.element = $$(`.mv-item-bar:not([mv-rel]), .mv-item-bar[mv-rel=\"${this.item.property}\"]`, this.item.element).filter(el => {\n\t\t\t\t// Ignore item controls meant for other collections\n\t\t\t\treturn el.closest(Mavo.selectors.multiple) == this.item.element && !Mavo.data(el, \"item\");\n\t\t\t})[0];\n\n\t\tif (!this.element && this.item.template?.itembar) {\n\t\t\t// We can clone the buttons from the template\n\t\t\tthis.element = this.item.template.itembar.element.cloneNode(true);\n\t\t\tthis.dragHandle = $(\".mv-drag-handle\", this.element) || this.item.element;\n\t\t}\n\t\telse {\n\t\t\t// First item of this type\n\t\t\tthis.element = this.element || $.create({\n\t\t\t\tclassName: \"mv-item-bar mv-ui\"\n\t\t\t});\n\n\t\t\tvar bottomUp = this.collection.bottomUp;\n\t\t\tvar args = `$item${bottomUp? \", $index + 1\" : \"\"}`;\n\t\t\tvar buttons = [\n\t\t\t\t{\n\t\t\t\t\ttag: \"button\",\n\t\t\t\t\ttype: \"button\",\n\t\t\t\t\ttitle: this.mavo._(\"delete-item\", this.item),\n\t\t\t\t\tclassName: \"mv-delete\",\n\t\t\t\t\t// Why $item and not this.collection.property?\n\t\t\t\t\t// If there's a nested property with the same name, the name will refer to that\n\t\t\t\t\t// However, this means that if we place the item bar inside another item, the button will not work anymore\n\t\t\t\t\t// It's a tradeoff, and perhaps if it proves to be a problem we can start detecting which one is best\n\t\t\t\t\t\"mv-action\": \"delete($item)\"\n\t\t\t\t}, {\n\t\t\t\t\ttag: \"button\",\n\t\t\t\t\ttype: \"button\",\n\t\t\t\t\ttitle: this.mavo._(`add-item-${bottomUp? \"after\" : \"before\"}`, this.item),\n\t\t\t\t\tclassName: \"mv-add\",\n\t\t\t\t\t\"mv-action\": `if($cmd, add($item, ${args}), add(${args}))`\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tif (this.item instanceof Mavo.Group) {\n\t\t\t\tthis.dragHandle = $.create({\n\t\t\t\t\ttag: \"button\",\n\t\t\t\t\ttype: \"button\",\n\t\t\t\t\ttitle: this.mavo._(\"drag-to-reorder\", this.item),\n\t\t\t\t\tclassName: \"mv-drag-handle\"\n\t\t\t\t});\n\n\t\t\t\tbuttons.push(this.dragHandle);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.dragHandle = this.item.element;\n\t\t\t}\n\n\t\t\t$.set(this.element, {\n\t\t\t\t\"mv-rel\": this.item.property,\n\t\t\t\tcontents: buttons\n\t\t\t});\n\t\t}\n\n\t\tthis.element.setAttribute(\"hidden\", \"\");\n\n\t\t$.bind([this.item.element, this.element], \"focusin mouseover\", this);\n\n\t\t$.bind(this.element, {\n\t\t\tmouseenter: evt => {\n\t\t\t\tthis.item.element.classList.add(\"mv-highlight\");\n\t\t\t},\n\t\t\tmouseleave: evt => {\n\t\t\t\tthis.item.element.classList.remove(\"mv-highlight\");\n\t\t\t}\n\t\t});\n\n\t\tthis.dragHandle.addEventListener(\"keydown\", evt => {\n\t\t\tif (evt.target === this.dragHandle && this.item.editing && evt.keyCode >= 37 && evt.keyCode <= 40) {\n\t\t\t\t// Arrow keys\n\t\t\t\tthis.collection.move(this.item, evt.keyCode <= 38? -1 : 1);\n\n\t\t\t\tevt.stopPropagation();\n\t\t\t\tevt.preventDefault();\n\t\t\t\tevt.target.focus();\n\t\t\t}\n\t\t});\n\n\t\tif (this.dragHandle !== this.item.element) {\n\t\t\tthis.dragHandle.addEventListener(\"click\", evt => evt.target.focus());\n\t\t}\n\n\t\tMavo.data(this.element, \"item\", this.item);\n\t},\n\n\tdestroy: function() {\n\t\tthis.hide();\n\t},\n\n\tshow: function(sticky) {\n\t\t_.visible.forEach(instance => {\n\t\t\tif (instance != this && (!this.sticky || instance.sticky)) {\n\t\t\t\tclearTimeout(instance.hideTimeout);\n\t\t\t\tinstance.hide(sticky, _.DELAY);\n\t\t\t}\n\t\t});\n\n\t\t_.visible.add(this);\n\n\t\tif (this.element.hasAttribute(\"hidden\") || sticky && !this.sticky) {\n\t\t\tthis.element.removeAttribute(\"hidden\");\n\t\t\tthis.sticky = this.sticky || sticky;\n\t\t\t$.bind([this.item.element, this.element], \"focusout mouseleave\", this);\n\t\t}\n\t},\n\n\thide: function(sticky, timeout = 0) {\n\t\tif (!this.sticky || sticky) {\n\t\t\tif (timeout) {\n\t\t\t\tthis.hideTimeout = setTimeout(() => this.hide(sticky), timeout);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.element.setAttribute(\"hidden\", \"\");\n\t\t\t\t$.unbind([this.item.element, this.element], \"focusout mouseleave\", this);\n\t\t\t\tthis.sticky = false;\n\t\t\t\t_.visible.delete(this);\n\t\t\t}\n\n\t\t}\n\t},\n\n\thandleEvent: function(evt) {\n\t\tvar sticky = evt.type.indexOf(\"mouse\") === -1;\n\n\t\tif (this.isWithinItem(evt.target)) {\n\t\t\tclearTimeout(this.hideTimeout);\n\n\t\t\tif ([\"mouseleave\", \"focusout\", \"blur\"].indexOf(evt.type) > -1) {\n\t\t\t\tif (!this.isWithinItem(evt.relatedTarget)) {\n\t\t\t\t\tthis.hide(sticky, _.DELAY);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.show(sticky);\n\t\t\t\tevt.stopPropagation();\n\t\t\t}\n\t\t}\n\t},\n\n\tisWithinItem: function(element) {\n\t\tif (!element) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar itemBar = element.closest(\".mv-item-bar\");\n\t\treturn itemBar? itemBar === this.element : element.closest(Mavo.selectors.item) === this.item.element;\n\t},\n\n\tadd: function() {\n\t\tif (!this.element.parentNode && !Mavo.revocably.add(this.element)) {\n\t\t\t// Has not been added before\n\t\t\tvar tag = this.item.element.nodeName.toLowerCase();\n\n\t\t\tif (tag in _.container) {\n\t\t\t\tvar rel = $(_.container[tag], this.item.element);\n\t\t\t}\n\n\t\t\t(rel || this.item.element).appendChild(this.element);\n\t\t}\n\n\t\tif (this.dragHandle == this.item.element) {\n\t\t\tthis.item.element.classList.add(\"mv-drag-handle\");\n\t\t}\n\t},\n\n\tremove: function() {\n\t\tMavo.revocably.remove(this.element);\n\n\t\tif (this.dragHandle == this.item.element) {\n\t\t\tthis.item.element.classList.remove(\"mv-drag-handle\");\n\t\t}\n\t},\n\n\tlive: {\n\t\tsticky: function(v) {\n\t\t\tthis.element.classList.toggle(\"mv-sticky\", v);\n\t\t}\n\t},\n\n\tproxy: {\n\t\tcollection: \"item\",\n\t\tmavo: \"item\"\n\t},\n\n\tstatic: {\n\t\tDELAY: 100,\n\t\tvisible: new Set(),\n\t\tcontainer: {\n\t\t\t\"details\": \"summary\"\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function() {\n\nvar _ = Mavo.Expression = class Expression {\n\tconstructor (expression, options = {}) {\n\t\tthis.options = options;\n\t\tthis.expression = expression;\n\t}\n\n\teval (data = Mavo.Data.stub) {\n\t\tMavo.hooks.run(\"expression-eval-beforeeval\", this);\n\n\t\tif (this.function instanceof Error) {\n\t\t\t// Previous compilation error\n\t\t\treturn this.function;\n\t\t}\n\n\t\ttry {\n\t\t\treturn this.function(data);\n\t\t}\n\t\tcatch (error) {\n\t\t\t// Runtime error\n\t\t\tthis.error(`Something went wrong with the expression ${this.expression}`,\n\t\t\t\terror.message,\n\t\t\t\t`Data was: ${JSON.stringify(data)}`\n\t\t\t);\n\n\t\t\tMavo.hooks.run(\"expression-eval-error\", {context: this, error});\n\n\t\t\treturn error;\n\t\t}\n\t}\n\n\terror (title, ...message) {\n\t\tmessage = message.join(\"\\n\");\n\t\tconsole.info(`%cOops! 😳 ${title}:`, \"color: #c04; font-weight: bold;\", message);\n\t}\n\n\ttoString () {\n\t\treturn this.expression;\n\t}\n\n\tchangedBy (evt) {\n\t\treturn _.changedBy(this.identifiers, evt);\n\t}\n};\n\nBliss.Class(_, {\n\tlive: {\n\t\texpression: function(value) {\n\t\t\ttry {\n\t\t\t\tthis.function = Mavo.Script.compile(value, this.options);\n\t\t\t}\n\t\t\tcatch (error) {\n\t\t\t\t// Compilation error\n\t\t\t\tthis.error(`There is something wrong with the expression ${value}`,\n\t\t\t\t\terror.message,\n\t\t\t\t\t\"Not an expression? See https://mavo.io/docs/expressions/#disabling-expressions for information on how to disable expressions.\"\n\t\t\t\t);\n\n\t\t\t\tMavo.hooks.run(\"expression-compile-error\", {context: this, error});\n\n\t\t\t\tthis.function = error;\n\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tthis.ast = this.options.ast;\n\t\t\tdelete this.options.ast;\n\n\t\t\tif (this.ast) {\n\t\t\t\t// Traverse AST to find potential identifiers\n\t\t\t\tlet identifiers = new Set();\n\n\t\t\t\tMavo.Script.walk(this.ast, (n, property, parent) => {\n\t\t\t\t\tif (n.type === \"Identifier\" && property !== \"callee\") {\n\t\t\t\t\t\tidentifiers.add(n.name);\n\t\t\t\t\t}\n\t\t\t\t\telse if (n.type === \"MemberExpression\") {\n\t\t\t\t\t\tif (n.object.name) {\n\t\t\t\t\t\t\tidentifiers.add(n.object.name);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tidentifiers.add(n.property.name);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.identifiers = [...identifiers];\n\t\t\t}\n\t\t}\n\t}\n});\n\n_.Syntax = class Syntax {\n\tconstructor (start, end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t\t// Try to parse anything between start and end as an expression. Note\n\t\t// that this parses text that we don't want to treat as expressions,\n\t\t// including the empty expression, but we want to parse them out anyway\n\t\t// and only later decide not to evaluate them as expressions so that we\n\t\t// don't parse, say, [][1] as a single expression containing \"][1\".\n\n\t\t// Regex note: \"[\\S\\s]\" matches all characters, unlike \".\", which\n\t\t// doesn't match newlines.\n\t\tthis.regex = RegExp(`${Mavo.escapeRegExp(start)}([\\\\S\\\\s]*?)${Mavo.escapeRegExp(end)}`, \"gi\");\n\t}\n\n\ttest (str) {\n\t\tthis.regex.lastIndex = 0;\n\n\t\treturn this.regex.test(str);\n\t}\n\n\ttokenize (str) {\n\t\tvar match, ret = [], lastIndex = 0;\n\n\t\tthis.regex.lastIndex = 0;\n\n\t\twhile ((match = this.regex.exec(str)) !== null) {\n\t\t\t// Literal before the expression\n\t\t\tif (match.index > lastIndex) {\n\t\t\t\tret.push(str.substring(lastIndex, match.index));\n\t\t\t}\n\n\t\t\tlastIndex = this.regex.lastIndex;\n\n\t\t\tif (/\\S/.test(match[1])) {\n\t\t\t\tret.push(new Mavo.Expression(match[1]));\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// If the matched expression is empty or consists only of\n\t\t\t\t// whitespace, don't treat it as an expression.\n\t\t\t\tret.push(match[0]);\n\t\t\t}\n\t\t}\n\n\t\t// Literal at the end\n\t\tif (lastIndex < str.length) {\n\t\t\tret.push(str.substring(lastIndex));\n\t\t}\n\n\t\treturn ret;\n\t}\n\n\tstatic create (element) {\n\t\tif (element) {\n\t\t\tvar syntax = element.getAttribute(\"mv-expressions\");\n\n\t\t\tif (syntax) {\n\t\t\t\tsyntax = syntax.trim();\n\t\t\t\treturn /\\s/.test(syntax)? new _.Syntax(...syntax.split(/\\s+/)) : _.Syntax.ESCAPE;\n\t\t\t}\n\t\t}\n\t}\n};\n\n_.Syntax.ESCAPE = -1;\n_.Syntax.default = new _.Syntax(\"[\", \"]\");\n\n})();\n\n(function($, $$) {\n\nvar _ = Mavo.DOMExpression = $.Class({\n\tconstructor: function(o = {}) {\n\t\tthis.mavo = o.mavo;\n\t\tthis.template = o.template?.template || o.template;\n\n\t\tfor (let prop of [\"item\", \"path\", \"syntax\", \"fallback\", \"attribute\", \"originalAttribute\", \"expression\", \"parsed\", \"identifiers\"]) {\n\t\t\tthis[prop] = o[prop] === undefined && this.template? this.template[prop] : o[prop];\n\t\t}\n\n\t\tthis.node = o.node;\n\n\t\tif (!this.node) {\n\t\t\t// No node provided, figure it out from path\n\t\t\tthis.node = Mavo.elementPath(this.item.element, this.path);\n\t\t}\n\n\t\tthis.element = this.node;\n\t\tthis.attribute = this.attribute || null;\n\n\t\tMavo.hooks.run(\"domexpression-init-start\", this);\n\n\t\tif (this.attribute == \"mv-value\") {\n\t\t\tthis.originalAttribute = \"mv-value\";\n\t\t\tthis.attribute = Mavo.Primitive.getValueAttribute(this.element);\n\t\t\tthis.fallback = this.fallback || Mavo.Primitive.getValue(this.element, {attribute: this.attribute});\n\t\t\tvar expression = this.element.getAttribute(\"mv-value\");\n\t\t\tthis.element.removeAttribute(\"mv-value\");\n\t\t\tthis.parsed = [new Mavo.Expression(expression)];\n\t\t\tthis.expression = this.syntax.start + expression + this.syntax.end;\n\t\t}\n\n\t\tif (this.node.nodeType === 3 && this.element === this.node) {\n\t\t\tthis.element = this.node.parentNode;\n\n\t\t\t// If no element siblings make this.node the element, which is more robust\n\t\t\t// Same if attribute, there are no attributes on a text node!\n\t\t\tif (!this.node.parentNode.children.length || this.attribute) {\n\t\t\t\tthis.node = this.element;\n\t\t\t\tthis.element.normalize();\n\t\t\t}\n\t\t}\n\n\t\tif (!this.expression) { // Still unhandled?\n\t\t\tif (this.attribute) {\n\t\t\t\t// Some web components (e.g. AFrame) hijack getAttribute()\n\t\t\t\tvar value = Element.prototype.getAttribute.call(this.node, this.attribute);\n\n\t\t\t\tthis.expression = (value || \"\").trim();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Move whitespace outside to prevent it from messing with types\n\t\t\t\tthis.node.normalize();\n\n\t\t\t\tif (this.node.childNodes.length === 1 && this.node?.firstChild?.nodeType === 3) {\n\t\t\t\t\tvar whitespace = this.node.firstChild.textContent.match(/^\\s*|\\s*$/g);\n\n\t\t\t\t\tif (whitespace[1]) {\n\t\t\t\t\t\tthis.node.firstChild.splitText(this.node.firstChild.textContent.length - whitespace[1].length);\n\t\t\t\t\t\tthis.node.after(this.node.lastChild);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (whitespace[0]) {\n\t\t\t\t\t\tthis.node.firstChild.splitText(whitespace[0].length);\n\t\t\t\t\t\tthis.node.parentNode.insertBefore(this.node.firstChild, this.node);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.expression = this.node.textContent;\n\t\t\t}\n\n\t\t\tthis.parsed = this.template? this.template.parsed : this.syntax.tokenize(this.expression);\n\t\t}\n\n\t\tthis.oldValue = this.value = this.parsed.map(x => x instanceof Mavo.Expression? \"\" : x);\n\n\t\t// Cache identifiers\n\t\tthis.identifiers = this.identifiers || this.parsed.flatMap(x => x.identifiers || []);\n\n\t\t// Any identifiers that need additional updating?\n\t\t_.special.add(this);\n\n\t\tthis.mavo.treeBuilt.then(() => {\n\t\t\tif (!this.template && !this.item) {\n\t\t\t\t// Only collection items and groups can have their own expressions arrays\n\t\t\t\tthis.item = Mavo.Node.getClosestItem(this.element);\n\t\t\t}\n\n\t\t\tif (this.originalAttribute == \"mv-value\" && this.mavoNode && this.mavoNode == this.item.collection) {\n\t\t\t\tMavo.delete(this.item.expressions, this);\n\t\t\t}\n\n\t\t\tthis.mavo.expressions.register(this);\n\n\t\t\tMavo.hooks.run(\"domexpression-init-treebuilt\", this);\n\t\t});\n\n\t\tMavo.hooks.run(\"domexpression-init-end\", this);\n\n\t\t_.elements.set(this.element, [...(_.elements.get(this.element) || []), this]);\n\t},\n\n\tdestroy: function() {\n\t\t_.special.delete(this);\n\t\tthis.mavo.expressions.unregister(this);\n\t},\n\n\tget isDynamicObject() {\n\t\treturn this.originalAttribute == \"mv-value\"\n\t\t       && this.mavoNode\n\t\t\t   && !(this.mavoNode instanceof Mavo.Primitive);\n\t},\n\n\tchangedBy: function(evt) {\n\t\tif (this.isDynamicObject) {\n\t\t\t// Just prevent the same node from triggering changes, everything else is game\n\t\t\treturn !evt || !this.mavoNode.contains(evt.node);\n\t\t}\n\n\t\treturn Mavo.Expression.changedBy(this.identifiers, evt);\n\t},\n\n\tupdate: function() {\n\t\tif (this.active === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar env = {context: this};\n\t\tvar parentEnv = env;\n\n\t\tif (this.item) {\n\t\t\tvar scope = this.isDynamicObject? this.item.parent : this.item;\n\t\t\tvar data = this.data = scope.getLiveData();\n\t\t}\n\t\telse {\n\t\t\tvar data = this.data === undefined? Mavo.Data.stub : this.data;\n\t\t}\n\n\t\tMavo.hooks.run(\"domexpression-update-start\", env);\n\n\t\tthis.oldValue = this.value;\n\t\tvar changed = false;\n\n\t\tenv.value = this.value = this.parsed.map((expr, i) => {\n\t\t\tif (expr instanceof Mavo.Expression) {\n\t\t\t\tvar env = {context: this, expr, parentEnv};\n\n\t\t\t\tMavo.hooks.run(\"domexpression-update-beforeeval\", env);\n\n\t\t\t\tenv.value = Mavo.value(env.expr.eval(data));\n\n\t\t\t\tMavo.hooks.run(\"domexpression-update-aftereval\", env);\n\n\t\t\t\tchanged = true;\n\n\t\t\t\tif (env.value instanceof Error) {\n\t\t\t\t\treturn this.fallback !== undefined? this.fallback : this.syntax.start + env.expr.expression + this.syntax.end;\n\t\t\t\t}\n\n\t\t\t\tif (env.value === undefined || env.value === null) {\n\t\t\t\t\t// Don’t print things like \"undefined\" or \"null\"\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\n\t\t\t\treturn env.value;\n\t\t\t}\n\n\t\t\treturn expr;\n\t\t});\n\n\t\tif (!changed) {\n\t\t\t// If nothing changed, no need to do anything\n\t\t\treturn;\n\t\t}\n\n\t\tif (env.value.length === 1) {\n\t\t\tenv.value = env.value[0];\n\t\t}\n\t\telse {\n\t\t\tenv.value = env.value.map(v => Mavo.Primitive.format(v, {\n\t\t\t\tattribute: this.attribute,\n\t\t\t\telement: this.element\n\t\t\t})).join(\"\");\n\t\t}\n\n\t\tthis.output(env.value);\n\n\t\tMavo.hooks.run(\"domexpression-update-end\", env);\n\t},\n\n\toutput: function(value) {\n\t\tif (this.primitive) {\n\t\t\tif (Mavo.in(Mavo.isProxy, value)) {\n\t\t\t\tvalue = Mavo.clone(value); // Drop proxy\n\t\t\t}\n\n\t\t\tthis.primitive.value = value;\n\t\t}\n\t\telse if (this.mavoNode) {\n\t\t\tthis.mavoNode.render(value);\n\t\t}\n\t\telse {\n\t\t\tMavo.Primitive.setValue(this.node, value, {attribute: this.attribute});\n\t\t}\n\t},\n\n\tlive: {\n\t\titem: function(item) {\n\t\t\tif (item && this._item != item) {\n\t\t\t\tif (this._item) {\n\t\t\t\t\t// Previous item, delete from its expressions\n\t\t\t\t\tMavo.delete(this._item.expressions, this);\n\t\t\t\t}\n\n\t\t\t\titem.expressions = item.expressions || [];\n\t\t\t\titem.expressions.push(this);\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\telements: new WeakMap(),\n\n\t\t/**\n\t\t * Search for Mavo.DOMExpression object(s) associated with a given element\n\t\t * and optionally an attribute.\n\t\t *\n\t\t * @return If one argument, array of matching DOMExpression objects.\n\t\t *         If two arguments, the matching DOMExpression object or null\n\t\t */\n\t\tsearch: function (element, attribute) {\n\t\t\tif (element === null) {\n\t\t\t\treturn element;\n\t\t\t}\n\n\t\t\t// HTML attributes are case-insensitive (fix for #515)\n\t\t\tif (attribute && !element.ownerDocument.xmlVersion) {\n\t\t\t\tattribute = attribute.toLowerCase();\n\t\t\t}\n\n\t\t\tvar all = _.elements.get(element) || [];\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tif (!all.length) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn all.filter(et => et.attribute === attribute)[0] || null;\n\t\t\t}\n\n\t\t\treturn all;\n\t\t},\n\n\t\tspecial: {\n\t\t\tadd: function(domexpression, name) {\n\t\t\t\tif (name) {\n\t\t\t\t\tvar o = this.vars[name];\n\t\t\t\t\tvar hasName = domexpression.identifiers.indexOf(name) > -1;\n\t\t\t\t\tvar hasUnprefixedName = (name.startsWith(\"$\") &&\n\t\t\t\t\t\tdomexpression.identifiers.indexOf(name.substr(1)) > -1);\n\n\t\t\t\t\tif (o && (hasName || hasUnprefixedName)) {\n\t\t\t\t\t\to.all = o.all || new Set();\n\t\t\t\t\t\to.all.add(domexpression);\n\n\t\t\t\t\t\tif (o.all.size === 1) {\n\t\t\t\t\t\t\to.observe();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (!o.all.size) {\n\t\t\t\t\t\t\to.unobserve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// All names\n\t\t\t\t\tfor (var name in this.vars) {\n\t\t\t\t\t\tthis.add(domexpression, name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdelete: function(domexpression, name) {\n\t\t\t\tif (name) {\n\t\t\t\t\tvar o = this.vars[name];\n\n\t\t\t\t\to.all = o.all || new Set();\n\t\t\t\t\to.all.delete(domexpression);\n\n\t\t\t\t\tif (!o.all.size) {\n\t\t\t\t\t\to.unobserve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// All names\n\t\t\t\t\tfor (var name in this.vars) {\n\t\t\t\t\t\tthis.delete(domexpression, name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tupdate: function() {\n\t\t\t\tthis.update?.(...arguments);\n\n\t\t\t\tthis.all.forEach(domexpression => domexpression.update());\n\t\t\t},\n\n\t\t\tevent: function(name, {type, update, target = document} = {}) {\n\t\t\t\tthis.vars[name] = {\n\t\t\t\t\tobserve: function() {\n\t\t\t\t\t\tthis.callback = this.callback || _.special.update.bind(this);\n\t\t\t\t\t\ttarget.addEventListener(type, this.callback);\n\t\t\t\t\t},\n\t\t\t\t\tunobserve: function() {\n\t\t\t\t\t\ttarget.removeEventListener(type, this.callback);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (update) {\n\t\t\t\t\tthis.vars[name].update = function(evt) {\n\t\t\t\t\t\tMavo.Functions[name] = update(evt);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tvars: {\n\t\t\t\t\"$now\": {\n\t\t\t\t\tobserve: function() {\n\t\t\t\t\t\tvar callback = () => {\n\t\t\t\t\t\t\t_.special.update.call(this);\n\t\t\t\t\t\t\tthis.timer = requestAnimationFrame(callback);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.timer = requestAnimationFrame(callback);\n\t\t\t\t\t},\n\t\t\t\t\tunobserve: function() {\n\t\t\t\t\t\tcancelAnimationFrame(this.timer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\n_.special.event(\"$mouse\", {\n\ttype: \"mousemove\",\n\tupdate: function(evt) {\n\t\treturn {x: evt.clientX, y: evt.clientY};\n\t}\n});\n\n_.special.event(\"$hash\", {\n\ttype: \"hashchange\",\n\ttarget: window\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nMavo.attributes.push(\"mv-expressions\");\n\nvar _ = Mavo.Expressions = $.Class({\n\tasync constructor (mavo) {\n\t\tthis.mavo = mavo;\n\t\tthis.active = true;\n\n\t\tthis.expressions = [];\n\t\tthis.identifiers = {};\n\n\t\tvar syntax = Mavo.Expression.Syntax.create(this.mavo.element.closest(\"[mv-expressions]\")) || Mavo.Expression.Syntax.default;\n\t\tthis.traverse(this.mavo.element, undefined, syntax);\n\n\t\tthis.scheduled = {};\n\n\t\tawait this.mavo.treeBuilt;\n\n\t\tthis.expressions = [];\n\t\tthis.update();\n\t},\n\n\tregister: function(domexpression) {\n\t\tvar ids = this.identifiers;\n\t\tdomexpression.registeredApp = domexpression.registeredApp || new Set();\n\t\tdomexpression.identifiers.forEach(id => {\n\t\t\tif (!(ids[id] instanceof Set)) {\n\t\t\t\tids[id] = new Set();\n\t\t\t}\n\n\t\t\tids[id].add(domexpression);\n\n\t\t\tif (Mavo.all[id] instanceof Mavo && Mavo.all[id] !== this.mavo && !domexpression.registeredApp.has(id) ) {\n\t\t\t\t// Cross-mavo expressions, make sure to track app id before calling register.\n\t\t\t\tdomexpression.registeredApp.add(id);\n\t\t\t\tMavo.all[id].expressions.register(domexpression);\n\t\t\t}\n\t\t});\n\t},\n\n\tunregister: function(domexpression) {\n\t\tvar ids = this.identifiers;\n\n\t\tdomexpression.identifiers.forEach(id => {\n\t\t\tif (ids[id]) {\n\t\t\t\tids[id].delete(domexpression);\n\t\t\t}\n\n\t\t\t// just in case domexpresssion has been destroyed by another app during the loop\n\t\t\t// when another app is destroyed.\n\t\t\tif (id in Mavo.all && typeof domexpresssion !== \"undefined\") {\n\t\t\t\t// Cross-mavo expressions\n\t\t\t\tMavo.all[id].expressions.unregister(domexpresssion);\n\t\t\t}\n\t\t});\n\t},\n\n\tupdateThrottled: function(evt) {\n\t\tif (!this.active) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar scheduled = this.scheduled[evt.action] = this.scheduled[evt.action] || new Set();\n\n\t\tif (evt.node.template) {\n\t\t\t// Throttle events in collections and events from other Mavos\n\t\t\tif (!scheduled.has(evt.node.template)) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tscheduled.delete(evt.node.template);\n\t\t\t\t\tthis.update(evt);\n\t\t\t\t}, _.THROTTLE);\n\n\t\t\t\tscheduled.add(evt.node.template);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\trequestAnimationFrame(() => this.update(evt));\n\t\t}\n\t},\n\n\tupdate: function(evt) {\n\t\tif (!this.active) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar root, rootObject;\n\n\t\tif (evt instanceof Mavo.Node) {\n\t\t\trootObject = evt;\n\t\t}\n\t\telse if (evt instanceof Element) {\n\t\t\troot = evt.closest(Mavo.selectors.item);\n\t\t\trootObject = Mavo.Node.get(root);\n\t\t}\n\t\telse if (evt) {\n\t\t\t// Specific data change\n\t\t\tvar cache = {\n\t\t\t\tupdated: new Set()\n\t\t\t};\n\n\t\t\tthis.updateByIdThrottled(evt.property, evt, cache);\n\n\t\t\tif (evt.action == \"propertychange\") {\n\t\t\t\tif (evt.node?.path) {\n\t\t\t\t\t// Ensure that [collectionName] updates when changing children\n\t\t\t\t\tthis.updateByIdThrottled(evt.node.path, evt, cache);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Collection modifications (add, delete, move etc)\n\t\t\t\tthis.updateById(Object.keys(Mavo.Data.special), evt, cache);\n\n\t\t\t\tvar collection = evt.node.collection || evt.node;\n\n\t\t\t\tthis.updateById(collection.properties, evt, cache);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\trootObject = this.mavo.root;\n\t\t}\n\n\t\trootObject.walk((obj, path) => {\n\t\t\tif (!obj.expressionsEnabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tobj.expressions?.forEach(et => {\n\t\t\t\t// Prevent mv-value loops\n\t\t\t\tif (!evt || et.mavoNode !== evt) {\n\t\t\t\t\tet.update();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\tupdateByIdThrottled: function(property, evt, cache) {\n\t\tif (!property) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (property.forEach) {\n\t\t\tproperty.forEach(property => this.updateByIdThrottled(property, evt, cache));\n\t\t}\n\t\telse {\n\t\t\tvar scheduled = this.scheduledIds = this.scheduledIds || new Set();\n\n\t\t\tif (!scheduled.has(property)) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tscheduled.delete(property);\n\n\t\t\t\t\tthis.updateById(property, evt, cache);\n\t\t\t\t}, _.THROTTLE);\n\n\t\t\t\tscheduled.add(property);\n\t\t\t}\n\t\t}\n\t},\n\n\tupdateById: function(property, evt, cache) {\n\t\tif (property.forEach) {\n\t\t\t// Multiple properties\n\t\t\tproperty.forEach(p => this.updateById(p, evt, cache));\n\t\t\treturn;\n\t\t}\n\n\t\tvar exprs = this.identifiers[property];\n\n\t\tif (exprs) {\n\t\t\texprs.forEach(expr => {\n\t\t\t\t// Prevent the same node from triggering changes, everything else is game\n\t\t\t\tif (expr.originalAttribute == \"mv-value\" && expr.mavoNode && !(expr.mavoNode instanceof Mavo.Primitive) && expr.mavoNode.contains(evt.node)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!cache.updated.has(expr)) {\n\t\t\t\t\texpr.update();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\textract: function(node, attribute, path, syntax = Mavo.Expression.Syntax.default) {\n\t\tif (attribute && _.skip.indexOf(attribute.name) > -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (attribute && _.directives.indexOf(attribute.name) > -1 ||\n\t\t    syntax !== Mavo.Expression.Syntax.ESCAPE && syntax.test(attribute? attribute.value : node.textContent)\n\t\t) {\n\t\t\tif (path === undefined) {\n\t\t\t\tpath = Mavo.elementPath(node.closest(Mavo.selectors.item), node);\n\t\t\t}\n\n\t\t\tthis.expressions.push(new Mavo.DOMExpression({\n\t\t\t\tnode, syntax, path,\n\t\t\t\tattribute: attribute?.name,\n\t\t\t\tmavo: this.mavo\n\t\t\t}));\n\t\t}\n\t},\n\n\t// Traverse an element, including attribute nodes, text nodes and all descendants\n\ttraverse: function(node, path = [], syntax) {\n\t\tif (node.nodeType === 8) {\n\t\t\t// We don't want expressions to be picked up from comments!\n\t\t\t// Commenting stuff out is a common debugging technique\n\t\t\treturn;\n\t\t}\n\n\t\tif (node.nodeType === 3) { // Text node\n\t\t\t// Leaf node, extract references from content\n\t\t\tthis.extract(node, null, path, syntax);\n\t\t}\n\t\telse {\n\t\t\tnode.normalize();\n\n\t\t\tsyntax = Mavo.Expression.Syntax.create(node) || syntax;\n\n\t\t\tif (Mavo.is(\"item\", node)) {\n\t\t\t\tpath = [];\n\t\t\t}\n\n\t\t\tif (node.hasAttribute(\"mv-expressions-ignore\")) {\n\t\t\t\tvar ignore = new Set(node.getAttribute(\"mv-expressions-ignore\").trim().split(/\\s*,\\s*/));\n\t\t\t}\n\n\t\t\t$$(node.attributes).forEach(attribute => {\n\t\t\t\tif (!ignore || !ignore.has(attribute.name)) {\n\t\t\t\t\tthis.extract(node, attribute, path, syntax);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar index = -1, offset = 0;\n\n\t\t\tif (!node.matches(\"script:not([mv-expressions])\")) {\n\t\t\t\t$$(node.childNodes).forEach(child => {\n\t\t\t\t\tif (child.nodeType == 1) {\n\t\t\t\t\t\toffset = 0;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\toffset++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (child.nodeType == 1 || child.nodeType == 3) {\n\t\t\t\t\t\tvar segment = offset > 0? `${index}.${offset}` : index;\n\t\t\t\t\t\tthis.traverse(child, [...path || [], segment], syntax);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\tdirectives: [\n\t\t\t\"mv-value\"\n\t\t],\n\n\t\tskip: [\"mv-expressions\", \"mv-action\"],\n\n\t\tTHROTTLE: 50,\n\n\t\tdirective: function(name, o) {\n\t\t\t_.directives.push(name);\n\t\t\tMavo.attributes.push(name);\n\t\t\tMavo.Plugins.register(name, o);\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n// mv-if plugin\n(function($, $$) {\n\nMavo.Expressions.directive(\"mv-if\", {\n\textend: {\n\t\t\"Primitive\": {\n\t\t\tlive: {\n\t\t\t\t\"hidden\": function(value) {\n\t\t\t\t\tif (this._hidden !== value) {\n\t\t\t\t\t\tthis._hidden = value;\n\t\t\t\t\t\tthis.liveData.update();\n\t\t\t\t\t\tthis.dataChanged();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"DOMExpression\": {\n\t\t\tlazy: {\n\t\t\t\t\"childProperties\": function() {\n\t\t\t\t\tvar properties = $$(Mavo.selectors.property, this.element)\n\t\t\t\t\t\t\t\t\t.filter(el => el.closest(\"[mv-if]\") == this.element)\n\t\t\t\t\t\t\t\t\t.map(el => Mavo.Node.get(el));\n\n\t\t\t\t\t// When the element is detached, mv-change events from properties\n\t\t\t\t\t// do not propagate up to the group so expressions do not recalculate.\n\t\t\t\t\t// We must do this manually.\n\t\t\t\t\tthis.element.addEventListener(\"mv-change\", evt => {\n\t\t\t\t\t\t// Cannot redispatch synchronously [why??]\n\t\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\t\tif (!this.element.parentNode) { // out of the DOM?\n\t\t\t\t\t\t\tthis.item.element.dispatchEvent(evt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\treturn properties;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\thooks: {\n\t\t\"domexpression-init-start\": function() {\n\t\t\tif (this.attribute != \"mv-if\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!Mavo.Node.prototype.fromTemplate.call(this, \"parsed\", \"expression\")) {\n\t\t\t\tthis.expression = this.element.getAttribute(\"mv-if\");\n\t\t\t\tthis.parsed = [new Mavo.Expression(this.expression)];\n\t\t\t\tthis.expression = this.syntax.start + this.expression + this.syntax.end;\n\t\t\t}\n\n\t\t\tthis.parentIf = this.element.parentNode && Mavo.DOMExpression.search(this.element.parentNode.closest(\"[mv-if]\"), \"mv-if\");\n\n\t\t\tif (this.parentIf) {\n\t\t\t\tthis.parentIf.childIfs = (this.parentIf.childIfs || new Set()).add(this);\n\t\t\t}\n\t\t},\n\t\t\"domexpression-update-end\": async function() {\n\t\t\tif (this.attribute !== \"mv-if\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar value = this.value[0];\n\t\t\tvar oldValue = this.oldValue[0];\n\n\t\t\t// Only apply this after the tree is built, otherwise any properties inside the if will go missing!\n\t\t\tawait this.item.mavo.treeBuilt;\n\n\t\t\tif (this.parentIf) {\n\t\t\t\tvar parentValue = this.parentIf.value[0];\n\t\t\t\tthis.value[0] = value = value && parentValue;\n\t\t\t}\n\n\t\t\tif (parentValue !== false) { // If parent if was false, it wouldn't matter whether this is in the DOM or not\n\t\t\t\tif (value) {\n\t\t\t\t\t// Is removed from the DOM and needs to get back\n\t\t\t\t\tMavo.revocably.add(this.element);\n\t\t\t\t}\n\t\t\t\telse if (this.element.parentNode) {\n\t\t\t\t\t// Is in the DOM and needs to be removed\n\t\t\t\t\tMavo.revocably.remove(this.element, \"mv-if\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value !== oldValue) {\n\t\t\t\t// Mark any properties inside as hidden or not\n\t\t\t\tthis.childProperties?.forEach(property => property.hidden = !value);\n\t\t\t\tthis.childIfs?.forEach(childIf => childIf.update());\n\t\t\t}\n\t\t},\n\t\t\"node-isdatanull\": function(env) {\n\t\t\tenv.result = env.result || (this.hidden && env.options.live);\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n/**\n * Functions available inside Mavo expressions\n */\n\n(function($, val) {\n\nvar _ = Mavo.Functions = {\n\toperators: {\n\t\t\"=\": \"eq\"\n\t},\n\n\t/**\n\t * Get a property of an object. Used by the . operator to prevent TypeErrors\n\t */\n\tget: function(obj, property, meta = {}) {\n\t\tproperty = meta.property = val(property);\n\n\t\t// Get same case property name if it exists,\n\t\t// otherwise do a case insensitive search among properties\n\t\tvar canonicalProperty = Mavo.getCanonicalProperty(obj, property);\n\n\t\tif (canonicalProperty !== undefined) {\n\t\t\tmeta.property = canonicalProperty;\n\t\t\tvar ret = obj[canonicalProperty];\n\n\t\t\tif (typeof ret === \"function\" && ret.name.indexOf(\"bound\") !== 0) {\n\t\t\t\treturn ret.bind(obj);\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}\n\n\t\tif (Array.isArray(obj) && property && isNaN(property)) {\n\t\t\t// Array and non-numerical property\n\t\t\tvar eqIndex = property.indexOf(\"=\");\n\n\t\t\tif (eqIndex > -1) {\n\t\t\t\t// propertyName=value is used as a query for arrays of objects\n\t\t\t\t// This is mainly useful for mv-path\n\t\t\t\tmeta.query = {\n\t\t\t\t\tproperty: property.slice(0, eqIndex),\n\t\t\t\t\tvalue: property.slice(eqIndex + 1)\n\t\t\t\t};\n\n\t\t\t\tmeta.property = [];\n\n\t\t\t\tret = obj.filter((e, i) => {\n\t\t\t\t\tvar passes = _.get(e, meta.query.property) == meta.query.value;\n\n\t\t\t\t\tif (passes) {\n\t\t\t\t\t\tmeta.property.push(i);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn passes;\n\t\t\t\t});\n\n\t\t\t\tif (meta.query.property == \"id\") {\n\t\t\t\t\tmeta.property = meta.property[0];\n\t\t\t\t\tret = ret[0];\n\t\t\t\t}\n\n\t\t\t\tif (ret === undefined) {\n\t\t\t\t\tmeta.property = obj.length;\n\t\t\t\t}\n\t\t\t\telse if (ret.length === 0) {\n\t\t\t\t\tmeta.property = [obj.length];\n\t\t\t\t}\n\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Not a property query, get from objects inside\n\t\t\t\t// TODO meta.property = ??\n\t\t\t\treturn obj.map(e => _.get(e, property));\n\t\t\t}\n\t\t}\n\n\t\t// Not found :(\n\t\treturn null;\n\t},\n\n\turl: (id, url = location) => {\n\t\tif (id === undefined) {\n\t\t\treturn location.href;\n\t\t}\n\n\t\tif (id) {\n\t\t\tid = str(id).replace(/[^\\w-:]/g);\n\n\t\t\tvar ret = url.search.match(RegExp(`[?&]${id}(?:=(.+?))?(?=$|&)`))\n\t\t\t       || url.pathname.match(RegExp(`(?:^|\\\\/)${id}\\\\/([^\\\\/]*)`));\n\t\t}\n\n\t\tif (ret === null || !id) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn decodeURIComponent(ret[1] || \"\");\n\t},\n\n\tfirst: (n, arr) => {\n\t\tif (arr === undefined) {\n\t\t\tarr = n;\n\t\t\tn = undefined;\n\t\t}\n\n\t\tif (arr === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!Array.isArray(arr)) {\n\t\t\treturn n !== undefined ? [arr] : arr;\n\t\t}\n\n\t\tif (n < 0) {\n\t\t\treturn _.last(Math.abs(n), arr);\n\t\t}\n\t\telse {\n\t\t\tvar ret = [];\n\t\t\tvar numReturn = n === undefined ? 1 : Math.floor(n);\n\n\t\t\tfor (var i = 0; i<arr.length && ret.length<numReturn; i++) {\n\t\t\t\tif (Mavo.value(arr[i]) !== null) {\n\t\t\t\t\tret.push(arr[i]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (n === undefined) {\n\t\t\t\treturn ret[0] !== undefined ? ret[0] : null;\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}\n\t},\n\tlast: (n, arr) => {\n\t\tif (arr === undefined) {\n\t\t\tarr = n;\n\t\t\tn = undefined;\n\t\t}\n\n\t\tif (arr === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!Array.isArray(arr)) {\n\t\t\treturn n !== undefined ? [arr] : arr;\n\t\t}\n\n\t\tif (n < 0) {\n\t\t\treturn _.first(Math.abs(n), arr);\n\t\t}\n\t\telse {\n\t\t\tvar ret = [];\n\t\t\tvar numReturn = n === undefined ? 1 : Math.floor(n);\n\n\t\t\tfor (var i = arr.length-1; i>=0 && ret.length<numReturn; i--) {\n\t\t\t\tif (Mavo.value(arr[i]) !== null) {\n\t\t\t\t\tret.push(arr[i]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (n === undefined) {\n\t\t\t\treturn ret[0] !== undefined ? ret[0] : null;\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}\n\t},\n\t// Get rid of empty values in array. Same as first(count(arr), arr)\n\tcondense: (arr) => {\n\t\treturn _.first(arr.length, arr);\n\t},\n\n\tunique: function(arr) {\n\t\tif (!Array.isArray(arr)) {\n\t\t\treturn arr;\n\t\t}\n\n\t\treturn [...new Set(arr.map(val))];\n\t},\n\n\t/**\n\t * Do two arrays or sets have a non-empty intersection?\n\t * @return {Boolean}\n\t */\n\tintersects: function(arr1, arr2) {\n\t\tif (arr1 && arr2) {\n\t\t\tvar set2 = new Set(Mavo.toArray(arr2).map(val));\n\t\t\tarr1 = Mavo.toArray(arr1).map(val);\n\n\t\t\treturn !arr1.every(el => !set2.has(el));\n\t\t}\n\t},\n\n\t/*********************\n\t * Number functions\n\t *********************/\n\n\t/**\n\t * Aggregate sum\n\t */\n\tsum: $.extend(function(array) {\n\t\treturn $u.numbers(array, arguments).reduce((prev, current) => {\n\t\t\treturn +prev + (+current || 0);\n\t\t}, 0);\n\t}, {\n\t\tisAggregate: true\n\t}),\n\n\t/**\n\t * Average of an array of numbers\n\t */\n\taverage: $.extend(function(array) {\n\t\tarray = $u.numbers(array, arguments);\n\t\treturn array.length && _.sum(array) / array.length;\n\t}, {\n\t\tisAggregate: true,\n\t\talias: \"avg\"\n\t}),\n\n\t/**\n\t * Median of an array of numbers\n\t */\n\tmedian: $.extend(function(array) {\n\t\tarray = $u.numbers(array, arguments).sort((a, b) => a - b);\n\t\tvar mi = (array.length - 1) / 2;\n\t\t[m1, m2] = [array[Math.floor(mi)], array[Math.ceil(mi)]];\n\t\treturn (m1 + m2) / 2 || 0;\n\t}, {\n\t\tisAggregate: true\n\t}),\n\n\t/**\n\t * Min of an array of numbers\n\t */\n\tmin: $.extend(function(array) {\n\t\treturn Math.min(...$u.numbers(array, arguments));\n\t}, {\n\t\tisAggregate: true\n\t}),\n\n\t/**\n\t * Max of an array of numbers\n\t */\n\tmax: $.extend(function(array) {\n\t\treturn Math.max(...$u.numbers(array, arguments));\n\t}, {\n\t\tisAggregate: true\n\t}),\n\n\tatan2: $.extend((dividend, divisor) => Math.atan2(dividend, divisor), {\n\t\tmultiValued: true,\n\t\trightUnary: b => b,\n\t\tdefault: 1\n\t}),\n\n\tpow: $.extend((base, exponent) => Math.pow(base, exponent), {\n\t\tmultiValued: true,\n\t\tdefault: 1\n\t}),\n\n\timul: $.extend((a, b) => Math.imul(a, b), {\n\t\tmultiValued: true,\n\t\tdefault: 1\n\t}),\n\n\tcount: $.extend(function(array) {\n\t\treturn Mavo.toArray(array).filter(a => !empty(a)).length;\n\t}, {\n\t\tisAggregate: true\n\t}),\n\n\treverse: function(array) {\n\t\treturn Mavo.toArray(array).slice().reverse();\n\t},\n\n\tround: $.extend((num, decimals) => {\n\t\tif (not(num) || not(decimals) || !isFinite(num)) {\n\t\t\treturn Math.round(num);\n\t\t}\n\n\t\treturn +(+num).toLocaleString(\"en-US\", {\n\t\t\tuseGrouping: false,\n\t\t\tmaximumFractionDigits: decimals\n\t\t});\n\t}, {\n\t\tmultiValued: true,\n\t\trightUnary: b => b,\n\t\tdefault: 0\n\t}),\n\n\tordinal: $.extend((num) => {\n\t\tif (empty(num)) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tif (num < 10 || num > 20) {\n\t\t\tvar ord = [\"th\", \"st\", \"nd\", \"rd\", \"th\"][num % 10];\n\t\t}\n\n\t\treturn ord || \"th\";\n\t}, {\n\t\tmultiValued: true,\n\t\talias: \"th\"\n\t}),\n\n\tdigits: $.extend((digits, decimals, num) => {\n\t\tif (num === undefined) {\n\t\t\tnum = decimals;\n\t\t\tdecimals = undefined;\n\t\t}\n\n\t\tif (isNaN(num)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar parts = (num + \"\").split(\".\");\n\n\t\t// If it has more digits than n = digits, only keep the last n digits.\n\t\tparts[0] = parts[0].slice(-digits);\n\n\t\t// Chop extra decimals without rounding\n\t\tif (decimals !== undefined && parts[1]) {\n\t\t\tparts[1] = parts[1].slice(0, decimals);\n\t\t}\n\n\t\tnum = +parts.join(\".\");\n\n\t\t// This is mainly for padding with zeroes, we've done the rest already\n\t\treturn num.toLocaleString(\"en\", {\n\t\t\tuseGrouping: false, // we want something that can be converted to a number again\n\t\t\tminimumIntegerDigits: digits,\n\t\t\tminimumFractionDigits: decimals,\n\t\t\tmaximumFractionDigits: decimals || 20\n\t\t});\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\tiff: function(condition, iftrue=condition, iffalse=null) {\n\t\tif (Array.isArray(condition)) {\n\t\t\treturn condition.map((c, i) => {\n\t\t\t\tvar ret = val(c)? iftrue : iffalse;\n\n\t\t\t\treturn Array.isArray(ret)? ret[Math.min(i, ret.length - 1)] : ret;\n\t\t\t});\n\t\t}\n\n\t\treturn val(condition)? iftrue : iffalse;\n\t},\n\n\tgroup: (...objects) => {\n\t\tif (objects.length === 0) {\n\t\t\treturn {};\n\t\t}\n\n\t\treturn Object.assign(...objects);\n\t},\n\tlist: (...items) => items.flat(),\n\n\t// FIXME if step=0 returns NaN\n\trandom: $.extend((min = 0, max = 100, step = 1) => {\n\t\tif (arguments.length == 1) {\n\t\t\tmax = min;\n\t\t\tmin = 0;\n\t\t}\n\n\t\tvar rand = Math.random();\n\t\tvar range = (max - min)  / step;\n\t\treturn Math.floor(rand * (range + 1)) * step + min;\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\trange: (a, b, step) => {\n\t\tif (step === undefined) {\n\t\t\tif (b === undefined) {\n\t\t\t\t[a, b] = [a >= 0? 1 : -1, a]\n\t\t\t}\n\n\t\t\tstep = a <= b? 1 : -1;\n\t\t}\n\n\t\tlet steps = Math.floor((b - a)/step + 1);\n\n\t\tif (steps <= 0 || !isFinite(steps)) {\n\t\t\treturn [a];\n\t\t}\n\n\t\tlet ret = [];\n\n\t\tfor (let i = 0, n = a; i++ < steps; n += step) {\n\t\t\tret.push(n);\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tshuffle: list => {\n\t\tif (Array.isArray(list)) {\n\t\t\t// Fisher-Yates shuffle\n\t\t\tvar ret = list.slice();\n\n\t\t\tfor (var i = ret.length - 1; i > 0; i--) {\n\t\t\t\tvar j = Math.floor(Math.random() * (i + 1));\n\t\t\t\t[ret[i], ret[j]] = [ret[j], ret[i]];\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}\n\t\telse {\n\t\t\treturn list;\n\t\t}\n\t},\n\n\t/*********************\n\t * String functions\n\t *********************/\n\n\t/**\n\t * Replace all occurences of a string with another string\n\t */\n\treplace: $.extend((haystack, needle, replacement = \"\", iterations = 1) => {\n\t\tif (Array.isArray(haystack)) {\n\t\t\treturn haystack.map(item => _.replace(item, needle, replacement));\n\t\t}\n\n\t\t// Simple string replacement\n\t\tvar needleRegex = RegExp(Mavo.escapeRegExp(needle), \"g\");\n\t\tvar ret = haystack, prev;\n\t\tvar counter = 0;\n\n\t\twhile (ret != prev && (counter++ < iterations)) {\n\t\t\tprev = ret;\n\t\t\tret = ret.replace(needleRegex, replacement);\n\t\t}\n\n\t\treturn ret;\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\tlen: $.extend(text => str(text).length, {\n\t\tmultiValued: true\n\t}),\n\n\t/**\n\t * Search if a group, collection, or primitive contains a string\n\t * @returns Boolean if a haystack AND needle of object or primitive are passed\n\t * @returns Array of booleans if either a haystack OR needle of array is passed\n\t */\n\tcontains: $.extend((haystack, needle) => {\n\t\tlet ret;\n\t\tlet haystackType = $.type(haystack);\n\n\t\tif ($.type(needle) === \"object\") {\n\t\t\treturn JSON.stringify(haystack).indexOf(JSON.stringify(needle)) >= 0;\n\t\t}\n\n\t\tif (haystackType === \"object\" || haystackType === \"array\") {\n\t\t\tfor (let property in haystack) {\n\t\t\t\tret = _.contains(haystack[property], needle);\n\n\t\t\t\tif (Array.isArray(ret)) {\n\t\t\t\t\tret = Mavo.Functions.or(ret);\n\t\t\t\t}\n\t\t\t\tif (ret) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn _.search(haystack, needle) >= 0;\n\t\t}\n\n\t\treturn ret;\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\t/**\n\t * Case insensitive search\n\t */\n\tsearch: $.extend((haystack, needle) => {\n\t\thaystack = str(haystack);\n\t\tneedle = str(needle);\n\t\treturn haystack && needle? haystack.toLowerCase().indexOf(needle.toLowerCase()) : -1;\n\t}, {\n\t\tmultiValued: true,\n\t}),\n\n\tstarts: $.extend((haystack, needle) => _.search(str(haystack), str(needle)) === 0, {\n\t\tmultiValued: true,\n\t}),\n\n\tends: $.extend((haystack, needle) => {\n\t\t[haystack, needle] = [str(haystack), str(needle)];\n\n\t\tvar i = _.search(haystack, needle);\n\t\treturn  i > -1 && i === haystack.length - needle.length;\n\t}, {\n\t\tmultiValued: true,\n\t}),\n\n\tjoin: function(array, glue) {\n\t\treturn Mavo.toArray(array).filter(a => !empty(a)).join(str(glue));\n\t},\n\n\tidify: $.extend(readable => {\n\t\treturn str(readable)\n\t\t\t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\") // Convert accented letters to ASCII\n\t\t\t.replace(/[^\\w\\s-]/g, \"\") // Remove remaining non-ASCII characters\n\t\t\t.trim().replace(/\\s+/g, \"-\") // Convert whitespace to hyphens\n\t\t\t.toLowerCase();\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\t// Convert an identifier to readable text that can be used as a label\n\treadable: $.extend(identifier => {\n\t\t// Is it camelCase?\n\t\treturn str(identifier)\n\t\t\t\t.replace(/([a-z])([A-Z])(?=[a-z])/g, ($0, $1, $2) => $1 + \" \" + $2.toLowerCase()) // camelCase?\n\t\t\t\t.replace(/([a-z0-9])[_\\/-](?=[a-z0-9])/g, \"$1 \") // Hyphen-separated / Underscore_separated?\n\t\t\t\t.replace(/^[a-z]/, $0 => $0.toUpperCase()); // Capitalize\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\tuppercase: $.extend(text => str(text).toUpperCase(), {\n\t\tmultiValued: true\n\t}),\n\tlowercase: $.extend(text => str(text).toLowerCase(), {\n\t\tmultiValued: true\n\t}),\n\n\tfrom: $.extend((haystack, needle) => _.between(haystack, needle), {\n\t\tmultiValued: true,\n\t}),\n\n\tfromlast: $.extend((haystack, needle) => _.between(haystack, needle, \"\", true), {\n\t\tmultiValued: true,\n\t}),\n\n\tto: $.extend((haystack, needle) => _.between(haystack, \"\", needle), {\n\t\tmultiValued: true,\n\t}),\n\n\ttofirst: $.extend((haystack, needle) => _.between(haystack, \"\", needle, true), {\n\t\tmultiValued: true,\n\t}),\n\n\tbetween: $.extend((haystack, from, to, tight) => {\n\t\t[haystack, from, to] = [str(haystack), str(from), str(to)];\n\n\t\tvar i1 = from? haystack[tight? \"lastIndexOf\" : \"indexOf\"](from) : -1;\n\t\tvar i2 = haystack[tight? \"indexOf\" : \"lastIndexOf\"](to);\n\n\t\tif (from && i1 === -1 || i2 === -1) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\treturn haystack.slice(i1 + 1, i2 === -1 || !to? haystack.length : i2);\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\tphrase: $.extend(function(id, vars, lang) {\n\t\tif (arguments.length === 3 && $.type(vars) === \"string\") {\n\t\t\t[lang, vars] = [vars];\n\t\t}\n\n\t\tvar locale = lang? Mavo.Locale.get(lang) : (this?.[Mavo.mavo]?.locale ?? Mavo.Locale.default);\n\n\t\treturn locale.phrase(id, vars);\n\t}, {\n\t\tneedsContext: true\n\t}),\n\n\tfilename: $.extend(url => new URL(str(url), Mavo.base).pathname.match(/[^/]+?$/)?.[0], {\n\t\tmultiValued: true\n\t}),\n\n\tjson: data => Mavo.safeToJSON(data),\n\n\tsplit: $.extend((text, separator = /\\s+/) => {\n\t\tif (!text) {\n\t\t\treturn [];\n\t\t}\n\n\t\ttext = str(text);\n\n\t\treturn text.split(separator);\n\t}, {\n\t\tmultiValued: true\n\t}),\n\n\t// Log to the console and return\n\tlog: (...args) => {\n\t\tconsole.log(...args.map(val));\n\t\treturn args[0];\n\t},\n\n\t// Other special variables (some updated via events)\n\t$mouse: {x: 0, y: 0},\n\n\tget $hash() {\n\t\treturn location.hash.slice(1);\n\t},\n\n\tget $alt() {\n\t\treturn _.$evt? _.$evt.altKey : false;\n\t},\n\n\tget $ctrl() {\n\t\treturn _.$evt? _.$evt.ctrlKey : false;\n\t},\n\n\tget $shift() {\n\t\treturn _.$evt? _.$evt.shiftKey : false;\n\t},\n\n\tget $cmd() {\n\t\treturn _.$evt? _.$evt[Mavo.superKey] : false;\n\t},\n\n\t// \"Private\" helpers\n\tutil: {\n\t\tnumbers: function(array, args) {\n\t\t\tarray = Array.isArray(array)? array : (args? $$(args) : [array]);\n\n\t\t\treturn array.filter(number => !isNaN(number) && val(number) !== \"\" && val(number) !== null).map(n => +n);\n\t\t},\n\n\t\t// Implement function metadata\n\t\tpostProcess: function(callback) {\n\t\t\tvar multiValued = callback.multiValued;\n\t\t\tvar newCallback;\n\n\t\t\tif (multiValued === true || multiValued?.length === 2) {\n\t\t\t\tnewCallback = (...args) => {\n\t\t\t\t\t// Define index of multiValued arguments\n\t\t\t\t\t// Fallback to first 2 arguments if not explicitly defined\n\t\t\t\t\tvar idxA = multiValued[0] || 0;\n\t\t\t\t\tvar idxB = multiValued[1] || 1;\n\n\t\t\t\t\treturn Mavo.Script.binaryOperation(args[idxA], args[idxB], {\n\t\t\t\t\t\tscalar: (a, b) => {\n\t\t\t\t\t\t\t// Replace multiValued argument with its individual elements\n\t\t\t\t\t\t\tif (idxA in args) {\n\t\t\t\t\t\t\t\targs[idxA] = a;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (idxB in args) {\n\t\t\t\t\t\t\t\targs[idxB] = b;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn callback(...args);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t...callback\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t}\n\t\t\telse if (callback.isAggregate) {\n\t\t\t\tnewCallback = function(array) {\n\t\t\t\t\tif (Mavo.in(Mavo.groupedBy, array)) { // grouped structures\n\t\t\t\t\t\treturn array.map(e => newCallback(e.$items));\n\t\t\t\t\t}\n\n\t\t\t\t\tvar ret = callback.call(this, ...arguments);\n\n\t\t\t\t\treturn ret === undefined? array : ret;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (newCallback) {\n\t\t\t\t// Preserve function metadata\n\t\t\t\t$.extend(newCallback, callback);\n\t\t\t\tnewCallback.original = callback;\n\t\t\t}\n\n\t\t\tif (callback.alias) {\n\t\t\t\tfor (let alias of Mavo.toArray(callback.alias)) {\n\t\t\t\t\tMavo.Functions[alias] = newCallback || callback;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn newCallback;\n\t\t}\n\t}\n};\n\nvar $u = _.util;\n\n/**\n * After plugins are loaded, enable\n * multi-valued arguments of Mavo and Math functions\n */\nMavo.ready.then(() => {\n\tObject.getOwnPropertyNames(Mavo.Functions).forEach(property => {\n\t\tvar newCallback = $u.postProcess(Mavo.Functions[property]);\n\n\t\tif (newCallback) {\n\t\t\tMavo.Functions[property] = newCallback;\n\t\t}\n\t});\n\n\t// Deal with Math functions that have 1 argument\n\tObject.getOwnPropertyNames(Math).forEach(property => {\n\t\tif (Math[property].length === 1 && !Mavo.Functions.hasOwnProperty(property)) {\n\t\t\tMavo.Functions[property] = operand => Mavo.Script.unaryOperation(operand, operand => Math[property](operand));\n\t\t}\n\t});\n});\n\n/**\n * Private helper methods\n */\n\n// Convert argument to string\nfunction str(str = \"\") {\n\tstr = val(str);\n\treturn !str && str !== 0? \"\" : str + \"\";\n}\n\nfunction empty(v) {\n\tv = Mavo.value(v);\n\treturn v === null || v === false || v === \"\";\n}\n\nfunction not(v) {\n\treturn !val(v);\n}\n\n})(Bliss, Mavo.value);\n\n/**\n * Date Functions available inside Mavo expressions\n */\n\n(function($, val, _, $u = _.util) {\n\nvar s = {seconds: 1, minutes: 60};\ns.hours  = s.minutes * 60;\ns.days   = s.hours   * 24;\ns.weeks  = s.days    * 7;\ns.months = s.days    * 30.4368;\ns.years  = s.weeks   * 52;\n\nvar numeric = {\n\tyear: d => d.getFullYear(),\n\tmonth: d => d.getMonth() + 1,\n\tday: d => d.getDate(),\n\tweekday: d => d.getDay() || 7,\n\thour: d => d.getHours(),\n\tminute: d => d.getMinutes(),\n\tsecond: d => d.getSeconds(),\n\tms: d => d.getMilliseconds()\n};\n\n$.extend(_, {\n\tget $now() {\n\t\treturn new Date();\n\t},\n\n\t$startup: new Date(), // Like $now, but doesn't update\n\n\tget $today() {\n\t\treturn _.date(new Date());\n\t},\n\n\tyear: $.extend(function() {\n\t\treturn $u.dateComponent(\"year\", ...arguments);\n\t}, {multiValued: true}),\n\n\tmonth: $.extend(function() {\n\t\treturn $u.dateComponent(\"month\", ...arguments);\n\t}, {multiValued: true}),\n\n\tweek: () => s.weeks * 1000,\n\n\tday: $.extend(function() {\n\t\treturn $u.dateComponent(\"day\", ...arguments);\n\t}, {multiValued: true}),\n\n\tweekday: $.extend(function() {\n\t\treturn $u.dateComponent(\"weekday\", ...arguments);\n\t}, {multiValued: true}),\n\n\thour: $.extend(function() {\n\t\treturn $u.dateComponent(\"hour\", ...arguments);\n\t}, {multiValued: true}),\n\n\tminute: $.extend(function() {\n\t\treturn $u.dateComponent(\"minute\", ...arguments);\n\t}, {multiValued: true}),\n\n\tsecond: $.extend(function() {\n\t\treturn $u.dateComponent(\"second\", ...arguments);\n\t}, {multiValued: true}),\n\n\tms: $.extend(function() {\n\t\treturn $u.dateComponent(\"ms\", ...arguments);\n\t}, {multiValued: true}),\n\n\tdate: $.extend(date => {\n\t\tdate = $u.date(date);\n\n\t\treturn date? `${_.year(date)}-${_.month(date, \"00\")}-${_.day(date, \"00\")}` : \"\";\n\t}, {multiValued: true}),\n\n\ttime: $.extend((date, precision = \"seconds\") => {\n\t\tdate = $u.date(date);\n\n\t\tif (!date) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tvar ret = `${_.hour(date, \"00\")}:${precision == \"hours\"? \"00\" : _.minute(date, \"00\")}`;\n\n\t\tif (precision == \"seconds\" || precision == \"ms\") {\n\t\t\tret += `:${_.second(date, \"00\")}`;\n\n\t\t\tif (precision == \"ms\") {\n\t\t\t\tret += `.${_.ms(date)}`;\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t}, {multiValued: true}),\n\n\tlocalTimezone: -(new Date()).getTimezoneOffset(),\n});\n\n_.msTo = (what, ms) => Math.floor(Math.abs(ms) / (s[what] * 1000)) || 0;\n\nfor (let unit in s) {\n\t_[unit] = $.extend(function(ms) {\n\t\tif (arguments.length === 0) {\n\t\t\treturn s[unit] * 1000;\n\t\t}\n\n\t\treturn _.msTo(unit, ms);\n\t}, {multiValued: true});\n}\n\n_.duration = $.extend(function (ms, terms) {\n\tif (ms === 0 || terms === undefined) {\n\t\tterms = 1;\n\t}\n\n\tlet timeLeft = ms || 0;\n\tlet ret = [];\n\n\tif (ms < 1) {\n\t\tret = [\"0 ms\"];\n\t}\n\telse {\n\t\tlet units = [...Object.keys(s).reverse(), \"ms\"];\n\n\t\tfor (let i=0, unit; unit = units[i]; i++) {\n\t\t\t// get largest value of time unit for the remaining\n\t\t\t// time to account for\n\t\t\tlet unitMs = unit in s? s[unit] * 1000 : 1; // number of ms in 1 unit\n\t\t\tlet unitValue = Math.floor(timeLeft / unitMs); // quotient\n\t\t\ttimeLeft = timeLeft % unitMs; // remainder\n\n\t\t\tif (unitValue > 0 && ret.length < terms) {\n\t\t\t\tlet unitProperPlurality = unitValue === 1 && unit !== \"ms\" ? unit.slice(0, -1) : unit;\n\t\t\t\tret.push(unitValue + \" \" + _.phrase.call(this, unitProperPlurality));\n\t\t\t}\n\t\t\telse if (ret.length > 0) {\n\t\t\t\t// Discard any further terms to avoid non-continous terms like e.g. \"1 month, 10 ms\"\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn arguments.length === 1 ? ret[0] : ret;\n}, {\n\tneedsContext: true,\n\tmultiValued: true\n});\n\n$.extend(_.util, {\n\tfixDateString: function(date) {\n\t\tdate = date.trim();\n\n\t\tvar hasDate = /^\\d{4}-\\d{2}(-\\d{2})?/.test(date);\n\t\tvar hasTime = date.indexOf(\":\") > -1;\n\n\t\tif (!hasDate && !hasTime) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Fix up time format\n\t\tif (!hasDate) {\n\t\t\t// No date, add today’s\n\t\t\tdate = _.$today + \" \" + date;\n\t\t}\n\t\telse {\n\t\t\t// Only year-month, add day\n\t\t\tdate = date.replace(/^(\\d{4}-\\d{2})(?!-\\d{2})/, \"$1-01\");\n\t\t}\n\n\t\tif (!hasTime) {\n\t\t\t// Add a time if one doesn't exist\n\t\t\tdate += \"T00:00:00\";\n\t\t}\n\t\telse {\n\t\t\t// Make sure time starts with T, due to Safari bug\n\t\t\tdate = date.replace(/\\-(\\d{2})\\s+(?=\\d{2}:)/, \"-$1T\");\n\t\t}\n\n\t\t// Remove all whitespace\n\t\tdate = date.replace(/\\s+/g, \"\");\n\n\t\treturn date;\n\t},\n\n\tdateComponent: function(component, date, format) {\n\t\tif (arguments.length === 1 && component + \"s\" in s) {\n\t\t\treturn _[component + \"s\"]();\n\t\t}\n\n\t\tvar dateO = $u.date(date);\n\n\t\tif (component === \"year\") {\n\t\t\t// Why +\"\"? We don't want years to be formatted like 2,017!\n\t\t\t// Why the .match()? For incomplete dates, see #226\n\t\t\tdate = date && date.match? date : date + \"\";\n\t\t\tvar ret = dateO? dateO.getFullYear() + \"\" : (date.match(/\\b[1-9]\\d\\d\\b|\\d+/) || [])[0];\n\t\t}\n\n\t\tif (!ret && !dateO) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tvar ret = ret || numeric[component](dateO);\n\n\t\tif (format) {\n\t\t\tif (/^0+$/.test(format)) {\n\t\t\t\t// Leading zeroes\n\t\t\t\treturn (ret + \"\").padStart(format.length, \"0\").slice(-format.length);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tformat = {name: \"long\", shortname: \"short\"}[format] || format;\n\t\t\t\tret = dateO.toLocaleString(Mavo.locale, {[component]: format});\n\t\t\t\tret = ret.replace(/\\u200e/g, \"\"); // Stupid Edge bug\n\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\n\t\treturn component === \"year\"? ret : +ret;\n\t},\n\n\tdate: function(date) {\n\t\tdate = val(date);\n\n\t\tif (!date) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar object = new Date(date);\n\n\t\t// Either arg is not string or is exactly the same as a re-serialization of it as a date\n\t\tif ($.type(date) !== \"string\" || !isNaN(object) && (object + \"\" == date)) {\n\t\t\treturn object;\n\t\t}\n\n\t\tdate = $u.fixDateString(date);\n\n\t\tif (date === null) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar timezone = date.match(/[+-]\\d{2}:?\\d{2}|Z$/)?.[0];\n\n\t\tif (timezone) {\n\t\t\t// parse as ISO format\n\t\t\tdate = new Date(date);\n\t\t}\n\t\telse {\n\t\t\t// construct date in local timezone\n\t\t\tvar fields = date.match(/\\d+/g);\n\n\t\t\tdate = new Date(\n\t\t\t\t// year, month, date,\n\t\t\t\tfields[0], (fields[1] || 1) - 1, fields[2] || 1,\n\t\t\t\t// hours, minutes, seconds, milliseconds,\n\t\t\t\tfields[3] || 0, fields[4] || 0, fields[5] || 0, fields[6] || 0\n\t\t\t);\n\t\t}\n\n\t\treturn isNaN(date)? null : date;\n\t}\n});\n\n})(Bliss, Mavo.value, Mavo.Functions);\n\n(function($, val, $u) {\n\nvar _ = Mavo.Script = {\n\t$fn: self.Proxy? new Proxy({[Symbol.unscopables]: {undefined: true}}, {\n\t\tget: (data, property) => {\n\t\t\tvar propertyL = property.toLowerCase(), ret;\n\n\t\t\t// Is this a data action function?\n\t\t\tif (propertyL in Mavo.Actions.Functions) {\n\t\t\t\tif (Mavo.Actions.running) {\n\t\t\t\t\tret = Mavo.Actions.Functions[propertyL];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tret = Mavo.Actions.nope;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Is this a Mavo function?\n\t\t\tif (ret === undefined) {\n\t\t\t\tif (propertyL in Mavo.Functions) {\n\t\t\t\t\tret = Mavo.Functions[propertyL];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Maybe it's a Math function?\n\t\t\t\t\tret = Math[property] || Math[propertyL];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t},\n\n\t\thas: (data, property) => {\n\t\t\tvar propertyL = property.toLowerCase();\n\n\t\t\treturn propertyL in Mavo.Functions || propertyL in Mavo.Actions.Functions\n\t\t\t\t   || property in Math || propertyL in Math;\n\t\t}\n\t}) : Mavo.Functions,\n\n\taddUnaryOperator: function(name, o) {\n\t\tif (o.symbol) {\n\t\t\t// Build map of symbols to function names for easy rewriting\n\t\t\tMavo.toArray(o.symbol).forEach(symbol => {\n\t\t\t\t_.unarySymbols[symbol] = name;\n\t\t\t\tjsep.addUnaryOp(symbol);\n\t\t\t});\n\t\t}\n\n\t\treturn operand => _.unaryOperation(operand, operand => o.scalar(val(operand)));\n\t},\n\n\tunaryOperation: function(operand, scalar) {\n\t\tif (Array.isArray(operand)) {\n\t\t\treturn operand.map(scalar);\n\t\t}\n\t\telse {\n\t\t\treturn scalar(operand);\n\t\t}\n\t},\n\n\tbinaryOperation: function(a, b, o = {}) {\n\t\to.scalar = typeof o === \"function\" ? o : o.scalar;\n\t\tvar result;\n\n\t\tif (Array.isArray(b)) {\n\t\t\tif (Array.isArray(a)) {\n\t\t\t\tresult = [];\n\t\t\t\tvar max = Math.max(a.length, b.length);\n\t\t\t\tvar leftUnary = o.leftUnary || o.unary;\n\t\t\t\tvar rightUnary = o.rightUnary || o.unary;\n\t\t\t\tvar leftDefault = o.leftDefault === undefined ? o.default : o.leftDefault;\n\t\t\t\tvar rightDefault = o.rightDefault === undefined ? o.default : o.rightDefault;\n\n\t\t\t\tfor (let i = 0; i < max; i++) {\n\t\t\t\t\tif (o.comparison && (a[i] === undefined || b[i] === undefined)) {\n\t\t\t\t\t\tresult[i] = o.default;\n\t\t\t\t\t}\n\t\t\t\t\telse if (a[i] === undefined) {\n\t\t\t\t\t\tresult[i] = rightUnary ? rightUnary(b[i]) : o.scalar(leftDefault, b[i]);\n\t\t\t\t\t}\n\t\t\t\t\telse if (b[i] === undefined) {\n\t\t\t\t\t\tresult[i] = leftUnary ? leftUnary(a[i]) : o.scalar(a[i], rightDefault);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresult[i] = o.scalar(a[i], b[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = b.map(n => o.scalar(a, n));\n\t\t\t}\n\t\t}\n\t\telse if (Array.isArray(a)) {\n\t\t\tresult = a.map(n => o.scalar(n, b));\n\t\t}\n\t\telse {\n\t\t\tresult = o.scalar(a, b);\n\t\t}\n\n\t\treturn result;\n\t},\n\n\t/**\n\t * Extend a scalar operator to arrays, or arrays and scalars\n\t * The operation between arrays is applied element-wise.\n\t * The operation operation between a scalar and an array will result in\n\t * the operation being applied between the scalar and every array element.\n\t */\n\taddBinaryOperator: function(name, o) {\n\t\tif (o.symbol) {\n\t\t\t// Build map of symbols to function names for easy rewriting\n\t\t\tMavo.toArray(o.symbol).forEach(symbol => {\n\t\t\t\t_.symbols[symbol] = name;\n\n\t\t\t\tif (o.precedence) {\n\t\t\t\t\tjsep.addBinaryOp(symbol, o.precedence);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\to.default = o.default === undefined? 0 : o.default;\n\n\t\treturn o.code || function(...operands) {\n\t\t\tif (operands.length === 1) {\n\t\t\t\tif (Array.isArray(operands[0])) {\n\t\t\t\t\t// Operand is an array of operands, expand it out\n\t\t\t\t\toperands = [...operands[0]];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!o.raw) {\n\t\t\t\toperands = operands.map(val);\n\t\t\t}\n\n\t\t\tvar prev = o.comparison ? true : operands[0], result;\n\n\t\t\tfor (let i = 1; i < operands.length; i++) {\n\t\t\t\tlet a = o.comparison? operands[i - 1] : prev;\n\t\t\t\tlet b = operands[i];\n\n\t\t\t\tif (Array.isArray(b) && typeof o.default == \"number\") {\n\t\t\t\t\tb = $u.numbers(b);\n\t\t\t\t}\n\n\t\t\t\tvar result = _.binaryOperation(a, b, o);\n\n\t\t\t\tif (o.comparison) {\n\t\t\t\t\tprev = _.binaryOperation(prev, result, _.operators[\"and\"]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tprev = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn prev;\n\t\t};\n\t},\n\n\t/**\n\t * Mapping of operator symbols (strings) to function names (strings).\n\t * Populated via addOperator() and addLogicalOperator()\n\t */\n\tsymbols: {},\n\tunarySymbols: {},\n\n\tgetOperatorName: (op, unary) => _[unary? \"unarySymbols\" : \"symbols\"][op] || op,\n\n\tisComparisonOperator: (op) => {\n\t\t// decides if op, a string, is a comparison operator like < or <=\n\t\tif (op) {\n\t\t\tlet operatorDefinition = _.operators[_.symbols[op]];\n\t\t\treturn operatorDefinition && operatorDefinition.comparison;\n\t\t}\n\t},\n\n\t// Is this variable?\n\t// E.g. foo or foo.bar is not static whereas \"foo\" or bar() is\n\tisStatic: node => {\n\t\tif (node.type === \"Identifier\") {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let property of _.childProperties) {\n\t\t\tif (node[property] && property !== \"callee\") {\n\t\t\t\tif (!_.isStatic(node[property])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Operations for elements and scalars.\n\t * Operations between arrays happen element-wise.\n\t * Operations between a scalar and an array will result in the operation being performed between the scalar and every array element.\n\t * Ordered by precedence (higher to lower)\n\t * @param scalar {Function} The operation between two scalars\n\t * @param unary/leftUnary/rightUnary Custom versions of scalar for when there is only 1 operand.\n\t * @param precedence {Number}\n\t * @param symbol {String} The operator's symbol\n\t * @param default The operation’s default/identity element. Defaults to 0.\n\t *                There are also leftDefault and rightDefault options if needed.\n\t * @param export {Boolean} Whether to add the resulting function to Mavo.Functions. It will always be available on Mavo.Script.operators[name].code anyway. Default: true\n\t * @param code {Function} The full implementation of the operator (including handling for array operands), if one prefers to provide instead of have it be generated.\n\t * @param transformation {Function}\n\t * @param postFlattenTransformation {Function}\n\t * @param raw {Boolean} If true, do not use Mavo.value() on operands\n\t */\n\toperators: {\n\t\t\"not\": {\n\t\t\tsymbol: \"!\",\n\t\t\tscalar: a => !val(a)\n\t\t},\n\t\t\"multiply\": {\n\t\t\tscalar: (a, b) => a * b,\n\t\t\tdefault: 1,\n\t\t\tsymbol: \"*\"\n\t\t},\n\t\t\"divide\": {\n\t\t\tscalar: (a, b) => a / b,\n\t\t\trightUnary: b => b,\n\t\t\tdefault: 1,\n\t\t\tsymbol: \"/\"\n\t\t},\n\t\t\"addition\": {\n\t\t\tscalar: (a, b) => {\n\t\t\t\tif (isNaN(a) || isNaN(b)) {\n\t\t\t\t\t// Handle dates\n\t\t\t\t\tvar dateA = $u.date(a), dateB = $u.date(b);\n\n\t\t\t\t\tif (dateA || dateB) {\n\t\t\t\t\t\treturn +dateA + +dateB;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn +a + +b;\n\t\t\t},\n\t\t\tsymbol: \"+\"\n\t\t},\n\t\t\"plus\": {\n\t\t\tscalar: a => +a,\n\t\t\tsymbol: \"+\"\n\t\t},\n\t\t\"subtract\": {\n\t\t\tscalar: (a, b) => {\n\t\t\t\tif (isNaN(a) || isNaN(b)) {\n\t\t\t\t\t// Handle dates\n\t\t\t\t\tvar dateA = $u.date(a), dateB = $u.date(b);\n\n\t\t\t\t\tif (dateA && dateB) {\n\t\t\t\t\t\treturn dateA - dateB;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\tsymbol: \"-\"\n\t\t},\n\t\t\"minus\": {\n\t\t\tscalar: a => -a,\n\t\t\tsymbol: \"-\"\n\t\t},\n\t\t\"mod\": {\n\t\t\tscalar: (a, b) => {\n\t\t\t\tvar ret = a % b;\n\t\t\t\tret += ret < 0? b : 0;\n\t\t\t\treturn ret;\n\t\t\t},\n\t\t\tsymbol: \"mod\",\n\t\t\tprecedence: 10\n\t\t},\n\t\t\"lte\": {\n\t\t\tcomparison: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = _.getNumericalOperands(a, b);\n\t\t\t\treturn a <= b;\n\t\t\t},\n\t\t\tdefault: false,\n\t\t\tsymbol: \"<=\"\n\t\t},\n\t\t\"lt\": {\n\t\t\tcomparison: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = _.getNumericalOperands(a, b);\n\t\t\t\treturn a < b;\n\t\t\t},\n\t\t\tdefault: false,\n\t\t\tsymbol: \"<\"\n\t\t},\n\t\t\"gte\": {\n\t\t\tcomparison: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = _.getNumericalOperands(a, b);\n\t\t\t\treturn a >= b;\n\t\t\t},\n\t\t\tdefault: false,\n\t\t\tsymbol: \">=\"\n\t\t},\n\t\t\"gt\": {\n\t\t\tcomparison: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = _.getNumericalOperands(a, b);\n\t\t\t\treturn a > b;\n\t\t\t},\n\t\t\tdefault: false,\n\t\t\tsymbol: \">\"\n\t\t},\n\t\t\"eq\": {\n\t\t\tcomparison: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\treturn a == b || Mavo.safeToJSON(a) === Mavo.safeToJSON(b);\n\t\t\t},\n\t\t\tsymbol: [\"=\", \"==\"],\n\t\t\tdefault: false,\n\t\t\tprecedence: 7 // to match other comparison operators in jsep\n\t\t},\n\t\t\"neq\": {\n\t\t\tcomparison: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\treturn a != b && Mavo.safeToJSON(a) !== Mavo.safeToJSON(b);\n\t\t\t},\n\t\t\tsymbol: [\"!=\"],\n\t\t\tdefault: true,\n\t\t\tprecedence: 7 // to match other comparison operators in jsep\n\t\t},\n\t\t\"and\": {\n\t\t\tscalar: (a, b) => a && b,\n\t\t\tdefault: false,\n\t\t\tsymbol: [\"&&\", \"and\"],\n\t\t\tprecedence: 2\n\t\t},\n\t\t\"or\": {\n\t\t\tscalar: (a, b) => a || b,\n\t\t\tdefault: false,\n\t\t\tsymbol: [\"||\", \"or\"],\n\t\t\tprecedence: 2\n\t\t},\n\t\t\"concatenate\": {\n\t\t\tsymbol: \"&\",\n\t\t\tdefault: \"\",\n\t\t\tscalar: (a, b) => \"\" + (a || \"\") + (b || \"\"),\n\t\t\tprecedence: 10\n\t\t},\n\t\t\"keyvalue\": {\n\t\t\tsymbol: \":\",\n\t\t\tcode: (...operands) => {\n\t\t\t\tvar i = operands.length - 1;\n\t\t\t\tvar value = operands[i];\n\n\t\t\t\twhile (i--) {\n\t\t\t\t\tvalue = {[operands[i]]: value};\n\t\t\t\t}\n\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\ttransformation: node => {\n\t\t\t\t// Allow unquoted property names, just like JS\n\t\t\t\tif (node.left.type == \"Identifier\") {\n\t\t\t\t\tnode.left = {\n\t\t\t\t\t\ttype: \"Literal\",\n\t\t\t\t\t\tvalue: node.left.name,\n\t\t\t\t\t\traw: JSON.stringify(node.left.name)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t},\n\t\t\tprecedence: 4\n\t\t},\n\t\t\"filter\": {\n\t\t\tsymbol: \"where\",\n\t\t\tcode: (a, ...filters) => {\n\t\t\t\tfor (let b of filters) {\n\t\t\t\t\tif (Array.isArray(a)) {\n\t\t\t\t\t\tif (Array.isArray(b)) {\n\t\t\t\t\t\t\ta = a.map((v, i) => val(b[i])? v : null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tb = val(b);\n\n\t\t\t\t\t\t\tif (typeof b === \"boolean\") {\n\t\t\t\t\t\t\t\t// foo where true/false should equal foo/null respectively\n\t\t\t\t\t\t\t\ta = b? a : a.map(v => null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// foo where 5 should equal foo where foo = 5\n\t\t\t\t\t\t\t\ta = a.map(v => v == b? v : null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ta = val(b)? a : null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn a;\n\t\t\t},\n\t\t\tprecedence: 1,\n\t\t\tpostFlattenTransformation: node => {\n\t\t\t\t// Scope all identifiers (likely properties) in the where clause to the thing we're filtering from.\n\t\t\t\t// For example, assume you have a list of people and a list of cats, both with names and ages.\n\t\t\t\t// Without this, cat where age > 3 would return nonsensical results\n\t\t\t\tvar object = node.arguments[0];\n\n\t\t\t\tfor (let i=1; i<node.arguments.length; i++) {\n\t\t\t\t\tif (!_.isStatic(node.arguments[i])) {\n\t\t\t\t\t\tnode.arguments[i] = Object.assign(_.parse(\"scope()\"), {\n\t\t\t\t\t\t\targuments: [\n\t\t\t\t\t\t\t\tobject,\n\t\t\t\t\t\t\t\tnode.arguments[i]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"range\": {\n\t\t\tsymbol: \"..\",\n\t\t\tscalar: (a, b) => Mavo.Functions.range(a, b),\n\t\t\tprecedence: 2,\n\t\t\texport: false\n\t\t},\n\t\t\"has\": {\n\t\t\tsymbol: \"in\",\n\t\t\tcode: function(needle, ...haystacks) {\n\t\t\t\tvar ret;\n\t\t\t\thaystacks.map(b => {\n\t\t\t\t\tif (Array.isArray(b)) {\n\t\t\t\t\t\tvar op =  a => {\n\t\t\t\t\t\t\t// If object, comparison will fail because references. Must serialize first.\n\t\t\t\t\t\t\tvar fn = $.type(val(a)) === \"object\"? Mavo.safeToJSON : val;\n\n\t\t\t\t\t\t\treturn b.map(fn).indexOf(fn(a)) > -1;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\telse if ($.type(b) === \"object\") {\n\t\t\t\t\t\t// Mimic JS' in operator\n\t\t\t\t\t\tvar op = a => Mavo.in(val(a), b);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar op = a => Mavo.Functions.eq(a, b);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar result = Mavo.Script.unaryOperation(needle, op);\n\t\t\t\t\tret = ret === undefined? result : Mavo.Functions.and(result, ret);\n\t\t\t\t});\n\t\t\t\treturn ret;\n\t\t\t},\n\t\t\tprecedence: 3\n\t\t},\n\t\t\"groupby\": {\n\t\t\tsymbol: \"by\",\n\t\t\tcode: (array, key) => {\n\t\t\t\tarray = Mavo.toArray(array);\n\t\t\t\tkey = Mavo.toArray(key);\n\t\t\t\tvar property = key[Mavo.as] || key[0]?.[Mavo.toNode]?.property;\n\t\t\t\tvar groups = new Mavo.BucketMap({arrays: true});\n\t\t\t\tvar ret = [];\n\t\t\t\tret[Mavo.groupedBy] = true;\n\n\t\t\t\tarray.forEach((item, i) => {\n\t\t\t\t\tlet k = i < key.length ? Mavo.value(key[i]) : null;\n\t\t\t\t\tgroups.set(k, item);\n\t\t\t\t});\n\n\t\t\t\tif (Mavo.in(Mavo.route, array)) {\n\t\t\t\t\tret[Mavo.route] = Object.assign({}, array[Mavo.route]);\n\t\t\t\t}\n\n\t\t\t\tgroups.forEach((items, value) => {\n\t\t\t\t\tvar obj = {\n\t\t\t\t\t\t$value: value,\n\t\t\t\t\t\t[property || \"$value\"]: value,\n\t\t\t\t\t\t$items: items\n\t\t\t\t\t};\n\n\t\t\t\t\tif (Mavo.in(Mavo.route, array)) {\n\t\t\t\t\t\titems[Mavo.route] = obj[Mavo.route] = Object.assign({}, array[Mavo.route]);\n\t\t\t\t\t\tobj[Mavo.route] = $.each(items[Mavo.route], (p, v) => new Set([\"$items\"]));\n\t\t\t\t\t}\n\n\t\t\t\t\tret.push(obj);\n\t\t\t\t});\n\n\t\t\t\treturn Mavo.Data.proxify(ret);\n\t\t\t},\n\t\t\tprecedence: 2\n\t\t},\n\t\t\"as\": {\n\t\t\tsymbol: \"as\",\n\t\t\tcode: (property, name) => {\n\t\t\t\tif (property !== undefined && $.type(property) === \"array\" && name !== undefined) {\n\t\t\t\t\tvar ret = property.slice();\n\n\t\t\t\t\tif (!Array.isArray(name) && name?.[Mavo.toNode]?.property !== undefined) {\n\t\t\t\t\t\tret[Mavo.as] = name?.[Mavo.toNode]?.property;\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($.type(name) === \"string\") {\n\t\t\t\t\t\tret[Mavo.as] = name;\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (name[0]?.[Mavo.toNode]?.property !== undefined) {\n\t\t\t\t\t\tret[Mavo.as] = name[0]?.[Mavo.toNode]?.property;\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn property;\n\t\t\t\t}\n\t\t\t\treturn property;\n\t\t\t},\n\t\t\tprecedence: 3\n\t\t},\n\t},\n\n\tgetNumericalOperands: function(a, b) {\n\t\tif (isNaN(a) || isNaN(b)) {\n\t\t\t// Try comparing as dates\n\t\t\tvar da = $u.date(a), db = $u.date(b);\n\n\t\t\tif (da && db) {\n\t\t\t\t// Both valid dates\n\t\t\t\treturn [da, db];\n\t\t\t}\n\t\t}\n\n\t\treturn [a, b];\n\t},\n\n\tchildProperties: [\n\t\t\"arguments\", \"callee\", // CallExpression\n\t\t\"left\", \"right\", // BinaryExpression, LogicalExpression\n\t\t\"argument\", // UnaryExpression\n\t\t\"elements\", // ArrayExpression\n\t\t\"test\", \"consequent\", \"alternate\", // ConditionalExpression\n\t\t\"object\",  \"property\", // MemberExpression\n\t\t\"body\"\n\t],\n\n\t/**\n\t * Recursively execute a callback on this node and all its children\n\t * Caveat: For CallExpression arguments, it will call callback with an array\n\t * callback needs to take care of iterating over the array\n\t */\n\twalk: function(node, callback, o = {}, property, parent) {\n\t\tif (!o.type || node.type === o.type) {\n\t\t\tvar ret = callback(node, property, parent);\n\t\t}\n\n\t\tif (!o.ignore || o.ignore.indexOf(node.type) === -1) {\n\t\t\tif (Array.isArray(node)) {\n\t\t\t\tfor (let n of node) {\n\t\t\t\t\t_.walk(n, callback, o, property, node);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_.childProperties.forEach(property => {\n\t\t\t\t\tif (node[property]) {\n\t\t\t\t\t\t_.walk(node[property], callback, o, property, node);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (ret !== undefined && parent) {\n\t\t\t// Apply transformations after walking, otherwise it may recurse infinitely\n\t\t\tparent[property] = ret;\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\t/**\n\t * These serializers transform the AST into JS\n\t */\n\tserializers: {\n\t\t\"BinaryExpression\": node => `${_.serialize(node.left, node)} ${node.operator} ${_.serialize(node.right, node)}`,\n\t\t\"UnaryExpression\": node => `${node.operator}${_.serialize(node.argument, node)}`,\n\t\t\"CallExpression\": node => {\n\t\t\tvar callee = node.callee;\n\t\t\tlet root = node.callee;\n\t\t\tlet parent = node;\n\t\t\tlet prop = \"callee\";\n\n\t\t\t// Find left-most member\n\t\t\twhile (root.type === \"MemberExpression\") {\n\t\t\t\tparent = root;\n\t\t\t\troot = root.object;\n\t\t\t\tprop = \"object\";\n\t\t\t}\n\n\t\t\tif (node.callee.type === \"MemberExpression\") {\n\t\t\t\tif (node.callee.property.type === \"Identifier\" && node.callee.property.name === \"call\") {\n\t\t\t\t\tcallee = node.callee.object;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (root.type === \"Identifier\") {\n\t\t\t\t// Clashes with native prototype methods? If so, look first in Function trap\n\t\t\t\tvar name = root.name;\n\n\t\t\t\tif (name === \"scope\") {\n\t\t\t\t\treturn _.serializeScopeCall(node.arguments);\n\t\t\t\t}\n\t\t\t\telse if (name in Mavo.Script.$fn) {\n\t\t\t\t\tparent[prop] = {\n\t\t\t\t\t\ttype: \"MemberExpression\",\n\t\t\t\t\t\tcomputed: false,\n\t\t\t\t\t\tobject: {type: \"Identifier\", name: \"$fn\"},\n\t\t\t\t\t\tproperty: root\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar nameSerialized = _.serialize(node.callee, node);\n\t\t\tvar argsSerialized = node.arguments.map(n => _.serialize(n, node));\n\t\t\treturn `${nameSerialized}(${argsSerialized.join(\", \")})`;\n\t\t},\n\t\t\"ConditionalExpression\": node => `${_.serialize(node.test, node)}? ${_.serialize(node.consequent, node)} : ${_.serialize(node.alternate, node)}`,\n\t\t\"MemberExpression\": (node, parent) => {\n\t\t\tlet n = node, pn, callee;\n\n\t\t\tdo {\n\t\t\t\tif (n.type === \"CallExpression\" && n.callee === pn) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tpn = n;\n\t\t\t} while (n = n.parent);\n\n\t\t\tif (n) { // Use plain serialization for foo.bar.baz()\n\t\t\t\tvar property = node.computed? `[${_.serialize(node.property, node)}]` : `.${node.property.name}`;\n\t\t\t\treturn `${_.serialize(node.object, node)}${property}`;\n\t\t\t}\n\n\t\t\tvar property = node.computed? _.serialize(node.property, node) : `\"${node.property.name}\"`;\n\t\t\treturn `$fn.get(${_.serialize(node.object, node)}, ${property})`;\n\t\t},\n\t\t\"ArrayExpression\": node => `[${node.elements.map(n => _.serialize(n, node)).join(\", \")}]`,\n\t\t\"Literal\": node => node.raw.replace(/\\r/g, \"\\\\r\").replace(/\\n/g, \"\\\\n\"),\n\t\t\"Identifier\": node => node.name,\n\t\t\"ThisExpression\": node => \"this\",\n\t\t\"Compound\": node => node.body.map(n => _.serialize(n, node)).join(\", \")\n\t},\n\n\t/**\n\t * These are run before the serializers and transform the expression to support MavoScript\n\t */\n\ttransformations: {\n\t\t\"BinaryExpression\": node => {\n\t\t\tlet name = _.getOperatorName(node.operator);\n\t\t\tlet def = _.operators[name];\n\n\t\t\t// Operator-specific transformations\n\t\t\tdef.transformation?.(node);\n\n\t\t\tvar nodeLeft = node;\n\t\t\tvar ret = {\n\t\t\t\ttype: \"CallExpression\",\n\t\t\t\targuments: [],\n\t\t\t\tcallee: {type: \"Identifier\", name}\n\t\t\t};\n\n\t\t\tif (def.comparison) {\n\t\t\t\t// Flatten comparison operator calls. If all comparison\n\t\t\t\t// operators are the same, flatten into one call (to maintain\n\t\t\t\t// simplicity of output):\n\t\t\t\t// 3 < 4 < 5 becomes lt(3, 4, 5).\n\t\t\t\t// Otherwise, assemble an argument list like so:\n\t\t\t\t// 3 < 4 = 5 becomes compare(3, \"lt\", 4, \"eq\", 5).\n\n\t\t\t\t// Create list of {comparison, operand} objects\n\t\t\t\tlet comparisonOperands = [];\n\t\t\t\tdo {\n\t\t\t\t\tlet operatorName = _.getOperatorName(nodeLeft.operator); // e.g. \"lt\"\n\t\t\t\t\tcomparisonOperands.unshift({\n\t\t\t\t\t\tcomparison: operatorName,\n\t\t\t\t\t\toperand: nodeLeft.right\n\t\t\t\t\t});\n\t\t\t\t\tnodeLeft = nodeLeft.left;\n\t\t\t\t} while (def.flatten !== false && _.isComparisonOperator(nodeLeft.operator));\n\n\t\t\t\t// Determine if all comparison operators are the same\n\t\t\t\tlet comparisonsHeterogeneous = false;\n\t\t\t\tfor (let i = 0; i < comparisonOperands.length - 1; i++) {\n\t\t\t\t\tif (comparisonOperands[i].comparison != comparisonOperands[i+1].comparison) {\n\t\t\t\t\t\tcomparisonsHeterogeneous = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Assemble final callee and argument list\n\t\t\t\tret.arguments.push(nodeLeft); // first operand\n\t\t\t\tif (comparisonsHeterogeneous) {\n\t\t\t\t\tret.callee.name = \"compare\";\n\t\t\t\t\tcomparisonOperands.forEach(co => {\n\t\t\t\t\t\tret.arguments.push({\n\t\t\t\t\t\t\ttype: \"Literal\",\n\t\t\t\t\t\t\tvalue: co.comparison,\n\t\t\t\t\t\t\traw: `\"${co.comparison}\"`,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tret.arguments.push(co.operand);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcomparisonOperands.forEach(co => {\n\t\t\t\t\t\tret.arguments.push(co.operand);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Flatten same operator calls\n\t\t\t\tdo {\n\t\t\t\t\tret.arguments.unshift(nodeLeft.right);\n\t\t\t\t\tnodeLeft = nodeLeft.left;\n\t\t\t\t} while (def.flatten !== false && _.getOperatorName(nodeLeft.operator) === name);\n\n\t\t\t\tret.arguments.unshift(nodeLeft);\n\t\t\t}\n\n\t\t\t// Operator-specific transformations\n\t\t\tdef.postFlattenTransformation?.(ret);\n\n\t\t\treturn ret;\n\t\t},\n\t\t\"UnaryExpression\": node => {\n\t\t\tvar name = _.getOperatorName(node.operator, true);\n\n\t\t\tif (name) {\n\t\t\t\treturn {\n\t\t\t\t\ttype: \"CallExpression\",\n\t\t\t\t\targuments: [node.argument],\n\t\t\t\t\tcallee: {type: \"Identifier\", name}\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\t\"CallExpression\": node => {\n\t\t\tif (node.callee.type == \"Identifier\") {\n\t\t\t\tif (node.callee.name == \"if\") {\n\t\t\t\t\tnode.callee.name = \"iff\";\n\n\t\t\t\t\t// Traverse data actions inside if() and rewrite them to their *if() counterpart\n\t\t\t\t\tvar condition = node.arguments[0];\n\n\t\t\t\t\tfor (let i=1; i<node.arguments.length; i++) {\n\t\t\t\t\t\tif (i == 2) {\n\t\t\t\t\t\t\t// Else, negate condition\n\t\t\t\t\t\t\tcondition = _.parse(\"not()\");\n\t\t\t\t\t\t\tcondition.arguments.push(node.arguments[0]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_.walk(node.arguments[i], n => {\n\t\t\t\t\t\t\tvar name = n.callee.name;\n\n\t\t\t\t\t\t\tif (Mavo.Actions.Functions.hasOwnProperty(name) // is a data action\n\t\t\t\t\t\t\t    && !/if$/.test(name) // and not already the *if() version of itself\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tn.callee.name += \"if\";\n\n\t\t\t\t\t\t\t\t// Add condition as first argument of *if() function\n\t\t\t\t\t\t\t\tn.arguments.unshift(condition);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {type: \"CallExpression\"});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (node.callee.name == \"delete\") {\n\t\t\t\t\tnode.callee.name = \"clear\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar def = Mavo.Functions[node.callee.name];\n\n\t\t\t\t\tif (def && def.needsContext) {\n\t\t\t\t\t\t// Rewrite to funcName.call($this, ...args)\n\t\t\t\t\t\tnode.callee = {\n\t\t\t\t\t\t\ttype: \"MemberExpression\",\n\t\t\t\t\t\t\tcomputed: false,\n\t\t\t\t\t\t\tobject: node.callee,\n\t\t\t\t\t\t\tproperty: {type: \"Identifier\", name: \"call\"}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tnode.arguments.unshift({type: \"Identifier\", name: \"$this\"});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"ThisExpression\": node => {\n\t\t\treturn {type: \"Identifier\", name: \"$this\"};\n\t\t}\n\t},\n\n\tclosest (node, type) {\n\t\tlet n = node;\n\n\t\tdo {\n\t\t\tif (n.type === type) {\n\t\t\t\treturn n;\n\t\t\t}\n\t\t} while (n = n.parent);\n\n\t\treturn null;\n\t},\n\n\tserialize: (node, parent) => {\n\t\tif (typeof node === \"string\") {\n\t\t\treturn node; // already serialized\n\t\t}\n\n\t\tif (parent) {\n\t\t\tnode.parent = parent;\n\t\t}\n\n\t\tvar ret = _.transformations[node.type]?.(node, parent);\n\n\t\tif (typeof ret == \"object\" && ret?.type) {\n\t\t\tnode = ret;\n\t\t}\n\t\telse if (ret !== undefined) {\n\t\t\treturn ret;\n\t\t}\n\n\t\treturn _.serializers[node.type](node, parent);\n\t},\n\n\trewrite: function(code, o) {\n\t\tlet ast = _.parse(code);\n\n\t\tif (o) {\n\t\t\to.ast = ast;\n\t\t}\n\n\t\treturn _.serialize(ast);\n\t},\n\n\tcompile: function(code, o) {\n\t\tif (!/\\S/.test(code)) {\n\t\t\t// If code contains only whitespace, including in particular if\n\t\t\t// code is just the empty string, treat it as an expression that\n\t\t\t// evaluates to an empty string. This is consistent with\n\t\t\t// interpreting bare words as their corresponding strings.\n\t\t\treturn () => \"\";\n\t\t}\n\n\t\tcode = _.rewrite(code, o);\n\n\t\tcode = `with (Mavo.Data.stub)\n\twith (data || {}) {\n\t\tlet $fn = Mavo.Script.$fn;\n\t\treturn (${code});\n\t}`;\n\n\t\tif (o?.actions) {\n\t\t\t// Yes this is a horrible, horrible hack and I’m truly ashamed.\n\t\t\t// If you understand the reasons and can think of a better way, be my guest!\n\t\t\tcode = `\nMavo.Actions._running = Mavo.Actions.running;\nMavo.Actions.running = true;\n${code}\nMavo.Actions.running = Mavo.Actions._running;`;\n\t\t}\n\n\t\treturn new Function(\"data\", code);\n\t},\n\n\tparse: self.jsep,\n\n\t// scope() rewriting\n\tserializeScopeCall: (args) => {\n\t\tvar withCode = `with (Mavo.Script.subScope(scope, $this) || {}) { return (${_.serialize(args[1])}); }`;\n\t\treturn `(function() {\n\tvar scope = ${_.serialize(args[0])};\n\tif (Array.isArray(scope)) {\n\t\treturn scope.map(function(scope) {\n\t\t\t${withCode}\n\t\t});\n\t}\n\n\t${withCode}\n})()`;\n\t},\n\n\t// This is used for scope() rewriting, to support $this passing through\n\tsubScope: (proxy, $this) => {\n\t\tvar unscopables = Object.keys($this).reduce((o, k) => {\n\t\t\to[k] = true;\n\t\t\treturn o;\n\t\t}, {$this: true});\n\n\t\tif (!proxy || typeof proxy !== \"object\") {\n\t\t\treturn proxy;\n\t\t}\n\n\t\treturn new Proxy(proxy, {\n\t\t\tget: (t, property, r) => {\n\t\t\t\tif (property === Symbol.unscopables) {\n\t\t\t\t\treturn unscopables;\n\t\t\t\t}\n\n\t\t\t\treturn Reflect.get(t, property, r);\n\t\t\t}\n\t\t});\n\t}\n};\n\n_.serializers.LogicalExpression = _.serializers.BinaryExpression;\n_.transformations.LogicalExpression = _.transformations.BinaryExpression;\n\nfor (let name in _.operators) {\n\tlet details = _.operators[name];\n\n\tif (details.scalar?.length < 2) {\n\t\tvar ret = _.addUnaryOperator(name, details);\n\t}\n\telse {\n\t\tvar ret = _.addBinaryOperator(name, details);\n\t}\n\n\tdetails.code = details.code || ret;\n\n\tif (ret && details.export !== false) {\n\t\tMavo.Functions[name] = ret;\n\t}\n}\n\n// Takes a list of arguments that consist of interleaved operands and strings\n// representing comparison operations, and returns the result of evaluating the\n// chained comparison.\n// e.g. compare(3, \"lt\", 4, \"lt\", 5) means 3 < 4 < 5, or (3 < 4) && (4 < 5)\nMavo.Functions.compare = function(...operands) {\n\tlet result = true;\n\n\tfor (let i = 2; i < operands.length; i += 2) {\n\t\tlet a = operands[i - 2];\n\t\tlet op = operands[i - 1];\n\t\tlet b = operands[i];\n\t\tlet term = _.binaryOperation(a, b, Mavo.Script.operators[op]);\n\t\tresult = _.binaryOperation(result, term, Mavo.Script.operators[\"and\"]);\n\t}\n\n\treturn result;\n};\n\n})(Bliss, Mavo.value, Mavo.Functions.util);\n\n(function($, $$) {\n\nMavo.attributes.push(\"mv-action\");\n\nvar _ = Mavo.Actions = {\n\tlistener: evt => {\n\t\tvar tag = evt.type === \"submit\"? \"form\" : \":not(form)\";\n\t\tvar element = evt.target.closest(tag + \"[mv-action]\");\n\n\t\tif (!element) {\n\t\t\treturn; // Not an action\n\t\t}\n\n\t\tvar node = Mavo.Node.get(element);\n\n\t\tif (node && node.editing && node.modes !== \"edit\") {\n\t\t\t// If this is a node, and being edited (and supports other modes), we don't want to have the action interfering.\n\t\t\treturn;\n\t\t}\n\n\t\tif (evt.type === \"submit\") {\n\t\t\tevt.preventDefault();\n\t\t}\n\n\t\tif (element) {\n\t\t\t_.run(element.getAttribute(\"mv-action\"), element, evt);\n\t\t}\n\t},\n\n\trun: (code, element, evt) => {\n\t\tif (code) {\n\t\t\tvar node = Mavo.Node.getClosest(element);\n\n\t\t\tif (node) {\n\t\t\t\tvar expression = new Mavo.Expression(code, {actions: true});\n\n\t\t\t\tvar previousEvt = Mavo.Functions.$evt;\n\t\t\t\tMavo.Functions.$evt = evt;\n\n\t\t\t\tvar ret = expression.eval(node.getLiveData());\n\n\t\t\t\tMavo.Functions.$evt = previousEvt;\n\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\t},\n\n\tgetNodes: ref => {\n\t\tvar node = _.getNode(ref);\n\n\t\tif (node) {\n\t\t\treturn [node];\n\t\t}\n\n\t\treturn Mavo.toArray(ref).map(n => _.getNode(n)).filter(n => n !== undefined);\n\t},\n\n\tgetNode: node => {\n\t\tif (node instanceof Mavo.Node) {\n\t\t\treturn node;\n\t\t}\n\t\telse if (node?.[Mavo.toNode]) {\n\t\t\treturn node[Mavo.toNode];\n\t\t}\n\t},\n\n\tgetCollection: ref => {\n\t\tvar collection = _.getNode(ref);\n\n\t\tif (collection instanceof Mavo.Collection) {\n\t\t\treturn collection;\n\t\t}\n\n\t\t// ref is not a collection. Either it's an item or we don't have a collection\n\t\treturn collection?.collection ?? null;\n\t},\n\n\t// Function to run instead of actions if actions are called outside mv-action\n\tnope: () => {\n\t\tvar actions = Object.keys(_.Functions).map(name => `${name}()`);\n\t\tMavo.warn(`Mavo actions (${actions}) can only be used in the mv-action attribute.`);\n\t},\n\n\tFunctions: {\n\t\t/**\n\t\t * @param data (Optional) data of new item(s)\n\t\t * @param ref Collection to add to\n\t\t * @param index {Number} index of new item(s).\n\t\t * @returns Newly added item(s)\n\t\t */\n\t\tadd: function(data, ref, index) {\n\t\t\tif (arguments.length < 3) {\n\t\t\t\tif (arguments.length <= 1) {\n\t\t\t\t\t// add(ref) signature used\n\t\t\t\t\t[data, ref] = [undefined, data];\n\t\t\t\t}\n\t\t\t\telse if (arguments.length === 2) {\n\t\t\t\t\t// Is it (data, ref) or (ref, index)?\n\t\t\t\t\t// ref might be a number, if collection of numbers!\n\t\t\t\t\tvar collection = _.getCollection(ref);\n\n\t\t\t\t\tif (!collection) {\n\t\t\t\t\t\t// No collection from ref, must be (ref, index)\n\t\t\t\t\t\tcollection = _.getCollection(data);\n\n\t\t\t\t\t\tif (collection) {\n\t\t\t\t\t\t\t// Yup, it's (ref, index)\n\t\t\t\t\t\t\t[data, ref, index] = [undefined, data, ref];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!ref) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcollection = collection || _.getCollection(ref);\n\n\t\t\tif (!collection) {\n\t\t\t\tMavo.warn(\"No collection or collection item provided to add().\", {once: false});\n\t\t\t\treturn data;\n\t\t\t}\n\n\t\t\tif (index === undefined) {\n\t\t\t\t// If there is no index and item provided instead of collection,\n\t\t\t\t// get index from collection item\n\t\t\t\tvar node = _.getNode(ref);\n\n\t\t\t\tif (node !== collection) {\n\t\t\t\t\tindex = node.index;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn (Array.isArray(data)? data : [data]).map(datum => {\n\t\t\t\tvar item = collection.add(undefined, index);\n\n\t\t\t\tif (datum !== undefined) {\n\t\t\t\t\titem.render(datum);\n\t\t\t\t}\n\n\t\t\t\tif (collection.editing) {\n\t\t\t\t\tcollection.editItem(item);\n\t\t\t\t}\n\n\t\t\t\treturn item.getLiveData();\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * @param from {Mavo.Node|Array<Mavo.Node>} one or more items to move\n\t\t * @param to where to move to, item or collection. Optional\n\t\t * @param index {Number} index. Optional\n\t\t * @returns Moved item(s)\n\t\t */\n\t\tmove: (from, to, index) => {\n\t\t\tif (!from || to === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ($.type(to) == \"number\" && !(toNode?.collection)) {\n\t\t\t\t// If to is a number and not a collection item, it's an index\n\t\t\t\t[index, to] = [to];\n\t\t\t}\n\n\t\t\tvar toNode = _.getNode(to);\n\t\t\tvar fromNodes = Mavo.toArray(from).map(_.getNode).filter(n => n?.closestCollection);\n\t\t\tvar collection = (toNode || fromNodes[0]).closestCollection;\n\n\t\t\tif (!fromNodes.length) {\n\t\t\t\tif (collection) {\n\t\t\t\t\tMavo.warn(\"First parameter of move() was not a collection or collection item, using add() instead.\", {once: false});\n\t\t\t\t\treturn _.Functions.add(from, collection, index);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tMavo.warn(\"You need to provide at least one collection or collection item for move() to have something to do.\", {once: false});\n\t\t\t\t\treturn from;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar ret = _.Functions.add(from, collection, index);\n\t\t\tMavo.Collection.delete(fromNodes, {silent: true});\n\t\t\treturn ret;\n\t\t},\n\n\t\t/**\n\t\t * @param ref Items to delete\n\t\t */\n\t\tclear: (...ref) => {\n\t\t\tif (!ref.length || !ref[0]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar nodes = _.getNodes(ref.flat());\n\t\t\tvar itemsToDelete = [];\n\n\t\t\tnodes.forEach(node => {\n\t\t\t\tif (!node) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (node instanceof Mavo.Collection) {\n\t\t\t\t\t// Clear collection\n\t\t\t\t\titemsToDelete.push(...node.children);\n\t\t\t\t}\n\t\t\t\telse if (node.collection) {\n\t\t\t\t\t// Collection item, delete\n\t\t\t\t\titemsToDelete.push(node);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Ordinary node, just clear its data\n\t\t\t\t\tnode.walk(n => {\n\t\t\t\t\t\tif (n instanceof Mavo.Primitive) {\n\t\t\t\t\t\t\tn.value = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (n !== node) {\n\t\t\t\t\t\t\t_.clear(n);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tMavo.Collection.delete(itemsToDelete);\n\n\t\t\treturn nodes.map(n => n.getLiveData());\n\t\t},\n\n\t\tclearif: (condition, ...targets) => {\n\t\t\ttargets = targets.map(t => Mavo.Functions.iff(condition, t));\n\t\t\treturn _.Functions.clear(...targets);\n\t\t},\n\n\t\t/**\n\t\t * Set node(s) to value(s)\n\t\t * If ref is a single node or a collection, render values on it\n\t\t * If ref is multiple nodes, set it to corresponding value\n\t\t * If ref is multiple nodes and values is not an array, set all nodes to values\n\t\t */\n\t\tset: (ref, values) => {\n\t\t\tif (!ref) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar node = _.getNode(ref);\n\n\t\t\tif (node) {\n\t\t\t\t// Single node, render values on it\n\t\t\t\tnode.render(values);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar wasArray = Array.isArray(ref);\n\t\t\t\tvar nodes = _.getNodes(ref);\n\n\t\t\t\tif (!nodes.length) {\n\t\t\t\t\tMavo.warn(`The first parameter of set() needs to be one or more existing properties, ${Mavo.safeToJSON(ref)} is not.`);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tMavo.Script.binaryOperation(wasArray? nodes : nodes[0], values, {\n\t\t\t\t\t\tscalar: (node, value) => {\n\t\t\t\t\t\t\treturn node ? node.render(value) : null;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn values;\n\t\t}\n\t}\n};\n\n// Create *if() versions of data actions\nfor (let name in _.Functions) {\n\tlet nameif = name + \"if\";\n\n\tif (!(nameif in _.Functions)) {\n\t\t_.Functions[nameif] = (condition, target, ...rest) => {\n\t\t\ttarget = Mavo.Functions.iff(condition, target);\n\t\t\treturn Mavo.value(condition)? _.Functions[name](target, ...rest) : null;\n\t\t};\n\t}\n}\n\n_.Functions.deleteif = _.Functions.clearif;\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Data = $.Class(class Data {\n\tconstructor(node, data) {\n\t\tthis.node = node;\n\n\t\tif (data !== undefined) {\n\t\t\tthis.data = data;\n\t\t}\n\t}\n\n\tget parent() {\n\t\tvar parent = this.node.parent;\n\t\treturn parent?.liveData ?? null;\n\t}\n\n\tget collection() {\n\t\treturn this.node.collection;\n\t}\n\n\tget key() {\n\t\treturn this._key = this.collection? this.node.index : this.node.property;\n\t}\n\n\tproxify() {\n\t\treturn _.proxify(this.data);\n\t}\n\n\tupdate() {\n\t\tif (this.node instanceof Mavo.Collection || this.node instanceof Mavo.ImplicitCollection) {\n\t\t\t// TODO eventually we should do more granular updates than this O(N) stuff\n\t\t\tthis.data.length = 0;\n\n\t\t\tfor (var i=0; i<this.node.children.length; i++) {\n\t\t\t\tthis.data[i] = this.node.children[i].liveData.data;\n\t\t\t}\n\n\t\t\tif (this.node instanceof Mavo.ImplicitCollection) {\n\t\t\t\t// Implicit collections drop nulls\n\t\t\t\tMavo.filter(this.data, data => Mavo.value(data) !== null);\n\n\t\t\t\t// Implicit collections can alternate between arrays and singletons\n\t\t\t\t// depending on which items are null\n\t\t\t\tthis.updateParent();\n\t\t\t}\n\t\t}\n\t\telse if (this.node instanceof Mavo.Primitive) {\n\t\t\tvar value = this.node.value;\n\n\t\t\tif (this.node.isDataNull({live: true})) {\n\t\t\t\tvalue = null;\n\t\t\t}\n\n\t\t\tthis.data = Mavo.objectify(value);\n\n\t\t\tif (Mavo.isPlainObject(value) || Array.isArray(value)) {\n\t\t\t\t// Object rendered on a primitive, we should traverse it and store its properties\n\t\t\t\t// Why check prototype instead of just type == \"object\"? Because instances of ES6 classes also return \"object\"\n\t\t\t\t_.computeRoutes(this.data);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_.computeMetadata(this.data, this.key, this.parent);\n\t\t\t}\n\n\t\t\tthis.updateParent();\n\t\t}\n\t}\n\n\tupdateParent() {\n\t\tif (!this.parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.node instanceof Mavo.ImplicitCollection) {\n\t\t\t// Is implicit collection\n\t\t\t// See https://github.com/LeaVerou/mavo/issues/50#issuecomment-266079652\n\t\t\tvar data = this.data.length === 1? this.data[0] : this.data;\n\t\t\tthis.parent.set(this.node.property, data, true);\n\t\t}\n\t\telse if (this.collection instanceof Mavo.ImplicitCollection) {\n\t\t\t// Is implicit collection *Item*\n\t\t\tthis.parent.update();\n\t\t}\n\t\telse {\n\t\t\tvar key = this.key, isDeleted = false;\n\n\t\t\tif (this.collection instanceof Mavo.Collection) {\n\t\t\t\t// Is collection item, check if deleted\n\t\t\t\tisDeleted = this.collection.children[this.node.index] !== this.node;\n\t\t\t}\n\n\t\t\tif (key !== undefined && !isDeleted) {\n\t\t\t\tthis.parent.set(key, this.data, true);\n\t\t\t}\n\t\t}\n\t}\n\n\tset(property, value, shallow) {\n\t\tthis.data[property] = value;\n\t\t_[\"computeRoute\" + (shallow? \"\" : \"s\")](value, property, this.data);\n\t}\n\n\tupdateKey() {\n\t\tvar oldKey = this._key;\n\n\t\tif (this.parent[oldKey] === this.data) {\n\t\t\tdelete this.parent[oldKey];\n\t\t}\n\n\t\tthis.updateParent();\n\t}\n\n\tresolve(property) {\n\t\treturn _.resolve(property, this.data);\n\t}\n}, {\n\tlive: {\n\t\tdata: function(data) {\n\t\t\tif (data !== this._data) {\n\t\t\t\tthis.isArray = Array.isArray(data);\n\n\t\t\t\tthis._data = data;\n\n\t\t\t\tdata[Mavo.toNode] = this.node;\n\t\t\t\tdata[Mavo.parent] = this.parent?.data;\n\t\t\t\tdata[Mavo.mavo] = this.node.mavo;\n\n\t\t\t\tthis.proxy = this.proxify();\n\n\t\t\t\tthis.updateParent();\n\n\t\t\t\treturn this._data;\n\t\t\t}\n\t\t}\n\t},\n\n\tstatic: {\n\t\t// The context for expression evaluation\n\t\tstub: self.Proxy? new Proxy({[Symbol.unscopables]: {data: true, undefined: true}}, {\n\t\t\tget: (data, property) => {\n\t\t\t\tvar ret = Reflect.get(data, property);\n\n\t\t\t\tif (ret !== undefined || typeof property !== \"string\") {\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tvar propertyL = property.toLowerCase();\n\n\t\t\t\tif (propertyL[0] === \"$\" && propertyL in Mavo.Functions) {\n\t\t\t\t\t// Non-data $specialProperty\n\t\t\t\t\treturn Mavo.Functions[propertyL];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar propertyU = property.toUpperCase();\n\t\t\t\t\tif (propertyU in Math) {\n\t\t\t\t\t\t// Math constants\n\t\t\t\t\t\treturn Math[propertyU];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Still not found? Maybe it's a global\n\t\t\t\tif (typeof window !== \"undefined\" && window.hasOwnProperty(property)) {\n\t\t\t\t\t// hasOwnProperty to avoid elements with ids clobbering globals\n\t\t\t\t\treturn window[property];\n\t\t\t\t}\n\n\t\t\t\t// Still not found? Maybe it's a special property used without a $ (see #343)\n\t\t\t\tif (property[0] !== \"$\") {\n\t\t\t\t\tvar $property = \"$\" + property.toLowerCase();\n\n\t\t\t\t\tif ($property in Mavo.Functions) {\n\t\t\t\t\t\treturn Mavo.Functions[$property];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Prevent undefined at all costs\n\t\t\t\treturn property;\n\t\t\t},\n\t\t\thas: (data, property) => {\n\t\t\t\treturn Reflect.has(data, property) || typeof property === \"string\";\n\t\t\t}\n\t\t}) : Mavo.Functions,\n\n\t\tisItem (data) {\n\t\t\treturn Array.isArray(data?.[Mavo.parent]);\n\t\t},\n\n\t\tclosest (obj, test) {\n\t\t\tvar path = [];\n\t\t\tdo {\n\t\t\t\tif (test(obj)) {\n\t\t\t\t\treturn {value: obj, path};\n\t\t\t\t}\n\n\t\t\t\tpath.push(obj[Mavo.property]);\n\t\t\t} while (obj = obj[Mavo.parent]);\n\n\t\t\treturn {value: null, path};\n\t\t},\n\n\t\troot (obj) {\n\t\t\treturn _.closest(obj, o => !o[Mavo.parent]);\n\t\t},\n\n\t\tclosestItem (obj) {\n\t\t\treturn _.closest(obj, _.isItem);\n\t\t},\n\n\t\tclosestArray(obj) {\n\t\t\treturn _.closest(obj, Array.isArray);\n\t\t},\n\n\t\tgetProperty (data) {\n\t\t\tvar ret = _.isItem(data)? data[Mavo.parent] : data;\n\n\t\t\treturn ret[Mavo.property];\n\t\t},\n\n\t\tfind (property, data, o = {}) {\n\t\t\tif (!data || o.exclude === data) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Mavo.in(property, data) && o.exclude !== data[property]) {\n\t\t\t\treturn data[property];\n\t\t\t}\n\n\t\t\tif (!data[Mavo.route] || !Mavo.in(property, data[Mavo.route])) {\n\t\t\t\tif (data[Mavo.property] === property) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\tif (_.isItem(data) && _.getProperty(data) === property) {\n\t\t\t\t\t// Inside collection items we want their property name\n\t\t\t\t\t// to return the current item, not the entire collection\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\tif (Array.isArray(data)) {\n\t\t\t\t\t// Perhaps it's an array of nodes, such as the one created with deep references?\n\t\t\t\t\tvar ret = data.map(a => _.find(property, a))\n\t\t\t\t\t              .filter(x => x !== undefined);\n\n\t\t\t\t\tif (ret.length) {\n\t\t\t\t\t\treturn ret.flat();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar results = [], returnArray = Array.isArray(data), ret;\n\n\t\t\tresults[Mavo.route] = {};\n\t\t\tresults[Mavo.mavo] = data[Mavo.mavo];\n\n\t\t\tvar findDown = prop => {\n\t\t\t\tvar ret = _.find(property, data[prop], o);\n\n\t\t\t\tif (ret !== undefined) {\n\t\t\t\t\t// FIXME How do we set a sensible Mavo.route when the returned array is empty?\n\t\t\t\t\t// E.g. because we were pointing to inner elements of a collection that currently has no items.\n\t\t\t\t\tif (Mavo.in(Mavo.route, ret)) {\n\t\t\t\t\t\tfor (var p in ret[Mavo.route]) {\n\t\t\t\t\t\t\tresults[Mavo.route][p] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Array.isArray(ret)) {\n\t\t\t\t\t\tresults.push(...ret);\n\t\t\t\t\t\treturnArray = true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresults.push(ret);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (Array.isArray(data) || data[Mavo.route][property] === true) {\n\t\t\t\tfor (var prop in data) {\n\t\t\t\t\tfindDown(prop);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdata[Mavo.route][property].forEach(findDown);\n\t\t\t}\n\n\t\t\treturn returnArray || results.length > 1? results : results[0];\n\t\t},\n\n\t\t// First look in descendants, then ancestors and their descendants\n\t\t// one level up at a time (excluding the subtree we've already explored)\n\t\tfindUp (property, data) {\n\t\t\tvar parent = data;\n\t\t\tvar child;\n\n\t\t\tdo {\n\t\t\t\tvar ret = _.find(property, parent, {exclude: child});\n\n\t\t\t\tif (ret !== undefined) {\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tif (_.getProperty(parent) === property) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\n\t\t\t\tchild = parent;\n\t\t\t\tparent = parent[Mavo.parent];\n\t\t\t} while (parent);\n\t\t},\n\n\t\tresolve (property, data) {\n\t\t\tif (property === Mavo.isProxy) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (typeof property === \"symbol\") {\n\t\t\t\t// We can't do much for symbols\n\t\t\t\treturn data[property];\n\t\t\t}\n\n\t\t\tvar ret;\n\t\t\tvar propertyIsNumeric = !isNaN(property);\n\n\t\t\tif (property in data) {\n\t\t\t\tret = data[property];\n\t\t\t}\n\t\t\telse if (!propertyIsNumeric) {\n\t\t\t\t// Property does not exist on data, if non-numeric, look for it elsewhere\n\t\t\t\tif (property in _.special) { // $special properties\n\t\t\t\t\tret = _.special[property](data);\n\t\t\t\t}\n\t\t\t\telse if (data[Mavo.mavo]) {\n\t\t\t\t\tvar all = data[Mavo.mavo].root.liveData.data[Mavo.route];\n\n\t\t\t\t\tif (Mavo.in(property, all)) {\n\t\t\t\t\t\tret = _.findUp(property, data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (Mavo.in(Mavo.route, data) && Mavo.in(property, data[Mavo.route])) {\n\t\t\t\t\tret = _.find(property, data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!propertyIsNumeric) {\n\t\t\t\tvar propertyL = property.toLowerCase();\n\t\t\t}\n\n\t\t\tif (ret !== undefined) {\n\t\t\t\t// Should we proxify value before returning it? Is it data?\n\t\t\t\tvar proxify = ret !== null && typeof ret === \"object\" // Can be a proxy\n\t\t\t\t              && (Mavo.route in ret || Mavo.toNode in ret); // Either has a route or comes from a node\n\n\t\t\t\treturn !proxify? ret : _.proxify(ret);\n\t\t\t}\n\n\t\t\tif (!propertyIsNumeric) {\n\t\t\t\t// Does it reference another Mavo?\n\t\t\t\tif (isNaN(property) && Mavo.all?.[property]?.root) {\n\t\t\t\t\treturn Mavo.all[property].root.getLiveData();\n\t\t\t\t}\n\n\t\t\t\t// Still not found? Maybe it's a special property used without a $ (see #343)\n\t\t\t\tif (property[0] !== \"$\") {\n\t\t\t\t\tvar $property = \"$\" + propertyL;\n\n\t\t\t\t\tif ($property in _.special) {\n\t\t\t\t\t\treturn _.resolve($property, data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\thas (property, data) {\n\t\t\t// We don't care about priority here, just whether they exist\n\t\t\t// so we'll make the fastest searches first.\n\t\t\tif (property === Mavo.isProxy) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (typeof property !== \"string\") {\n\t\t\t\treturn Reflect.has(data, property);\n\t\t\t}\n\n\t\t\tvar objects = [data, Mavo.all, _.special];\n\n\t\t\tif (objects.some(obj => property in obj)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (typeof property === \"string\") {\n\t\t\t\tvar propertyL = property.toLowerCase();\n\n\t\t\t\tif (propertyL !== property && objects.some(obj => propertyL in obj)) {\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tif (propertyL[0] !== \"$\" && \"$\" + propertyL in _.special) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Slowest search last: Is the property present anywhere in the data?\n\t\t\tif (data[Mavo.mavo]) {\n\t\t\t\treturn Mavo.in(property, data[Mavo.mavo].root.liveData.data[Mavo.route]);\n\t\t\t}\n\t\t},\n\n\t\tproxify (data) {\n\t\t\tif (!data || typeof data !== \"object\" || !self.Proxy || data[Mavo.isProxy]) {\n\t\t\t\t// Data is a primitive, proxies are not supported, or is already a proxy\n\t\t\t\treturn data;\n\t\t\t}\n\n\t\t\treturn new Proxy(data, {\n\t\t\t\tget: (data, property, proxy) => {\n\t\t\t\t\treturn _.resolve(property, data);\n\t\t\t\t},\n\n\t\t\t\thas: (data, property) => {\n\t\t\t\t\treturn _.has(property, data);\n\t\t\t\t},\n\n\t\t\t\tset: function(data, property = \"\", value) {\n\t\t\t\t\tif (typeof property !== \"symbol\") {\n\t\t\t\t\t\tMavo.warn(`You cannot set data via expressions. Attempt to set ${property.toString()} to ${value} ignored.`);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Reflect.set(data, property, value);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tcomputeMetadata (object, property, parent) {\n\t\t\tif (object && typeof object === \"object\") { // not primitive\n\t\t\t\tif (property !== undefined) {\n\t\t\t\t\tobject[Mavo.property] = property;\n\t\t\t\t}\n\n\t\t\t\tif (parent && !object[Mavo.parent]) {\n\t\t\t\t\tobject[Mavo.parent] = parent;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tcomputeRoute (object, property, parent) {\n\t\t\tif (typeof object === \"function\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_.computeMetadata(object, property, parent);\n\n\t\t\tif (Mavo.isPlainObject(object) === Object.prototype || Array.isArray(object)) {\n\t\t\t\tif (!object[Mavo.route]) {\n\t\t\t\t\tobject[Mavo.route] = {};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ($.type(property) !== \"number\") {\n\t\t\t\tvar child = object;\n\n\t\t\t\twhile (parent) {\n\t\t\t\t\tif (!parent[Mavo.route]) {\n\t\t\t\t\t\tparent[Mavo.route] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// parent[up] = child\n\t\t\t\t\tvar up = child?.[Mavo.property];\n\n\t\t\t\t\tif (up && parent[Mavo.route][property] !== true) {\n\t\t\t\t\t\tif (!parent[Mavo.route][property]) {\n\t\t\t\t\t\t\tparent[Mavo.route][property] = new Set();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (parent[Mavo.route][property].has(up)) {\n\t\t\t\t\t\t\t// We've already computed routes on this subtree\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparent[Mavo.route][property].add(up);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tparent[Mavo.route][property] = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tchild = parent;\n\t\t\t\t\tparent = parent[Mavo.parent];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tcomputeRoutes (object, property, parent) {\n\t\t\t_.traverse(_.computeRoute, object, property, parent);\n\t\t},\n\n\t\t// Recursively traverse a JSON structure\n\t\t// Warning: No cycle detection. Will loop infinitely if there are cycles\n\t\ttraverseDown (callback, object, property, parent) {\n\t\t\tif (Array.isArray(object)) {\n\t\t\t\tobject.forEach((item, i) => _.traverse(callback, item, i, object));\n\t\t\t}\n\t\t\telse if ($.type(object) === \"object\") {\n\t\t\t\tfor (var prop in object) {\n\t\t\t\t\t_.traverse(callback, object[prop], prop, object);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttraverse (callback, object, property, parent) {\n\t\t\tcallback(object, property, parent);\n\t\t\t_.traverseDown(callback, object, property, parent);\n\t\t},\n\n\t\tspecial: {\n\t\t\t$index: function(obj) {\n\t\t\t\tvar closestItem = _.closestItem(obj).value;\n\n\t\t\t\tif (!closestItem) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tvar property = closestItem[Mavo.property];\n\n\t\t\t\tif (isNaN(property)) {\n\t\t\t\t\t// Is an array item but its property is not a number! Search the array.\n\t\t\t\t\t// This happens with Implicit Collections of only 1 item.\n\t\t\t\t\treturn closestItem[Mavo.parent].indexOf(closestItem);\n\t\t\t\t}\n\n\t\t\t\treturn property;\n\t\t\t},\n\n\t\t\t$item: function(obj) {\n\t\t\t\treturn _.closestItem(obj).value;\n\t\t\t},\n\n\t\t\t$all: function(obj) {\n\t\t\t\tvar arr = _.closestArray(obj);\n\t\t\t\tvar path = arr.path.reverse().slice(1); // Drop index\n\t\t\t\tvar ret = arr.value.map(a => $.value(a, ...path));\n\n\t\t\t\tif (ret.length > 0 && ret?.[0]?.[Mavo.route]) {\n\t\t\t\t\tret[Mavo.route] = $.each(ret[0][Mavo.route], (p, v) => true);\n\t\t\t\t\tret[Mavo.mavo] = ret[0][Mavo.mavo];\n\t\t\t\t}\n\n\t\t\t\treturn ret;\n\t\t\t},\n\n\t\t\t$next: function(obj) {\n\t\t\t\tvar arr = _.closestArray(obj);\n\t\t\t\tvar path = arr.path.reverse();\n\t\t\t\tvar index = arr.path[0];\n\t\t\t\tpath = path.slice(1);\n\t\t\t\tvar nextClosestItem = arr.value?.[index + 1];\n\n\t\t\t\treturn nextClosestItem? $.value(nextClosestItem, ...path) : null;\n\t\t\t},\n\n\t\t\t$previous: function(obj) {\n\t\t\t\tvar arr = _.closestArray(obj);\n\t\t\t\tvar path = arr.path.reverse();\n\t\t\t\tvar index = arr.path[0];\n\t\t\t\tpath = path.slice(1);\n\t\t\t\tvar prevClosestItem = arr.value?.[index - 1];\n\n\t\t\t\treturn prevClosestItem? $.value(prevClosestItem, ...path) : null;\n\t\t\t},\n\n\t\t\t$this: function(obj) {\n\t\t\t\treturn obj;\n\t\t\t}\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nvar _ = Mavo.Backend.register($.Class({\n\textends: Mavo.Backend,\n\tid: \"Dropbox\",\n\tconstructor: function() {\n\t\tthis.permissions.on([\"login\", \"read\"]);\n\n\t\tthis.login(true);\n\t},\n\n\tupdate: function(url, o) {\n\t\tthis.super.update.call(this, url, o);\n\n\t\tthis.url = _.fixShareURL(this.url);\n\t},\n\n\tasync upload (file, path) {\n\t\tpath = this.path.replace(/[^/]+$/, \"\") + path;\n\n\t\tawait this.put(file, path);\n\t\treturn this.getURL(path);\n\t},\n\n\tasync getURL (path) {\n\t\tlet shareInfo = await this.request(\"sharing/create_shared_link_with_settings\", {path}, \"POST\");\n\t\treturn _.fixShareURL(shareInfo.url);\n\t},\n\n\t/**\n\t * Saves a file to the backend.\n\t * @param {Object} file - An object with name & data keys\n\t * @return {Promise} A promise that resolves when the file is saved.\n\t */\n\tput (serialized, path = this.path, o = {}) {\n\t\treturn this.request(\"https://content.dropboxapi.com/2/files/upload\", serialized, \"POST\", {\n\t\t\theaders: {\n\t\t\t\t\"Dropbox-API-Arg\": JSON.stringify({\n\t\t\t\t\tpath,\n\t\t\t\t\tmode: \"overwrite\"\n\t\t\t\t}),\n\t\t\t\t\"Content-Type\": \"application/octet-stream\"\n\t\t\t}\n\t\t});\n\t},\n\n\toAuthParams: () => `&redirect_uri=${encodeURIComponent(\"https://auth.mavo.io\")}&response_type=code`,\n\n\tasync getUser () {\n\t\tif (this.user) {\n\t\t\treturn this.user;\n\t\t}\n\n\t\tlet info = await this.request(\"users/get_current_account\", \"null\", \"POST\");\n\n\t\tthis.user = {\n\t\t\tusername: info.email,\n\t\t\tname: info.name.display_name,\n\t\t\tavatar: info.profile_photo_url,\n\t\t\tinfo\n\t\t};\n\n\t\t$.fire(this.mavo.element, \"mv-login\", { backend: this });\n\t},\n\n\tasync login (passive) {\n\t\tawait this.oAuthenticate(passive);\n\t\tawait this.getUser();\n\n\t\tif (this.user) {\n\t\t\tthis.permissions.logout = true;\n\n\t\t\t// Check if can actually edit the file\n\t\t\tlet info = await this.request(\"sharing/get_shared_link_metadata\", {\n\t\t\t\t\"url\": this.source\n\t\t\t}, \"POST\");\n\n\t\t\tthis.path = info.path_lower;\n\t\t\tthis.permissions.on([\"edit\", \"save\"]);\n\t\t}\n\t},\n\n\tlogout: function() {\n\t\treturn this.oAuthLogout();\n\t},\n\n\tstatic: {\n\t\tapiDomain: \"https://api.dropboxapi.com/2/\",\n\t\toAuth: \"https://www.dropbox.com/oauth2/authorize\",\n\t\tkey: \"2mx6061p054bpbp\",\n\n\t\ttest: function(url) {\n\t\t\turl = new URL(url, Mavo.base);\n\t\t\treturn /dropbox.com/.test(url.host);\n\t\t},\n\n\t\t// Transform the dropbox shared URL into something raw and CORS-enabled\n\t\tfixShareURL: url => {\n\t\t\turl = new URL(url, Mavo.base);\n\t\t\turl.hostname = \"dl.dropboxusercontent.com\";\n\t\t\turl.search = url.search.replace(/\\bdl=0|^$/, \"raw=1\");\n\t\t\treturn url;\n\t\t}\n\t}\n}));\n\n})(Bliss, Bliss.$);\n\n(function($, $$) {\n\nlet _ = Mavo.Backend.register($.Class({\n\textends: Mavo.Backend,\n\tid: \"Github\",\n\tconstructor: function(url, o) {\n\t\tthis.permissions.on([\"login\", \"read\"]);\n\n\t\tthis.login(true);\n\t},\n\n\tupdate: function(url, o) {\n\t\tthis.super.update.call(this, url, o);\n\n\t\t// Extract info for username, repo, branch, filepath from URL\n\t\tlet extension = this.format.constructor.extensions[0] || \".json\";\n\n\t\tthis.defaults = {\n\t\t\trepo: \"mv-data\",\n\t\t\tfilename: `${this.mavo.id}${extension}`\n\t\t};\n\n\t\tthis.info = _.parseURL(this.source, this.defaults);\n\n\t\t// If an author provided backend metadata, use them\n\t\t// since they have higher priority\n\t\tfor (const prop in o) {\n\t\t\t// Skip the format and mavo properties\n\t\t\t// since they are already updated in the parent's update method\n\t\t\tif ([\"format\", \"mavo\"].includes(prop)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.info.apiCall === \"graphql\" && prop === \"query\") {\n\t\t\t\t// It makes sense to set/update the apiData property only for calls with GraphQL.\n\t\t\t\t// Otherwise, it will break the Github#get method.\n\t\t\t\tthis.info.apiData = { query: o.query };\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.info[prop] = o[prop];\n\t\t}\n\n\t\t$.extend(this, this.info);\n\t},\n\n\tget: async function(url) {\n\t\tif (this.isAuthenticated() || !this.path || url) {\n\t\t\t// Authenticated or raw API call\n\t\t\tlet info = url? _.parseURL(url) : this.info;\n\n\t\t\tif (info.apiData) {\n\t\t\t\t// GraphQL\n\t\t\t\treturn this.request(info.apiCall, info.apiData, \"POST\")\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tif (response.errors?.length) {\n\t\t\t\t\t\t\treturn Promise.reject(response.errors.map(x => x.message).join(\"\\n\"));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn response.data;\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.request(info.apiCall, {ref:this.branch}, \"GET\", {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Accept\": \"application/vnd.github.squirrel-girl-preview\"\n\t\t\t\t\t}\n\t\t\t\t}).then(response => Promise.resolve(info.repo && response.content? _.atob(response.content) : response));\n\t\t}\n\t\telse {\n\t\t\t// Unauthenticated, use simple GET request to avoid rate limit\n\t\t\turl = new URL(`https://raw.githubusercontent.com/${this.username}/${this.repo}/${this.branch || \"main\"}/${this.path}`);\n\t\t\turl.searchParams.set(\"timestamp\", Date.now()); // ensure fresh copy\n\n\t\t\ttry {\n\t\t\t\tlet xhr = await $.fetch(url.href);\n\t\t\t\tthis.branch = this.branch || \"main\";\n\t\t\t\treturn xhr.responseText;\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tif (e.status === 404 && !this.branch) {\n\t\t\t\t\t// Possibly using older default branch \"master\", try again and store branch name\n\t\t\t\t\turl.pathname = `/${this.username}/${this.repo}/master/${this.path}`;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlet xhr = await $.fetch(url.href);\n\t\t\t\t\t\tthis.branch = \"master\";\n\t\t\t\t\t\treturn xhr.responseText;\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t},\n\n\tupload: function(file, path = this.path) {\n\t\treturn Mavo.readFile(file).then(dataURL => {\n\t\t\t\tlet base64 = dataURL.slice(5); // remove data:\n\t\t\t\tlet media = base64.match(/^\\w+\\/[\\w+]+/)[0];\n\t\t\t\tmedia = media.replace(\"+\", \"\\\\+\"); // Fix for #608\n\t\t\t\tbase64 = base64.replace(RegExp(`^${media}(;base64)?,`), \"\");\n\t\t\t\tpath = this.path.replace(/[^/]+$/, \"\") + path; // make upload path relative to existing path\n\n\t\t\t\treturn this.put(base64, path, {isEncoded: true});\n\t\t\t})\n\t\t\t.then(fileInfo => this.getURL(path, fileInfo.commit.sha));\n\t},\n\n\t/**\n\t * Saves a file to the backend.\n\t * @param {String} serialized - Serialized data\n\t * @param {String} path - Optional file path\n\t * @return {Promise} A promise that resolves when the file is saved.\n\t */\n\tput: function(serialized, path = this.path, o = {}) {\n\t\tif (!path) {\n\t\t\t// Raw API calls are read-only for now\n\t\t\treturn;\n\t\t}\n\n\t\tlet repoCall = `repos/${this.username}/${this.repo}`;\n\t\tlet fileCall = `${repoCall}/contents/${path}`;\n\t\tlet commitPrefix = this.mavo.element.getAttribute(\"mv-github-commit-prefix\") || \"\";\n\n\t\t// Create repo if it doesn’t exist\n\t\tlet repoInfo = this.repoInfo?\n\t\t               Promise.resolve(this.repoInfo)\n\t\t             : this.request(\"user/repos\", {name: this.repo}, \"POST\").then(repoInfo => this.repoInfo = repoInfo);\n\n\t\tserialized = o.isEncoded? serialized : _.btoa(serialized);\n\n\t\treturn repoInfo.then(repoInfo => {\n\t\t\t\tif (!this.canPush()) {\n\t\t\t\t\t// Does not have permission to commit, create a fork\n\t\t\t\t\treturn this.request(`${repoCall}/forks`, {name: this.repo}, \"POST\")\n\t\t\t\t\t\t.then(forkInfo => {\n\t\t\t\t\t\t\tfileCall = `repos/${forkInfo.full_name}/contents/${path}`;\n\t\t\t\t\t\t\treturn this.forkInfo = forkInfo;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(forkInfo => {\n\t\t\t\t\t\t\t// Ensure that fork is created (they take a while)\n\t\t\t\t\t\t\tlet timeout;\n\t\t\t\t\t\t\tlet test = (resolve, reject) => {\n\t\t\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\t\t\tthis.request(`repos/${forkInfo.full_name}/commits`, {until: \"1970-01-01T00:00:00Z\"}, \"HEAD\")\n\t\t\t\t\t\t\t\t\t.then(x => {\n\t\t\t\t\t\t\t\t\t\tresolve(forkInfo);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(x => {\n\t\t\t\t\t\t\t\t\t\t// Try again after 1 second\n\t\t\t\t\t\t\t\t\t\ttimeout = setTimeout(test, 1000);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\treturn new Promise(test);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn repoInfo;\n\t\t\t})\n\t\t\t.then(repoInfo => {\n\t\t\t\treturn this.request(fileCall, {\n\t\t\t\t\tref: this.branch\n\t\t\t\t}).then(fileInfo => this.request(fileCall, {\n\t\t\t\t\tmessage: commitPrefix + this.mavo._(\"gh-updated-file\", {name: fileInfo.name || \"file\"}),\n\t\t\t\t\tcontent: serialized,\n\t\t\t\t\tbranch: this.branch,\n\t\t\t\t\tsha: fileInfo.sha\n\t\t\t\t}, \"PUT\"), xhr => {\n\t\t\t\t\tif (xhr.status == 404) {\n\t\t\t\t\t\t// File does not exist, create it\n\t\t\t\t\t\treturn this.request(fileCall, {\n\t\t\t\t\t\t\tmessage: commitPrefix + \"Created file\",\n\t\t\t\t\t\t\tcontent: serialized,\n\t\t\t\t\t\t\tbranch: this.branch\n\t\t\t\t\t\t}, \"PUT\");\n\t\t\t\t\t}\n\n\t\t\t\t\treturn xhr;\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then(fileInfo => {\n\t\t\t\tconst env = {context: this, fileInfo};\n\n\t\t\t\tMavo.hooks.run(\"gh-after-commit\", env);\n\n\t\t\t\treturn env.fileInfo;\n\t\t\t});\n\t},\n\n\tlogin: function(passive) {\n\t\treturn this.oAuthenticate(passive)\n\t\t\t.then(() => this.getUser())\n\t\t\t.catch(xhr => {\n\t\t\t\tif (xhr.status == 401) {\n\t\t\t\t\t// Unauthorized. Access token we have is invalid, discard it\n\t\t\t\t\tthis.logout();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(u => {\n\t\t\t\tif (this.user) {\n\n\t\t\t\t\tthis.permissions.on(\"logout\");\n\n\t\t\t\t\tif (this.info.path) {\n\t\t\t\t\t\tthis.permissions.on([\"edit\", \"save\"]);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.repo) {\n\t\t\t\t\t\treturn this.request(`repos/${this.username}/${this.repo}`)\n\t\t\t\t\t\t.then(repoInfo => {\n\t\t\t\t\t\t\tif (this.branch === undefined) {\n\t\t\t\t\t\t\t\tthis.branch = repoInfo.default_branch;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.repoInfo = repoInfo;\n\n\t\t\t\t\t\t\tif (!this.mavo.source) { // if url doesn't have source, check for forks\n\t\t\t\t\t\t\t\tif (!this.canPush()) { // Check if current user has a fork of this repo, and display dialog to switch\n\t\t\t\t\t\t\t\t\tif (this.user.info.public_repos < repoInfo.forks) { // graphql search of current user's forks\n\t\t\t\t\t\t\t\t\t\tlet query = `query {\n\t\t\t\t\t\t\t\t\t\t\t\t\t  viewer {\n\t\t\t\t\t\t\t\t\t\t\t\t\t    name\n\t\t\t\t\t\t\t\t\t\t\t\t\t      repositories(last: 100, isFork: true) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t      nodes {\n\t\t\t\t\t\t\t\t\t\t\t\t\t        url\n\t\t\t\t\t\t\t\t\t\t\t\t\t        parent {\n\t\t\t\t\t\t\t\t\t\t\t\t\t          nameWithOwner\n\t\t\t\t\t\t\t\t\t\t\t\t\t        }\n\t\t\t\t\t\t\t\t\t\t\t\t\t      }\n\t\t\t\t\t\t\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`;\n\t\t\t\t\t\t\t\t\t\treturn this.request(\"https://api.github.com/graphql\", {query: query}, \"POST\")\n\t\t\t\t\t\t\t\t\t\t.then(data => {\n\t\t\t\t\t\t\t\t\t\t\tlet repos = data.data.viewer.repositories.nodes;\n\n\t\t\t\t\t\t\t\t\t\t\tfor (let i in repos) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (repos[i].parent.nameWithOwner === repoInfo.full_name) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.switchToMyForkDialog(repos[i].url);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn repoInfo;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\treturn repoInfo;\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse { // search forks of this repo\n\t\t\t\t\t\t\t\t\t\treturn this.request(repoInfo.forks_url)\n\t\t\t\t\t\t\t\t\t\t.then(forks => {\n\t\t\t\t\t\t\t\t\t\t\tfor (let i in forks) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (forks[i].owner.login === this.user.username) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.switchToMyForkDialog(forks[i].html_url);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn repoInfo;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\treturn repoInfo;\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn repoInfo;\n\t\t\t\t\t\t}).then(repoInfo => {\n\t\t\t\t\t\t\tconst env = { context: this, repoInfo };\n\n\t\t\t\t\t\t\tMavo.hooks.run(\"gh-after-login\", env);\n\n\t\t\t\t\t\t\treturn env.repoInfo;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t},\n\n\tcanPush: function() {\n\t\tif (this.repoInfo) {\n\t\t\treturn this.repoInfo.permissions.push;\n\t\t}\n\n\t\t// Repo does not exist so we can't check permissions\n\t\t// Just check if authenticated user is the same as our URL username\n\t\treturn this.user?.username?.toLowerCase() == this.username.toLowerCase();\n\t},\n\n\toAuthParams: () => \"&scope=repo\",\n\n\tlogout: function() {\n\t\treturn this.oAuthLogout().then(() => {\n\t\t\tthis.user = null;\n\t\t});\n\t},\n\n\tgetUser: function() {\n\t\tif (this.user) {\n\t\t\treturn Promise.resolve(this.user);\n\t\t}\n\n\t\treturn this.request(\"user\").then(info => {\n\t\t\tthis.user = {\n\t\t\t\tusername: info.login,\n\t\t\t\tname: info.name || info.login,\n\t\t\t\tavatar: info.avatar_url,\n\t\t\t\turl: \"https://github.com/\" + info.login,\n\t\t\t\tinfo\n\t\t\t};\n\n\t\t\t$.fire(this.mavo.element, \"mv-login\", { backend: this });\n\t\t});\n\t},\n\n\tgetURL: function(path = this.path, sha) {\n\t\tlet repoInfo = this.forkInfo || this.repoInfo;\n\t\tlet repo = repoInfo.full_name;\n\t\tpath = path.replace(/ /g, \"%20\");\n\n\t\trepoInfo.pagesInfo = repoInfo.pagesInfo || this.request(`repos/${repo}/pages`, {}, \"GET\", {\n\t\t\theaders: {\n\t\t\t\t\"Accept\": \"application/vnd.github.mister-fantastic-preview+json\"\n\t\t\t}\n\t\t});\n\n\t\treturn repoInfo.pagesInfo.then(pagesInfo => pagesInfo.html_url + path)\n\t\t\t.catch(xhr => {\n\t\t\t\t// No Github Pages, return jsdelivr URLs\n\t\t\t\treturn `https://cdn.jsdelivr.net/gh/${repo}@${sha || this.branch || \"latest\"}/${path}`;\n\t\t\t});\n\t},\n\n\tswitchToMyForkDialog: function(forkURL) {\n\t\t\tlet params = (new URL(location)).searchParams;\n\t\t\tparams.append(`${this.mavo.id}-storage`, forkURL + \"/\" + this.path);\n\n\t\t\tthis.notice = this.mavo.message(`\n\t\t\t${this.mavo._(\"gh-login-fork-options\")}\n\t\t\t<form onsubmit=\"return false\">\n\t\t\t\t<a href=\"${location.pathname}?${params}\"><button>${this.mavo._(\"gh-use-my-fork\")}</button></a>\n\t\t\t</form>`, {\n\t\t\t\tclasses: \"mv-inline\",\n\t\t\t\tdismiss: [\"button\", \"submit\"]\n\t\t\t});\n\n\t\t\tthis.notice.closed.then(form => {\n\t\t\t\tif (!form) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thistory.pushState({}, \"\", `${location.pathname}?${params}`);\n\t\t\t\tlocation.replace(`${location.pathname}?${params}`);\n\n\t\t\t});\n\t\t\treturn;\n\t},\n\n\tstatic: {\n\t\tapiDomain: \"https://api.github.com/\",\n\t\toAuth: \"https://github.com/login/oauth/authorize\",\n\t\tkey: \"7e08e016048000bc594e\",\n\n\t\ttest: function(url) {\n\t\t\turl = new URL(url, Mavo.base);\n\t\t\treturn /^((api\\.)?github\\.com|raw\\.githubusercontent\\.com)/.test(url.host);\n\t\t},\n\n\t\t/**\n\t\t * Parse Github URLs, return username, repo, branch, path\n\t\t */\n\t\tparseURL: function(source, defaults = {}) {\n\t\t\tconst ret = {};\n\n\t\t\t// Define computed properties as writable accessors\n\t\t\tObject.defineProperties(ret, {\n\t\t\t\t\"apiCall\": {\n\t\t\t\t\tget() {\n\t\t\t\t\t\tlet call = `repos/${this.username}/${this.repo}/${this.resources ?? \"contents\"}`;\n\n\t\t\t\t\t\tconst path = this.path;\n\t\t\t\t\t\tif (path) {\n\t\t\t\t\t\t\tcall += `/${path}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Don't lose search params for raw API calls\n\t\t\t\t\t\treturn call + (this.apiParams ?? \"\");\n\t\t\t\t\t},\n\t\t\t\t\tset (v) {\n\t\t\t\t\t\tdelete this.apiCall;\n\t\t\t\t\t\tthis.apiCall = v;\n\t\t\t\t\t},\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tenumerable: true\n\t\t\t\t},\n\n\t\t\t\t\"path\": {\n\t\t\t\t\tget() {\n\t\t\t\t\t\tif (this.filename) {\n\t\t\t\t\t\t\treturn (this.filepath? this.filepath + \"/\" : \"\") + this.filename;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn this.filepath;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tset (v) {\n\t\t\t\t\t\tdelete this.path;\n\t\t\t\t\t\tthis.path = v;\n\t\t\t\t\t},\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tenumerable: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst url = new URL(source, Mavo.base);\n\t\t\tlet path = url.pathname.slice(1).split(\"/\");\n\n\t\t\tret.username = path.shift();\n\t\t\tret.repo = path.shift() || defaults.repo;\n\n\t\t\tif (/raw.githubusercontent.com$/.test(url.host)) {\n\t\t\t\tret.branch = path.shift();\n\t\t\t}\n\t\t\telse if (/api.github.com$/.test(url.host)) {\n\t\t\t\t// Raw API call\n\t\t\t\tdelete ret.username;\n\t\t\t\tdelete ret.repo;\n\n\t\t\t\tret.apiParams = url.search;\n\t\t\t\tret.apiData = Mavo.Functions.from(source, \"#\"); // url.* drops line breaks\n\n\t\t\t\tconst apiCall = url.pathname.slice(1) + ret.apiParams;\n\n\t\t\t\tif (apiCall == \"graphql\") {\n\t\t\t\t\tret.apiCall = apiCall;\n\t\t\t\t\tret.apiData = { query: ret.apiData };\n\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tpath = url.pathname.slice(1).split(\"/\");\n\t\t\t\tconst firstSegment = path.shift();\n\n\t\t\t\tif (firstSegment != \"repos\") {\n\t\t\t\t\tret.apiCall = apiCall;\n\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tret.username = path.shift();\n\t\t\t\tret.repo = path.shift();\n\t\t\t\tret.resources = path.shift();\n\t\t\t}\n\t\t\telse if (path[0] == \"blob\") {\n\t\t\t\tpath.shift();\n\t\t\t\tret.branch = path.shift();\n\t\t\t}\n\n\t\t\tconst lastSegment = path[path.length - 1];\n\n\t\t\tif (/\\.\\w+$/.test(lastSegment)) {\n\t\t\t\tret.filename = lastSegment;\n\t\t\t\tpath.splice(path.length - 1, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// If we work with a raw API call and couldn't find the filename in the path,\n\t\t\t\t// leave the filename blank\n\t\t\t\tret.filename = ret.hasOwnProperty(\"apiParams\")? \"\" : defaults.filename;\n\t\t\t}\n\n\t\t\tret.filepath = path.join(\"/\") || defaults.filepath || \"\";\n\n\t\t\treturn ret;\n\t\t},\n\n\t\t// Fix atob() and btoa() so they can handle Unicode\n\t\tbtoa: str => btoa(unescape(encodeURIComponent(str))),\n\t\tatob: str => decodeURIComponent(escape(window.atob(str)))\n\t}\n}));\n\n})(Bliss, Bliss.$);\n\nconsole.log(\"local\");\n\n//# sourceMappingURL=maps/mavo-nodeps.js.map\n\n//# sourceMappingURL=maps/mavo.js.map\n"],"names":[],"version":3,"file":"index.d6f65ae9.js.map","sourceRoot":"/__parcel_source_root/"}